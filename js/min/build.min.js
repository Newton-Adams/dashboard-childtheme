"use strict";

function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
/*
 * This combined file was created by the DataTables downloader builder:
 *   https://datatables.net/download
 *
 * To rebuild or modify this file with the latest versions of the included
 * software please visit:
 *   https://datatables.net/download/#ju/dt-2.0.3/b-3.0.1/b-colvis-3.0.1/r-3.0.1
 *
 * Included libraries:
 *   DataTables 2.0.3, Buttons 3.0.1, Column visibility 3.0.1, Responsive 3.0.1
 */

/*! DataTables 2.0.3
 * © SpryMedia Ltd - datatables.net/license
 */
!function (n) {
  "use strict";

  var a;
  "function" == typeof define && define.amd ? define(["jquery"], function (e) {
    return n(e, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (a = require("jquery"), "undefined" == typeof window ? module.exports = function (e, t) {
    return e = e || window, t = t || a(e), n(t, e, e.document);
  } : module.exports = n(a, window, window.document)) : window.DataTable = n(jQuery, window, document);
}(function (B, q, _) {
  "use strict";

  function g(e) {
    var t = parseInt(e, 10);
    return !isNaN(t) && isFinite(e) ? t : null;
  }
  function o(e, t, n) {
    var a = _typeof(e),
      r = "string" == a;
    return "number" == a || "bigint" == a || !!y(e) || (t && r && (e = P(e, t)), n && r && (e = e.replace(j, "")), !isNaN(parseFloat(e)) && isFinite(e));
  }
  function l(e, t, n) {
    var a;
    return !!y(e) || ("string" != typeof e || !e.match(/<(input|select)/i)) && (y(a = e) || "string" == typeof a) && !!o(I(e), t, n) || null;
  }
  function v(e, t, n, a) {
    var r = [],
      o = 0,
      i = t.length;
    if (void 0 !== a) for (; o < i; o++) e[t[o]][n] && r.push(e[t[o]][n][a]);else for (; o < i; o++) e[t[o]] && r.push(e[t[o]][n]);
    return r;
  }
  function h(e, t) {
    var n,
      a = [];
    void 0 === t ? (t = 0, n = e) : (n = t, t = e);
    for (var r = t; r < n; r++) a.push(r);
    return a;
  }
  function b(e) {
    for (var t = [], n = 0, a = e.length; n < a; n++) e[n] && t.push(e[n]);
    return t;
  }
  var C,
    _U,
    t,
    e,
    $ = function $(e, H) {
      var W, X, V;
      return $.factory(e, H) ? $ : this instanceof $ ? B(e).DataTable(H) : (X = void 0 === (H = e), V = (W = this).length, X && (H = {}), this.api = function () {
        return new _U(this);
      }, this.each(function () {
        var n = 1 < V ? Je({}, H, !0) : H,
          a = 0,
          e = this.getAttribute("id"),
          r = !1,
          t = $.defaults,
          o = B(this);
        if ("table" != this.nodeName.toLowerCase()) Z(null, 0, "Non-table node initialisation (" + this.nodeName + ")", 2);else {
          B(this).trigger("options.dt", n), ne(t), ae(t.column), z(t, t, !0), z(t.column, t.column, !0), z(t, B.extend(n, o.data()), !0);
          for (var i = $.settings, a = 0, l = i.length; a < l; a++) {
            var s = i[a];
            if (s.nTable == this || s.nTHead && s.nTHead.parentNode == this || s.nTFoot && s.nTFoot.parentNode == this) {
              var k = (void 0 !== n.bRetrieve ? n : t).bRetrieve,
                E = (void 0 !== n.bDestroy ? n : t).bDestroy;
              if (X || k) return s.oInstance;
              if (E) {
                new $.Api(s).destroy();
                break;
              }
              return void Z(s, 0, "Cannot reinitialise DataTable", 3);
            }
            if (s.sTableId == this.id) {
              i.splice(a, 1);
              break;
            }
          }
          null !== e && "" !== e || (e = "DataTables_Table_" + $.ext._unique++, this.id = e);
          var u = B.extend(!0, {}, $.models.oSettings, {
              sDestroyWidth: o[0].style.width,
              sInstance: e,
              sTableId: e,
              colgroup: B("<colgroup>").prependTo(this),
              fastData: function fastData(e, t, n) {
                return G(u, e, t, n);
              }
            }),
            e = (u.nTable = this, u.oInit = n, i.push(u), u.api = new _U(u), u.oInstance = 1 === W.length ? W : o.dataTable(), ne(n), n.aLengthMenu && !n.iDisplayLength && (n.iDisplayLength = Array.isArray(n.aLengthMenu[0]) ? n.aLengthMenu[0][0] : B.isPlainObject(n.aLengthMenu[0]) ? n.aLengthMenu[0].value : n.aLengthMenu[0]), n = Je(B.extend(!0, {}, t), n), Q(u.oFeatures, n, ["bPaginate", "bLengthChange", "bFilter", "bSort", "bSortMulti", "bInfo", "bProcessing", "bAutoWidth", "bSortClasses", "bServerSide", "bDeferRender"]), Q(u, n, ["ajax", "fnFormatNumber", "sServerMethod", "aaSorting", "aaSortingFixed", "aLengthMenu", "sPaginationType", "iStateDuration", "bSortCellsTop", "iTabIndex", "sDom", "fnStateLoadCallback", "fnStateSaveCallback", "renderer", "searchDelay", "rowId", "caption", "layout", ["iCookieDuration", "iStateDuration"], ["oSearch", "oPreviousSearch"], ["aoSearchCols", "aoPreSearchCols"], ["iDisplayLength", "_iDisplayLength"]]), Q(u.oScroll, n, [["sScrollX", "sX"], ["sScrollXInner", "sXInner"], ["sScrollY", "sY"], ["bScrollCollapse", "bCollapse"]]), Q(u.oLanguage, n, "fnInfoCallback"), K(u, "aoDrawCallback", n.fnDrawCallback), K(u, "aoStateSaveParams", n.fnStateSaveParams), K(u, "aoStateLoadParams", n.fnStateLoadParams), K(u, "aoStateLoaded", n.fnStateLoaded), K(u, "aoRowCallback", n.fnRowCallback), K(u, "aoRowCreatedCallback", n.fnCreatedRow), K(u, "aoHeaderCallback", n.fnHeaderCallback), K(u, "aoFooterCallback", n.fnFooterCallback), K(u, "aoInitComplete", n.fnInitComplete), K(u, "aoPreDrawCallback", n.fnPreDrawCallback), u.rowIdFn = J(n.rowId), u),
            c = ($.__browser || (P = {}, $.__browser = P, j = B("<div/>").css({
              position: "fixed",
              top: 0,
              left: -1 * q.pageXOffset,
              height: 1,
              width: 1,
              overflow: "hidden"
            }).append(B("<div/>").css({
              position: "absolute",
              top: 1,
              left: 1,
              width: 100,
              overflow: "scroll"
            }).append(B("<div/>").css({
              width: "100%",
              height: 10
            }))).appendTo("body"), p = j.children(), O = p.children(), P.barWidth = p[0].offsetWidth - p[0].clientWidth, P.bScrollbarLeft = 1 !== Math.round(O.offset().left), j.remove()), B.extend(e.oBrowser, $.__browser), e.oScroll.iBarWidth = $.__browser.barWidth, u.oClasses),
            d = (B.extend(c, $.ext.classes, n.oClasses), o.addClass(c.table), u.oFeatures.bPaginate || (n.iDisplayStart = 0), void 0 === u.iInitDisplayStart && (u.iInitDisplayStart = n.iDisplayStart, u._iDisplayStart = n.iDisplayStart), u.oLanguage),
            f = (B.extend(!0, d, n.oLanguage), d.sUrl ? (B.ajax({
              dataType: "json",
              url: d.sUrl,
              success: function success(e) {
                z(t.oLanguage, e), B.extend(!0, d, e, u.oInit.oLanguage), ee(u, null, "i18n", [u], !0), Oe(u);
              },
              error: function error() {
                Z(u, 0, "i18n file loading error", 21), Oe(u);
              }
            }), r = !0) : ee(u, null, "i18n", [u]), []),
            h = this.getElementsByTagName("thead"),
            p = Ce(u, h[0]);
          if (n.aoColumns) f = n.aoColumns;else if (p.length) for (l = p[a = 0].length; a < l; a++) f.push(null);
          for (a = 0, l = f.length; a < l; a++) re(u);
          var g,
            m,
            v,
            b,
            y,
            D,
            x,
            S = u,
            T = n.aoColumnDefs,
            w = f,
            M = p,
            _ = function _(e, t) {
              oe(u, e, t);
            },
            C = S.aoColumns;
          if (w) for (g = 0, m = w.length; g < m; g++) w[g] && w[g].name && (C[g].sName = w[g].name);
          if (T) for (g = T.length - 1; 0 <= g; g--) {
            var I = void 0 !== (x = T[g]).target ? x.target : void 0 !== x.targets ? x.targets : x.aTargets;
            for (Array.isArray(I) || (I = [I]), v = 0, b = I.length; v < b; v++) {
              var A = I[v];
              if ("number" == typeof A && 0 <= A) {
                for (; C.length <= A;) re(S);
                _(A, x);
              } else if ("number" == typeof A && A < 0) _(C.length + A, x);else if ("string" == typeof A) for (y = 0, D = C.length; y < D; y++) "_all" === A ? _(y, x) : -1 !== A.indexOf(":name") ? C[y].sName === A.replace(":name", "") && _(y, x) : M.forEach(function (e) {
                e[y] && (e = B(e[y].cell), A.match(/^[a-z][\w-]*$/i) && (A = "." + A), e.is(A)) && _(y, x);
              });
            }
          }
          if (w) for (g = 0, m = w.length; g < m; g++) _(g, w[g]);
          var F,
            L,
            N,
            j,
            P = o.children("tbody").find("tr").eq(0),
            R = (P.length && (F = function F(e, t) {
              return null !== e.getAttribute("data-" + t) ? t : null;
            }, B(P[0]).children("th, td").each(function (e, t) {
              var n,
                a = u.aoColumns[e];
              a || Z(u, 0, "Incorrect column count", 18), a.mData === e && (n = F(t, "sort") || F(t, "order"), t = F(t, "filter") || F(t, "search"), null === n && null === t || (a.mData = {
                _: e + ".display",
                sort: null !== n ? e + ".@data-" + n : void 0,
                type: null !== n ? e + ".@data-" + n : void 0,
                filter: null !== t ? e + ".@data-" + t : void 0
              }, a._isArrayHost = !0, oe(u, e)));
            })), u.oFeatures),
            O = function O() {
              if (void 0 === n.aaSorting) {
                var e = u.aaSorting;
                for (a = 0, l = e.length; a < l; a++) e[a][1] = u.aoColumns[a].asSorting[0];
              }
              ze(u), K(u, "aoDrawCallback", function () {
                (u.bSorted || "ssp" === te(u) || R.bDeferRender) && ze(u);
              });
              var t = o.children("caption"),
                t = (u.caption && (t = 0 === t.length ? B("<caption/>").appendTo(o) : t).html(u.caption), t.length && (t[0]._captionSide = t.css("caption-side"), u.captionNode = t[0]), 0 === h.length && (h = B("<thead/>").appendTo(o)), u.nTHead = h[0], B("tr", h).addClass(c.thead.row), o.children("tbody")),
                t = (0 === t.length && (t = B("<tbody/>").insertAfter(h)), u.nTBody = t[0], o.children("tfoot"));
              if (0 === t.length && (t = B("<tfoot/>").appendTo(o)), u.nTFoot = t[0], B("tr", t).addClass(c.tfoot.row), n.aaData) for (a = 0; a < n.aaData.length; a++) Y(u, n.aaData[a]);else "dom" == te(u) && se(u, B(u.nTBody).children("tr"));
              u.aiDisplay = u.aiDisplayMaster.slice(), !(u.bInitialised = !0) === r && Oe(u);
            };
          K(u, "aoDrawCallback", Ye), n.bStateSave ? (R.bStateSave = !0, N = O, (L = u).oFeatures.bStateSave ? void 0 !== (j = L.fnStateLoadCallback.call(L.oInstance, L, function (e) {
            Ge(L, e, N);
          })) && Ge(L, j, N) : N()) : O();
        }
      }), W = null, this);
    },
    c = ($.ext = C = {
      buttons: {},
      classes: {},
      builder: "ju/dt-2.0.3/b-3.0.1/b-colvis-3.0.1/r-3.0.1",
      errMode: "alert",
      feature: [],
      features: {},
      search: [],
      selector: {
        cell: [],
        column: [],
        row: []
      },
      legacy: {
        ajax: null
      },
      pager: {},
      renderer: {
        pageButton: {},
        header: {}
      },
      order: {},
      type: {
        className: {},
        detect: [],
        render: {},
        search: {},
        order: {}
      },
      _unique: 0,
      fnVersionCheck: $.fnVersionCheck,
      iApiIndex: 0,
      sVersion: $.version
    }, B.extend(C, {
      afnFiltering: C.search,
      aTypes: C.type.detect,
      ofnSearch: C.type.search,
      oSort: C.type.order,
      afnSortData: C.order,
      aoFeatures: C.feature,
      oStdClasses: C.classes,
      oPagination: C.pager
    }), B.extend($.ext.classes, {
      container: "dt-container",
      empty: {
        row: "dt-empty"
      },
      info: {
        container: "dt-info"
      },
      length: {
        container: "dt-length",
        select: "dt-input"
      },
      order: {
        canAsc: "dt-orderable-asc",
        canDesc: "dt-orderable-desc",
        isAsc: "dt-ordering-asc",
        isDesc: "dt-ordering-desc",
        none: "dt-orderable-none",
        position: "sorting_"
      },
      processing: {
        container: "dt-processing"
      },
      scrolling: {
        body: "dt-scroll-body",
        container: "dt-scroll",
        footer: {
          self: "dt-scroll-foot",
          inner: "dt-scroll-footInner"
        },
        header: {
          self: "dt-scroll-head",
          inner: "dt-scroll-headInner"
        }
      },
      search: {
        container: "dt-search",
        input: "dt-input"
      },
      table: "dataTable",
      tbody: {
        cell: "",
        row: ""
      },
      thead: {
        cell: "",
        row: ""
      },
      tfoot: {
        cell: "",
        row: ""
      },
      paging: {
        active: "current",
        button: "dt-paging-button",
        container: "dt-paging",
        disabled: "disabled"
      }
    }), {}),
    d = /[\r\n\u2028]/g,
    F = /<.*?>/g,
    L = /^\d{2,4}[./-]\d{1,2}[./-]\d{1,2}([T ]{1}\d{1,2}[:.]\d{2}([.:]\d{2})?)?$/,
    N = new RegExp("(\\" + ["/", ".", "*", "+", "?", "|", "(", ")", "[", "]", "{", "}", "\\", "$", "^", "-"].join("|\\") + ")", "g"),
    j = /['\u00A0,$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfkɃΞ]/gi,
    y = function y(e) {
      return !e || !0 === e || "-" === e;
    },
    P = function P(e, t) {
      return c[t] || (c[t] = new RegExp(je(t), "g")), "string" == typeof e && "." !== t ? e.replace(/\./g, "").replace(c[t], ".") : e;
    },
    f = function f(e, t, n) {
      var a = [],
        r = 0,
        o = e.length;
      if (void 0 !== n) for (; r < o; r++) e[r] && e[r][t] && a.push(e[r][t][n]);else for (; r < o; r++) e[r] && a.push(e[r][t]);
      return a;
    },
    I = function I(e) {
      return e.replace(F, "").replace(/<script/i, "");
    },
    u = function u(e) {
      return "string" == typeof (e = Array.isArray(e) ? e.join(",") : e) ? e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;") : e;
    },
    R = function R(e, t) {
      var n;
      return "string" != typeof e ? e : (n = e.normalize("NFD")).length !== e.length ? (!0 === t ? e + " " : "") + n.replace(/[\u0300-\u036f]/g, "") : n;
    },
    x = function x(e) {
      if (Array.from && Set) return Array.from(new Set(e));
      if (function (e) {
        if (!(e.length < 2)) for (var t = e.slice().sort(), n = t[0], a = 1, r = t.length; a < r; a++) {
          if (t[a] === n) return !1;
          n = t[a];
        }
        return !0;
      }(e)) return e.slice();
      var t,
        n,
        a,
        r = [],
        o = e.length,
        i = 0;
      e: for (n = 0; n < o; n++) {
        for (t = e[n], a = 0; a < i; a++) if (r[a] === t) continue e;
        r.push(t), i++;
      }
      return r;
    },
    O = function O(e, t) {
      if (Array.isArray(t)) for (var n = 0; n < t.length; n++) O(e, t[n]);else e.push(t);
      return e;
    };
  function D(t, e) {
    e && e.split(" ").forEach(function (e) {
      e && t.classList.add(e);
    });
  }
  function k(t) {
    var n,
      a,
      r = {};
    B.each(t, function (e) {
      (n = e.match(/^([^A-Z]+?)([A-Z])/)) && -1 !== "a aa ai ao as b fn i m o s ".indexOf(n[1] + " ") && (a = e.replace(n[0], n[2].toLowerCase()), r[a] = e, "o" === n[1]) && k(t[e]);
    }), t._hungarianMap = r;
  }
  function z(t, n, a) {
    var r;
    t._hungarianMap || k(t), B.each(n, function (e) {
      void 0 === (r = t._hungarianMap[e]) || !a && void 0 !== n[r] || ("o" === r.charAt(0) ? (n[r] || (n[r] = {}), B.extend(!0, n[r], n[e]), z(t[r], n[r], a)) : n[r] = n[e]);
    });
  }
  $.util = {
    diacritics: function diacritics(e, t) {
      if ("function" != typeof e) return R(e, t);
      R = e;
    },
    debounce: function debounce(n, a) {
      var r;
      return function () {
        var e = this,
          t = arguments;
        clearTimeout(r), r = setTimeout(function () {
          n.apply(e, t);
        }, a || 250);
      };
    },
    throttle: function throttle(a, e) {
      var r,
        o,
        i = void 0 !== e ? e : 200;
      return function () {
        var e = this,
          t = +new Date(),
          n = arguments;
        r && t < r + i ? (clearTimeout(o), o = setTimeout(function () {
          r = void 0, a.apply(e, n);
        }, i)) : (r = t, a.apply(e, n));
      };
    },
    escapeRegex: function escapeRegex(e) {
      return e.replace(N, "\\$1");
    },
    set: function set(a) {
      var _f;
      return B.isPlainObject(a) ? $.util.set(a._) : null === a ? function () {} : "function" == typeof a ? function (e, t, n) {
        a(e, "set", t, n);
      } : "string" != typeof a || -1 === a.indexOf(".") && -1 === a.indexOf("[") && -1 === a.indexOf("(") ? function (e, t) {
        e[a] = t;
      } : (_f = function f(e, t, n) {
        for (var a, r, o, i, l = de(n), n = l[l.length - 1], s = 0, u = l.length - 1; s < u; s++) {
          if ("__proto__" === l[s] || "constructor" === l[s]) throw new Error("Cannot set prototype values");
          if (a = l[s].match(ce), r = l[s].match(p), a) {
            if (l[s] = l[s].replace(ce, ""), e[l[s]] = [], (a = l.slice()).splice(0, s + 1), i = a.join("."), Array.isArray(t)) for (var c = 0, d = t.length; c < d; c++) _f(o = {}, t[c], i), e[l[s]].push(o);else e[l[s]] = t;
            return;
          }
          r && (l[s] = l[s].replace(p, ""), e = e[l[s]](t)), null !== e[l[s]] && void 0 !== e[l[s]] || (e[l[s]] = {}), e = e[l[s]];
        }
        n.match(p) ? e[n.replace(p, "")](t) : e[n.replace(ce, "")] = t;
      }, function (e, t) {
        return _f(e, t, a);
      });
    },
    get: function get(r) {
      var o, _f2;
      return B.isPlainObject(r) ? (o = {}, B.each(r, function (e, t) {
        t && (o[e] = $.util.get(t));
      }), function (e, t, n, a) {
        var r = o[t] || o._;
        return void 0 !== r ? r(e, t, n, a) : e;
      }) : null === r ? function (e) {
        return e;
      } : "function" == typeof r ? function (e, t, n, a) {
        return r(e, t, n, a);
      } : "string" != typeof r || -1 === r.indexOf(".") && -1 === r.indexOf("[") && -1 === r.indexOf("(") ? function (e) {
        return e[r];
      } : (_f2 = function f(e, t, n) {
        var a, r, o;
        if ("" !== n) for (var i = de(n), l = 0, s = i.length; l < s; l++) {
          if (d = i[l].match(ce), a = i[l].match(p), d) {
            if (i[l] = i[l].replace(ce, ""), "" !== i[l] && (e = e[i[l]]), r = [], i.splice(0, l + 1), o = i.join("."), Array.isArray(e)) for (var u = 0, c = e.length; u < c; u++) r.push(_f2(e[u], t, o));
            var d = d[0].substring(1, d[0].length - 1);
            e = "" === d ? r : r.join(d);
            break;
          }
          if (a) i[l] = i[l].replace(p, ""), e = e[i[l]]();else {
            if (null === e || null === e[i[l]]) return null;
            if (void 0 === e || void 0 === e[i[l]]) return;
            e = e[i[l]];
          }
        }
        return e;
      }, function (e, t) {
        return _f2(e, t, r);
      });
    },
    stripHtml: function stripHtml(e) {
      var t = _typeof(e);
      if ("function" != t) return "string" == t ? I(e) : e;
      I = e;
    },
    escapeHtml: function escapeHtml(e) {
      var t = _typeof(e);
      if ("function" != t) return "string" == t || Array.isArray(e) ? u(e) : e;
      u = e;
    },
    unique: x
  };
  var r = function r(e, t, n) {
    void 0 !== e[t] && (e[n] = e[t]);
  };
  function ne(e) {
    r(e, "ordering", "bSort"), r(e, "orderMulti", "bSortMulti"), r(e, "orderClasses", "bSortClasses"), r(e, "orderCellsTop", "bSortCellsTop"), r(e, "order", "aaSorting"), r(e, "orderFixed", "aaSortingFixed"), r(e, "paging", "bPaginate"), r(e, "pagingType", "sPaginationType"), r(e, "pageLength", "iDisplayLength"), r(e, "searching", "bFilter"), "boolean" == typeof e.sScrollX && (e.sScrollX = e.sScrollX ? "100%" : ""), "boolean" == typeof e.scrollX && (e.scrollX = e.scrollX ? "100%" : "");
    var t = e.aoSearchCols;
    if (t) for (var n = 0, a = t.length; n < a; n++) t[n] && z($.models.oSearch, t[n]);
    e.serverSide && !e.searchDelay && (e.searchDelay = 400);
  }
  function ae(e) {
    r(e, "orderable", "bSortable"), r(e, "orderData", "aDataSort"), r(e, "orderSequence", "asSorting"), r(e, "orderDataType", "sortDataType");
    var t = e.aDataSort;
    "number" != typeof t || Array.isArray(t) || (e.aDataSort = [t]);
  }
  function re(e) {
    var t = $.defaults.column,
      n = e.aoColumns.length,
      t = B.extend({}, $.models.oColumn, t, {
        aDataSort: t.aDataSort || [n],
        mData: t.mData || n,
        idx: n,
        searchFixed: {},
        colEl: B("<col>")
      }),
      t = (e.aoColumns.push(t), e.aoPreSearchCols);
    t[n] = B.extend({}, $.models.oSearch, t[n]);
  }
  function oe(e, t, n) {
    function a(e) {
      return "string" == typeof e && -1 !== e.indexOf("@");
    }
    var r = e.aoColumns[t],
      o = (null != n && (ae(n), z($.defaults.column, n, !0), void 0 === n.mDataProp || n.mData || (n.mData = n.mDataProp), n.sType && (r._sManualType = n.sType), n.className && !n.sClass && (n.sClass = n.className), t = r.sClass, B.extend(r, n), Q(r, n, "sWidth", "sWidthOrig"), t !== r.sClass && (r.sClass = t + " " + r.sClass), void 0 !== n.iDataSort && (r.aDataSort = [n.iDataSort]), Q(r, n, "aDataSort")), r.mData),
      i = J(o);
    r.mRender && Array.isArray(r.mRender) && (n = (t = r.mRender.slice()).shift(), r.mRender = $.render[n].apply(q, t)), r._render = r.mRender ? J(r.mRender) : null;
    r._bAttrSrc = B.isPlainObject(o) && (a(o.sort) || a(o.type) || a(o.filter)), r._setter = null, r.fnGetData = function (e, t, n) {
      var a = i(e, t, void 0, n);
      return r._render && t ? r._render(a, t, e, n) : a;
    }, r.fnSetData = function (e, t, n) {
      return m(o)(e, t, n);
    }, "number" == typeof o || r._isArrayHost || (e._rowReadObject = !0), e.oFeatures.bSort || (r.bSortable = !1);
  }
  function E(e) {
    var t = e;
    if (t.oFeatures.bAutoWidth) {
      var n,
        a,
        r = t.nTable,
        o = t.aoColumns,
        i = t.oScroll,
        l = i.sY,
        s = i.sX,
        i = i.sXInner,
        u = W(t, "bVisible"),
        c = r.getAttribute("width"),
        d = r.parentNode,
        f = r.style.width,
        f = (f && -1 !== f.indexOf("%") && (c = f), ee(t, null, "column-calc", {
          visible: u
        }, !1), B(r.cloneNode()).css("visibility", "hidden").removeAttr("id")),
        h = (f.append("<tbody>"), B("<tr/>").appendTo(f.find("tbody")));
      for (f.append(B(t.nTHead).clone()).append(B(t.nTFoot).clone()), f.find("tfoot th, tfoot td").css("width", ""), f.find("thead th, thead td").each(function () {
        var e = ie(t, this, !0, !1);
        e ? (this.style.width = e, s && B(this).append(B("<div/>").css({
          width: e,
          margin: 0,
          padding: 0,
          border: 0,
          height: 1
        }))) : this.style.width = "";
      }), n = 0; n < u.length; n++) {
        p = u[n], a = o[p];
        var p = function (e, t) {
            var n = e.aoColumns[t];
            if (!n.maxLenString) {
              for (var a, r = "", o = -1, i = 0, l = e.aiDisplayMaster.length; i < l; i++) {
                var s = e.aiDisplayMaster[i],
                  s = me(e, s)[t],
                  s = s && "object" == _typeof(s) && s.nodeType ? s.innerHTML : s + "";
                s = s.replace(/id=".*?"/g, "").replace(/name=".*?"/g, ""), (a = I(s).replace(/&nbsp;/g, " ")).length > o && (r = s, o = a.length);
              }
              n.maxLenString = r;
            }
            return n.maxLenString;
          }(t, p),
          g = C.type.className[a.sType],
          m = p + a.sContentPadding,
          p = -1 === p.indexOf("<") ? _.createTextNode(m) : m;
        B("<td/>").addClass(g).addClass(a.sClass).append(p).appendTo(h);
      }
      B("[name]", f).removeAttr("name");
      var v = B("<div/>").css(s || l ? {
          position: "absolute",
          top: 0,
          left: 0,
          height: 1,
          right: 0,
          overflow: "hidden"
        } : {}).append(f).appendTo(d),
        b = (s && i ? f.width(i) : s ? (f.css("width", "auto"), f.removeAttr("width"), f.width() < d.clientWidth && c && f.width(d.clientWidth)) : l ? f.width(d.clientWidth) : c && f.width(c), 0),
        y = f.find("tbody tr").eq(0).children();
      for (n = 0; n < u.length; n++) {
        var D = y[n].getBoundingClientRect().width;
        b += D, o[u[n]].sWidth = A(D);
      }
      r.style.width = A(b), v.remove(), c && (r.style.width = A(c)), !c && !s || t._reszEvt || (B(q).on("resize.DT-" + t.sInstance, $.util.throttle(function () {
        t.bDestroying || E(t);
      })), t._reszEvt = !0);
    }
    for (var x = e, S = x.aoColumns, T = 0; T < S.length; T++) {
      var w = ie(x, [T], !1, !1);
      S[T].colEl.css("width", w);
    }
    i = e.oScroll;
    "" === i.sY && "" === i.sX || We(e), ee(e, null, "column-sizing", [e]);
  }
  function M(e, t) {
    e = W(e, "bVisible");
    return "number" == typeof e[t] ? e[t] : null;
  }
  function T(e, t) {
    e = W(e, "bVisible").indexOf(t);
    return -1 !== e ? e : null;
  }
  function H(e) {
    var t = e.aoHeader,
      n = e.aoColumns,
      a = 0;
    if (t.length) for (var r = 0, o = t[0].length; r < o; r++) n[r].bVisible && "none" !== B(t[0][r].cell).css("display") && a++;
    return a;
  }
  function W(e, n) {
    var a = [];
    return e.aoColumns.map(function (e, t) {
      e[n] && a.push(t);
    }), a;
  }
  function X(e) {
    for (var t, n, a, r, o, i, l, s = e.aoColumns, u = e.aoData, c = $.ext.type.detect, d = 0, f = s.length; d < f; d++) {
      if (l = [], !(o = s[d]).sType && o._sManualType) o.sType = o._sManualType;else if (!o.sType) {
        for (t = 0, n = c.length; t < n; t++) {
          for (a = 0, r = u.length; a < r; a++) if (u[a]) {
            if (void 0 === l[a] && (l[a] = G(e, a, d, "type")), !(i = c[t](l[a], e)) && t !== c.length - 2) break;
            if ("html" === i && !y(l[a])) break;
          }
          if (i) {
            o.sType = i;
            break;
          }
        }
        o.sType || (o.sType = "string");
      }
      var h = C.type.className[o.sType],
        h = (h && (V(e.aoHeader, d, h), V(e.aoFooter, d, h)), C.type.render[o.sType]);
      if (h && !o._render) {
        o._render = $.util.get(h), p = b = v = m = g = void 0;
        for (var p, g = e, m = d, v = g.aoData, b = 0; b < v.length; b++) v[b].nTr && (p = G(g, b, m, "display"), v[b].displayData[m] = p, ue(v[b].anCells[m], p));
      }
    }
  }
  function V(e, t, n) {
    e.forEach(function (e) {
      e[t] && e[t].unique && D(e[t].cell, n);
    });
  }
  function ie(e, t, n, a) {
    Array.isArray(t) || (t = le(t));
    for (var r, o = 0, i = e.aoColumns, l = 0, s = t.length; l < s; l++) {
      var u = i[t[l]],
        c = n ? u.sWidthOrig : u.sWidth;
      if (a || !1 !== u.bVisible) {
        if (null == c) return null;
        "number" == typeof c ? (r = "px", o += c) : (u = c.match(/([\d\.]+)([^\d]*)/)) && (o += +u[1], r = 3 === u.length ? u[2] : "px");
      }
    }
    return o + r;
  }
  function le(e) {
    e = B(e).closest("[data-dt-column]").attr("data-dt-column");
    return e ? e.split(",").map(function (e) {
      return +e;
    }) : [];
  }
  function Y(e, t, n, a) {
    for (var r = e.aoData.length, o = B.extend(!0, {}, $.models.oRow, {
        src: n ? "dom" : "data",
        idx: r
      }), i = (o._aData = t, e.aoData.push(o), e.aoColumns), l = 0, s = i.length; l < s; l++) i[l].sType = null;
    e.aiDisplayMaster.push(r);
    t = e.rowIdFn(t);
    return void 0 !== t && (e.aIds[t] = o), !n && e.oFeatures.bDeferRender || ve(e, r, n, a), r;
  }
  function se(n, e) {
    var a;
    return (e = e instanceof B ? e : B(e)).map(function (e, t) {
      return a = ge(n, t), Y(n, a.data, t, a.cells);
    });
  }
  function G(e, t, n, a) {
    "search" === a ? a = "filter" : "order" === a && (a = "sort");
    var r = e.iDraw,
      o = e.aoColumns[n],
      i = e.aoData[t]._aData,
      l = o.sDefaultContent,
      s = o.fnGetData(i, a, {
        settings: e,
        row: t,
        col: n
      });
    if (void 0 === (s = "display" !== a && s && "object" == _typeof(s) && s.nodeName ? s.innerHTML : s)) return e.iDrawError != r && null === l && (Z(e, 0, "Requested unknown parameter " + ("function" == typeof o.mData ? "{function}" : "'" + o.mData + "'") + " for row " + t + ", column " + n, 4), e.iDrawError = r), l;
    if (s !== i && null !== s || null === l || void 0 === a) {
      if ("function" == typeof s) return s.call(i);
    } else s = l;
    return null === s && "display" === a ? "" : "filter" === a && (t = $.ext.type.search)[o.sType] ? t[o.sType](s) : s;
  }
  function ue(e, t) {
    t && "object" == _typeof(t) && t.nodeName ? B(e).empty().append(t) : e.innerHTML = t;
  }
  var ce = /\[.*?\]$/,
    p = /\(\)$/;
  function de(e) {
    return (e.match(/(\\.|[^.])+/g) || [""]).map(function (e) {
      return e.replace(/\\\./g, ".");
    });
  }
  var J = $.util.get,
    m = $.util.set;
  function fe(e) {
    return f(e.aoData, "_aData");
  }
  function he(e) {
    e.aoData.length = 0, e.aiDisplayMaster.length = 0, e.aiDisplay.length = 0, e.aIds = {};
  }
  function pe(e, t, n, a) {
    var r,
      o,
      i = e.aoData[t];
    if (i._aSortData = null, i._aFilterData = null, i.displayData = null, "dom" !== n && (n && "auto" !== n || "dom" !== i.src)) {
      var l = i.anCells,
        s = me(e, t);
      if (l) if (void 0 !== a) ue(l[a], s[a]);else for (r = 0, o = l.length; r < o; r++) ue(l[r], s[r]);
    } else i._aData = ge(e, i, a, void 0 === a ? void 0 : i._aData).data;
    var u = e.aoColumns;
    if (void 0 !== a) u[a].sType = null, u[a].maxLenString = null;else {
      for (r = 0, o = u.length; r < o; r++) u[r].sType = null, u[r].maxLenString = null;
      be(e, i);
    }
  }
  function ge(e, t, n, a) {
    function r(e, t) {
      var n;
      "string" == typeof e && -1 !== (n = e.indexOf("@")) && (n = e.substring(n + 1), m(e)(a, t.getAttribute(n)));
    }
    function o(e) {
      void 0 !== n && n !== d || (l = f[d], s = e.innerHTML.trim(), l && l._bAttrSrc ? (m(l.mData._)(a, s), r(l.mData.sort, e), r(l.mData.type, e), r(l.mData.filter, e)) : h ? (l._setter || (l._setter = m(l.mData)), l._setter(a, s)) : a[d] = s), d++;
    }
    var i,
      l,
      s,
      u = [],
      c = t.firstChild,
      d = 0,
      f = e.aoColumns,
      h = e._rowReadObject;
    a = void 0 !== a ? a : h ? {} : [];
    if (c) for (; c;) "TD" != (i = c.nodeName.toUpperCase()) && "TH" != i || (o(c), u.push(c)), c = c.nextSibling;else for (var p = 0, g = (u = t.anCells).length; p < g; p++) o(u[p]);
    var t = t.firstChild ? t : t.nTr;
    return t && (t = t.getAttribute("id")) && m(e.rowId)(a, t), {
      data: a,
      cells: u
    };
  }
  function me(e, t) {
    var n = e.aoData[t],
      a = e.aoColumns;
    if (!n.displayData) {
      n.displayData = [];
      for (var r = 0, o = a.length; r < o; r++) n.displayData.push(G(e, t, r, "display"));
    }
    return n.displayData;
  }
  function ve(e, t, n, a) {
    var r,
      o,
      i,
      l,
      s,
      u,
      c = e.aoData[t],
      d = c._aData,
      f = [],
      h = e.oClasses.tbody.row;
    if (null === c.nTr) {
      for (r = n || _.createElement("tr"), c.nTr = r, c.anCells = f, D(r, h), r._DT_RowIndex = t, be(e, c), l = 0, s = e.aoColumns.length; l < s; l++) {
        i = e.aoColumns[l], (o = (u = !n || !a[l]) ? _.createElement(i.sCellType) : a[l]) || Z(e, 0, "Incorrect column count", 18), o._DT_CellIndex = {
          row: t,
          column: l
        }, f.push(o);
        var p = me(e, t);
        !u && (!i.mRender && i.mData === l || B.isPlainObject(i.mData) && i.mData._ === l + ".display") || ue(o, p[l]), i.bVisible && u ? r.appendChild(o) : i.bVisible || u || o.parentNode.removeChild(o), i.fnCreatedCell && i.fnCreatedCell.call(e.oInstance, o, G(e, t, l), d, t, l);
      }
      ee(e, "aoRowCreatedCallback", "row-created", [r, d, t, f]);
    } else D(c.nTr, h);
  }
  function be(e, t) {
    var n = t.nTr,
      a = t._aData;
    n && ((e = e.rowIdFn(a)) && (n.id = e), a.DT_RowClass && (e = a.DT_RowClass.split(" "), t.__rowc = t.__rowc ? x(t.__rowc.concat(e)) : e, B(n).removeClass(t.__rowc.join(" ")).addClass(a.DT_RowClass)), a.DT_RowAttr && B(n).attr(a.DT_RowAttr), a.DT_RowData) && B(n).data(a.DT_RowData);
  }
  function ye(e, t) {
    var n,
      a = e.oClasses,
      r = e.aoColumns,
      o = "header" === t ? e.nTHead : e.nTFoot,
      i = "header" === t ? "sTitle" : t;
    if (o) {
      if (("header" === t || f(e.aoColumns, i).join("")) && 1 === (n = (n = B("tr", o)).length ? n : B("<tr/>").appendTo(o)).length) for (var l = B("td, th", n).length, s = r.length; l < s; l++) B("<th/>").html(r[l][i] || "").appendTo(n);
      var u = Ce(e, o, !0);
      "header" === t ? e.aoHeader = u : e.aoFooter = u, B(o).children("tr").attr("role", "row"), B(o).children("tr").children("th, td").each(function () {
        Ke(e, t)(e, B(this), a);
      });
    }
  }
  function De(e, t, n) {
    var a,
      r,
      o,
      i,
      l,
      s = [],
      u = [],
      c = e.aoColumns,
      e = c.length;
    if (t) {
      for (n = n || h(e).filter(function (e) {
        return c[e].bVisible;
      }), a = 0; a < t.length; a++) s[a] = t[a].slice().filter(function (e, t) {
        return n.includes(t);
      }), u.push([]);
      for (a = 0; a < s.length; a++) for (r = 0; r < s[a].length; r++) if (l = i = 1, void 0 === u[a][r]) {
        for (o = s[a][r].cell; void 0 !== s[a + i] && s[a][r].cell == s[a + i][r].cell;) u[a + i][r] = null, i++;
        for (; void 0 !== s[a][r + l] && s[a][r].cell == s[a][r + l].cell;) {
          for (var d = 0; d < i; d++) u[a + d][r + l] = null;
          l++;
        }
        var f = B("span.dt-column-title", o);
        u[a][r] = {
          cell: o,
          colspan: l,
          rowspan: i,
          title: (f.length ? f : B(o)).html()
        };
      }
      return u;
    }
  }
  function xe(e, t) {
    for (var n, a, r = De(e, t), o = 0; o < t.length; o++) {
      if (n = t[o].row) for (; a = n.firstChild;) n.removeChild(a);
      for (var i = 0; i < r[o].length; i++) {
        var l = r[o][i];
        l && B(l.cell).appendTo(n).attr("rowspan", l.rowspan).attr("colspan", l.colspan);
      }
    }
  }
  function S(e, t) {
    if (r = "ssp" == te(s = e), void 0 !== (i = s.iInitDisplayStart) && -1 !== i && (s._iDisplayStart = !r && i >= s.fnRecordsDisplay() ? 0 : i, s.iInitDisplayStart = -1), -1 !== ee(e, "aoPreDrawCallback", "preDraw", [e]).indexOf(!1)) w(e, !1);else {
      var l,
        n = [],
        a = 0,
        r = "ssp" == te(e),
        o = e.aiDisplay,
        i = e._iDisplayStart,
        s = e.fnDisplayEnd(),
        u = e.aoColumns,
        c = B(e.nTBody);
      if (e.bDrawing = !0, r) {
        if (!e.bDestroying && !t) return 0 === e.iDraw && c.empty().append(Se(e)), (l = e).iDraw++, w(l, !0), void Ie(l, function (t) {
          function n(e, t) {
            return "function" == typeof a[e][t] ? "function" : a[e][t];
          }
          var a = t.aoColumns,
            e = t.oFeatures,
            r = t.oPreviousSearch,
            o = t.aoPreSearchCols;
          return {
            draw: t.iDraw,
            columns: a.map(function (t, e) {
              return {
                data: n(e, "mData"),
                name: t.sName,
                searchable: t.bSearchable,
                orderable: t.bSortable,
                search: {
                  value: o[e].search,
                  regex: o[e].regex,
                  fixed: Object.keys(t.searchFixed).map(function (e) {
                    return {
                      name: e,
                      term: t.searchFixed[e].toString()
                    };
                  })
                }
              };
            }),
            order: Ue(t).map(function (e) {
              return {
                column: e.col,
                dir: e.dir,
                name: n(e.col, "sName")
              };
            }),
            start: t._iDisplayStart,
            length: e.bPaginate ? t._iDisplayLength : -1,
            search: {
              value: r.search,
              regex: r.regex,
              fixed: Object.keys(t.searchFixed).map(function (e) {
                return {
                  name: e,
                  term: t.searchFixed[e].toString()
                };
              })
            }
          };
        }(l), function (e) {
          var t = l,
            n = Ae(t, e = e),
            a = Fe(t, "draw", e),
            r = Fe(t, "recordsTotal", e),
            e = Fe(t, "recordsFiltered", e);
          if (void 0 !== a) {
            if (+a < t.iDraw) return;
            t.iDraw = +a;
          }
          n = n || [], he(t), t._iRecordsTotal = parseInt(r, 10), t._iRecordsDisplay = parseInt(e, 10);
          for (var o = 0, i = n.length; o < i; o++) Y(t, n[o]);
          t.aiDisplay = t.aiDisplayMaster.slice(), S(t, !0), ke(t), w(t, !1);
        });
      } else e.iDraw++;
      if (0 !== o.length) for (var d = r ? e.aoData.length : s, f = r ? 0 : i; f < d; f++) {
        for (var h = o[f], p = e.aoData[h], g = (null === p.nTr && ve(e, h), p.nTr), m = 0; m < u.length; m++) {
          var v = u[m],
            b = p.anCells[m];
          D(b, C.type.className[v.sType]), D(b, v.sClass), D(b, e.oClasses.tbody.cell);
        }
        ee(e, "aoRowCallback", null, [g, p._aData, a, f, h]), n.push(g), a++;
      } else n[0] = Se(e);
      ee(e, "aoHeaderCallback", "header", [B(e.nTHead).children("tr")[0], fe(e), i, s, o]), ee(e, "aoFooterCallback", "footer", [B(e.nTFoot).children("tr")[0], fe(e), i, s, o]), c[0].replaceChildren ? c[0].replaceChildren.apply(c[0], n) : (c.children().detach(), c.append(B(n))), B(e.nTableWrapper).toggleClass("dt-empty-footer", 0 === B("tr", e.nTFoot).length), ee(e, "aoDrawCallback", "draw", [e], !0), e.bSorted = !1, e.bFiltered = !1, e.bDrawing = !1;
    }
  }
  function s(e, t, n) {
    var a = e.oFeatures,
      r = a.bSort,
      a = a.bFilter;
    void 0 !== n && !0 !== n || (r && $e(e), a ? Le(e, e.oPreviousSearch) : e.aiDisplay = e.aiDisplayMaster.slice()), !0 !== t && (e._iDisplayStart = 0), e._drawHold = t, S(e), e._drawHold = !1;
  }
  function Se(e) {
    var t = e.oLanguage,
      n = t.sZeroRecords,
      a = te(e);
    return e.iDraw < 1 && "ssp" === a || e.iDraw <= 1 && "ajax" === a ? n = t.sLoadingRecords : t.sEmptyTable && 0 === e.fnRecordsTotal() && (n = t.sEmptyTable), B("<tr/>").append(B("<td />", {
      colSpan: H(e),
      "class": e.oClasses.empty.row
    }).html(n))[0];
  }
  function Te(e, t, n) {
    for (var i = {}, a = (B.each(t, function (e, t) {
        if (null !== t) {
          var e = e.replace(/([A-Z])/g, " $1").split(" "),
            n = (i[e[0]] || (i[e[0]] = {}), 1 === e.length ? "full" : e[1].toLowerCase()),
            a = i[e[0]],
            r = function r(t, n) {
              B.isPlainObject(n) ? Object.keys(n).map(function (e) {
                t.push({
                  feature: e,
                  opts: n[e]
                });
              }) : t.push(n);
            };
          if (a[n] && a[n].contents || (a[n] = {
            contents: []
          }), Array.isArray(t)) for (var o = 0; o < t.length; o++) r(a[n].contents, t[o]);else r(a[n].contents, t);
          Array.isArray(a[n].contents) || (a[n].contents = [a[n].contents]);
        }
      }), Object.keys(i).map(function (e) {
        return 0 !== e.indexOf(n) ? null : {
          name: e,
          val: i[e]
        };
      }).filter(function (e) {
        return null !== e;
      })), r = (a.sort(function (e, t) {
        e = +e.name.replace(/[^0-9]/g, "");
        return +t.name.replace(/[^0-9]/g, "") - e;
      }), "bottom" === n && a.reverse(), []), o = 0, l = a.length; o < l; o++) a[o].val.full && (r.push({
      full: a[o].val.full
    }), we(e, r[r.length - 1]), delete a[o].val.full), Object.keys(a[o].val).length && (r.push(a[o].val), we(e, r[r.length - 1]));
    return r;
  }
  function we(o, i) {
    function l(e, t) {
      return C.features[e] || Z(o, 0, "Unknown feature: " + e), C.features[e].apply(this, [o, t]);
    }
    B.each(i, function (e) {
      for (var t, n = i[e].contents, a = 0, r = n.length; a < r; a++) n[a] && ("string" == typeof n[a] ? n[a] = l(n[a], null) : B.isPlainObject(n[a]) ? n[a] = l(n[a].feature, n[a].opts) : "function" == typeof n[a].node ? n[a] = n[a].node(o) : "function" == typeof n[a] && (t = n[a](o), n[a] = "function" == typeof t.node ? t.node() : t));
    });
  }
  function _e(t) {
    var a,
      e = t.oClasses,
      n = B(t.nTable),
      r = B("<div/>").attr({
        id: t.sTableId + "_wrapper",
        "class": e.container
      }).insertBefore(n);
    if (t.nTableWrapper = r[0], t.sDom) for (var o, i, l, s, u, c, d = t, e = t.sDom, f = r, h = e.match(/(".*?")|('.*?')|./g), p = 0; p < h.length; p++) o = null, "<" == (i = h[p]) ? (l = B("<div/>"), "'" != (s = h[p + 1])[0] && '"' != s[0] || (s = s.replace(/['"]/g, ""), u = "", -1 != s.indexOf(".") ? (c = s.split("."), u = c[0], c = c[1]) : "#" == s[0] ? u = s : c = s, l.attr("id", u.substring(1)).addClass(c), p++), f.append(l), f = l) : ">" == i ? f = f.parent() : "t" == i ? o = He(d) : $.ext.feature.forEach(function (e) {
      i == e.cFeature && (o = e.fnInit(d));
    }), o && f.append(o);else {
      var n = Te(t, t.layout, "top"),
        e = Te(t, t.layout, "bottom"),
        g = Ke(t, "layout");
      n.forEach(function (e) {
        g(t, r, e);
      }), g(t, r, {
        full: {
          table: !0,
          contents: [He(t)]
        }
      }), e.forEach(function (e) {
        g(t, r, e);
      });
    }
    n = t, e = n.nTable;
    n.oFeatures.bProcessing && (a = B("<div/>", {
      id: n.sTableId + "_processing",
      "class": n.oClasses.processing.container,
      role: "status"
    }).html(n.oLanguage.sProcessing).append("<div><div></div><div></div><div></div><div></div></div>").insertBefore(e), B(e).on("processing.dt.DT", function (e, t, n) {
      a.css("display", n ? "block" : "none");
    }));
  }
  function Ce(e, t, n) {
    for (var a, r, o, i, l, s, u = e.aoColumns, c = B(t).children("tr"), d = t && "thead" === t.nodeName.toLowerCase(), f = [], h = 0, p = c.length; h < p; h++) f.push([]);
    for (h = 0, p = c.length; h < p; h++) for (r = (a = c[h]).firstChild; r;) {
      if ("TD" == r.nodeName.toUpperCase() || "TH" == r.nodeName.toUpperCase()) {
        var g,
          m,
          v,
          b,
          y,
          D = [];
        for (b = (b = +r.getAttribute("colspan")) && 0 != b && 1 != b ? b : 1, y = (y = +r.getAttribute("rowspan")) && 0 != y && 1 != y ? y : 1, l = function (e, t, n) {
          for (var a = e[t]; a[n];) n++;
          return n;
        }(f, h, 0), s = 1 == b, n && (s && (oe(e, l, B(r).data()), g = u[l], m = r.getAttribute("width") || null, (v = r.style.width.match(/width:\s*(\d+[pxem%]+)/)) && (m = v[1]), g.sWidthOrig = g.sWidth || m, d ? (null === g.sTitle || g.autoTitle || (r.innerHTML = g.sTitle), !g.sTitle && s && (g.sTitle = r.innerHTML.replace(/<.*?>/g, ""), g.autoTitle = !0)) : g.footer && (r.innerHTML = g.footer), g.ariaTitle || (g.ariaTitle = B(r).attr("aria-label") || g.sTitle), g.className) && B(r).addClass(g.className), 0 === B("span.dt-column-title", r).length && B("<span>").addClass("dt-column-title").append(r.childNodes).appendTo(r), d) && 0 === B("span.dt-column-order", r).length && B("<span>").addClass("dt-column-order").appendTo(r), i = 0; i < b; i++) {
          for (o = 0; o < y; o++) f[h + o][l + i] = {
            cell: r,
            unique: s
          }, f[h + o].row = a;
          D.push(l + i);
        }
        r.setAttribute("data-dt-column", x(D).join(","));
      }
      r = r.nextSibling;
    }
    return f;
  }
  function Ie(n, e, a) {
    function t(e) {
      var t = n.jqXHR ? n.jqXHR.status : null;
      (null === e || "number" == typeof t && 204 == t) && Ae(n, e = {}, []), (t = e.error || e.sError) && Z(n, 0, t), n.json = e, ee(n, null, "xhr", [n, e, n.jqXHR], !0), a(e);
    }
    var r,
      o = n.ajax,
      i = n.oInstance,
      l = (B.isPlainObject(o) && o.data && (l = "function" == typeof (r = o.data) ? r(e, n) : r, e = "function" == typeof r && l ? l : B.extend(!0, e, l), delete o.data), {
        url: "string" == typeof o ? o : "",
        data: e,
        success: t,
        dataType: "json",
        cache: !1,
        type: n.sServerMethod,
        error: function error(e, t) {
          -1 === ee(n, null, "xhr", [n, null, n.jqXHR], !0).indexOf(!0) && ("parsererror" == t ? Z(n, 0, "Invalid JSON response", 1) : 4 === e.readyState && Z(n, 0, "Ajax error", 7)), w(n, !1);
        }
      });
    B.isPlainObject(o) && B.extend(l, o), n.oAjaxData = e, ee(n, null, "preXhr", [n, e, l], !0), "function" == typeof o ? n.jqXHR = o.call(i, e, t, n) : "" === o.url ? (i = {}, $.util.set(o.dataSrc)(i, []), t(i)) : (n.jqXHR = B.ajax(l), r && (o.data = r));
  }
  function Ae(e, t, n) {
    var a = "data";
    if (B.isPlainObject(e.ajax) && void 0 !== e.ajax.dataSrc && ("string" == typeof (e = e.ajax.dataSrc) || "function" == typeof e ? a = e : void 0 !== e.data && (a = e.data)), !n) return "data" === a ? t.aaData || t[a] : "" !== a ? J(a)(t) : t;
    m(a)(t, n);
  }
  function Fe(e, t, n) {
    var e = B.isPlainObject(e.ajax) ? e.ajax.dataSrc : null;
    return e && e[t] ? J(e[t])(n) : (e = "", "draw" === t ? e = "sEcho" : "recordsTotal" === t ? e = "iTotalRecords" : "recordsFiltered" === t && (e = "iTotalDisplayRecords"), void 0 !== n[e] ? n[e] : n[t]);
  }
  function Le(n, e) {
    var t = n.aoPreSearchCols;
    if (X(n), "ssp" != te(n)) {
      for (var a, r, o, i, l, s = n, u = s.aoColumns, c = s.aoData, d = 0; d < c.length; d++) if (c[d] && !(l = c[d])._aFilterData) {
        for (o = [], a = 0, r = u.length; a < r; a++) u[a].bSearchable ? "string" != typeof (i = null === (i = G(s, d, a, "filter")) ? "" : i) && i.toString && (i = i.toString()) : i = "", i.indexOf && -1 !== i.indexOf("&") && (Pe.innerHTML = i, i = Re ? Pe.textContent : Pe.innerText), i.replace && (i = i.replace(/[\r\n\u2028]/g, "")), o.push(i);
        l._aFilterData = o, l._sFilterRow = o.join("  "), 0;
      }
      n.aiDisplay = n.aiDisplayMaster.slice(), Ne(n.aiDisplay, n, e.search, e), B.each(n.searchFixed, function (e, t) {
        Ne(n.aiDisplay, n, t, {});
      });
      for (var f = 0; f < t.length; f++) {
        var h = t[f];
        Ne(n.aiDisplay, n, h.search, h, f), B.each(n.aoColumns[f].searchFixed, function (e, t) {
          Ne(n.aiDisplay, n, t, {}, f);
        });
      }
      for (var p, g, m = n, v = $.ext.search, b = m.aiDisplay, y = 0, D = v.length; y < D; y++) {
        for (var x = [], S = 0, T = b.length; S < T; S++) g = b[S], p = m.aoData[g], v[y](m, p._aFilterData, g, p._aData, S) && x.push(g);
        b.length = 0, b.push.apply(b, x);
      }
    }
    n.bFiltered = !0, ee(n, null, "search", [n]);
  }
  function Ne(e, t, n, a, r) {
    if ("" !== n) for (var o = 0, i = "function" == typeof n ? n : null, l = n instanceof RegExp ? n : i ? null : function (e, t) {
        var a = [],
          t = B.extend({}, {
            boundary: !1,
            caseInsensitive: !0,
            exact: !1,
            regex: !1,
            smart: !0
          }, t);
        "string" != typeof e && (e = e.toString());
        if (e = R(e), t.exact) return new RegExp("^" + je(e) + "$", t.caseInsensitive ? "i" : "");
        {
          var n, r, o;
          e = t.regex ? e : je(e), t.smart && (n = (e.match(/!?["\u201C][^"\u201D]+["\u201D]|[^ ]+/g) || [""]).map(function (e) {
            var t,
              n = !1;
            return "!" === e.charAt(0) && (n = !0, e = e.substring(1)), '"' === e.charAt(0) ? e = (t = e.match(/^"(.*)"$/)) ? t[1] : e : "“" === e.charAt(0) && (e = (t = e.match(/^\u201C(.*)\u201D$/)) ? t[1] : e), n && (1 < e.length && a.push("(?!" + e + ")"), e = ""), e.replace('"', "");
          }), r = a.length ? a.join("") : "", o = t.boundary ? "\\b" : "", e = "^(?=.*?" + o + n.join(")(?=.*?" + o) + ")(" + r + ".)*$");
        }
        return new RegExp(e, t.caseInsensitive ? "i" : "");
      }(n, a); o < e.length;) {
      var s = t.aoData[e[o]],
        u = void 0 === r ? s._sFilterRow : s._aFilterData[r];
      (i && !i(u, s._aData, e[o], r) || l && !l.test(u)) && (e.splice(o, 1), o--), o++;
    }
  }
  var je = $.util.escapeRegex,
    Pe = B("<div>")[0],
    Re = void 0 !== Pe.textContent;
  function Oe(n) {
    var a,
      e,
      t,
      r,
      o,
      i,
      l = n.iInitDisplayStart;
    n.bInitialised ? (ye(n, "header"), ye(n, "footer"), xe(n, n.aoHeader), xe(n, n.aoFooter), _e(n), t = (e = n).nTHead, i = t.querySelectorAll("tr"), r = e.bSortCellsTop, o = ':not([data-dt-order="disable"]):not([data-dt-order="icon-only"])', !0 === r ? t = i[0] : !1 === r && (t = i[i.length - 1]), Ve(e, t, t === e.nTHead ? "tr" + o + " th" + o + ", tr" + o + " td" + o : "th" + o + ", td" + o), qe(e, r = [], e.aaSorting), e.aaSorting = r, Xe(n), w(n, !0), ee(n, null, "preInit", [n], !0), s(n), "ssp" != (i = te(n)) && ("ajax" == i ? Ie(n, {}, function (e) {
      var t = Ae(n, e);
      for (a = 0; a < t.length; a++) Y(n, t[a]);
      n.iInitDisplayStart = l, s(n), w(n, !1), ke(n);
    }) : (ke(n), w(n, !1)))) : setTimeout(function () {
      Oe(n);
    }, 200);
  }
  function ke(e) {
    var t;
    e._bInitComplete || (t = [e, e.json], e._bInitComplete = !0, E(e), ee(e, null, "plugin-init", t, !0), ee(e, "aoInitComplete", "init", t, !0));
  }
  function Ee(e, t) {
    t = parseInt(t, 10);
    e._iDisplayLength = t, Qe(e), ee(e, null, "length", [e, t]);
  }
  function Me(e, t, n) {
    var a = e._iDisplayStart,
      r = e._iDisplayLength,
      o = e.fnRecordsDisplay();
    if (0 === o || -1 === r) a = 0;else if ("number" == typeof t) o < (a = t * r) && (a = 0);else if ("first" == t) a = 0;else if ("previous" == t) (a = 0 <= r ? a - r : 0) < 0 && (a = 0);else if ("next" == t) a + r < o && (a += r);else if ("last" == t) a = Math.floor((o - 1) / r) * r;else {
      if ("ellipsis" === t) return;
      Z(e, 0, "Unknown paging action: " + t, 5);
    }
    o = e._iDisplayStart !== a;
    e._iDisplayStart = a, ee(e, null, o ? "page" : "page-nc", [e]), o && n && S(e);
  }
  function w(e, t) {
    ee(e, null, "processing", [e, t]);
  }
  function He(e) {
    var t,
      n,
      a,
      r,
      o,
      i,
      l,
      s,
      u,
      c,
      d,
      f,
      h,
      p = B(e.nTable),
      g = e.oScroll;
    return "" === g.sX && "" === g.sY ? e.nTable : (t = g.sX, n = g.sY, a = e.oClasses.scrolling, o = (r = e.captionNode) ? r._captionSide : null, u = B(p[0].cloneNode(!1)), i = B(p[0].cloneNode(!1)), c = function c(e) {
      return e ? A(e) : null;
    }, (l = p.children("tfoot")).length || (l = null), u = B(s = "<div/>", {
      "class": a.container
    }).append(B(s, {
      "class": a.header.self
    }).css({
      overflow: "hidden",
      position: "relative",
      border: 0,
      width: t ? c(t) : "100%"
    }).append(B(s, {
      "class": a.header.inner
    }).css({
      "box-sizing": "content-box",
      width: g.sXInner || "100%"
    }).append(u.removeAttr("id").css("margin-left", 0).append("top" === o ? r : null).append(p.children("thead"))))).append(B(s, {
      "class": a.body
    }).css({
      position: "relative",
      overflow: "auto",
      width: c(t)
    }).append(p)), l && u.append(B(s, {
      "class": a.footer.self
    }).css({
      overflow: "hidden",
      border: 0,
      width: t ? c(t) : "100%"
    }).append(B(s, {
      "class": a.footer.inner
    }).append(i.removeAttr("id").css("margin-left", 0).append("bottom" === o ? r : null).append(p.children("tfoot"))))), c = u.children(), d = c[0], f = c[1], h = l ? c[2] : null, B(f).on("scroll.DT", function () {
      var e = this.scrollLeft;
      d.scrollLeft = e, l && (h.scrollLeft = e);
    }), B("th, td", d).on("focus", function () {
      var e = d.scrollLeft;
      f.scrollLeft = e, l && (f.scrollLeft = e);
    }), B(f).css("max-height", n), g.bCollapse || B(f).css("height", n), e.nScrollHead = d, e.nScrollBody = f, e.nScrollFoot = h, e.aoDrawCallback.push(We), u[0]);
  }
  function We(e) {
    var t,
      n,
      a = e.oScroll.iBarWidth,
      r = B(e.nScrollHead).children("div"),
      o = r.children("table"),
      i = e.nScrollBody,
      l = B(i),
      s = B(e.nScrollFoot).children("div"),
      u = s.children("table"),
      c = B(e.nTHead),
      d = B(e.nTable),
      f = e.nTFoot && B("th, td", e.nTFoot).length ? B(e.nTFoot) : null,
      h = e.oBrowser,
      p = i.scrollHeight > i.clientHeight;
    e.scrollBarVis !== p && void 0 !== e.scrollBarVis ? (e.scrollBarVis = p, E(e)) : (e.scrollBarVis = p, d.children("thead, tfoot").remove(), (p = c.clone().prependTo(d)).find("th, td").removeAttr("tabindex"), p.find("[id]").removeAttr("id"), f && (n = f.clone().prependTo(d)).find("[id]").removeAttr("id"), e.aiDisplay.length && (t = d.find("tbody tr").eq(0).find("th, td").map(function () {
      return B(this).outerWidth();
    }), B("col", e.colgroup).each(function (e) {
      this.style.width.replace("px", "") !== t[e] && (this.style.width = t[e] + "px");
    })), o.find("colgroup").remove(), o.append(e.colgroup.clone()), f && (u.find("colgroup").remove(), u.append(e.colgroup.clone())), B("th, td", p).each(function () {
      B(this.childNodes).wrapAll('<div class="dt-scroll-sizing">');
    }), f && B("th, td", n).each(function () {
      B(this.childNodes).wrapAll('<div class="dt-scroll-sizing">');
    }), c = Math.floor(d.height()) > i.clientHeight || "scroll" == l.css("overflow-y"), p = "padding" + (h.bScrollbarLeft ? "Left" : "Right"), n = d.outerWidth(), o.css("width", A(n)), r.css("width", A(n)).css(p, c ? a + "px" : "0px"), f && (u.css("width", A(n)), s.css("width", A(n)).css(p, c ? a + "px" : "0px")), d.children("colgroup").prependTo(d), l.trigger("scroll"), !e.bSorted && !e.bFiltered || e._drawHold || (i.scrollTop = 0));
  }
  function A(e) {
    return null === e ? "0px" : "number" == typeof e ? e < 0 ? "0px" : e + "px" : e.match(/\d$/) ? e + "px" : e;
  }
  function Xe(e) {
    var t = e.aoColumns;
    for (e.colgroup.empty(), a = 0; a < t.length; a++) t[a].bVisible && e.colgroup.append(t[a].colEl);
  }
  function Ve(o, e, t, i, l) {
    Ze(e, t, function (e) {
      var t = !1,
        n = void 0 === i ? le(e.target) : [i];
      if (n.length) {
        for (var a = 0, r = n.length; a < r; a++) if (!1 !== function (e, t, n, a) {
          function r(e, t) {
            var n = e._idx;
            return (n = void 0 === n ? s.indexOf(e[1]) : n) + 1 < s.length ? n + 1 : t ? null : 0;
          }
          var o,
            i = e.aoColumns[t],
            l = e.aaSorting,
            s = i.asSorting;
          if (!i.bSortable) return !1;
          "number" == typeof l[0] && (l = e.aaSorting = [l]);
          (a || n) && e.oFeatures.bSortMulti ? -1 !== (i = f(l, "0").indexOf(t)) ? null === (o = null === (o = r(l[i], !0)) && 1 === l.length ? 0 : o) ? l.splice(i, 1) : (l[i][1] = s[o], l[i]._idx = o) : (a ? l.push([t, s[0], 0]) : l.push([t, l[0][1], 0]), l[l.length - 1]._idx = 0) : l.length && l[0][0] == t ? (o = r(l[0]), l.length = 1, l[0][1] = s[o], l[0]._idx = o) : (l.length = 0, l.push([t, s[0]]), l[0]._idx = 0);
        }(o, n[a], a, e.shiftKey) && (t = !0), 1 === o.aaSorting.length && "" === o.aaSorting[0][1]) break;
        t && (w(o, !0), setTimeout(function () {
          $e(o), Be(o, o.aiDisplay), w(o, !1), s(o, !1, !1), l && l();
        }, 0));
      }
    });
  }
  function Be(e, t) {
    for (var n = e.aiDisplayMaster, a = {}, r = {}, o = 0; o < n.length; o++) a[n[o]] = o;
    for (o = 0; o < t.length; o++) r[t[o]] = a[t[o]];
    t.sort(function (e, t) {
      return r[e] - r[t];
    });
  }
  function qe(n, a, e) {
    function t(e) {
      var t;
      B.isPlainObject(e) ? void 0 !== e.idx ? a.push([e.idx, e.dir]) : e.name && -1 !== (t = f(n.aoColumns, "sName").indexOf(e.name)) && a.push([t, e.dir]) : a.push(e);
    }
    if (B.isPlainObject(e)) t(e);else if (e.length && "number" == typeof e[0]) t(e);else if (e.length) for (var r = 0; r < e.length; r++) t(e[r]);
  }
  function Ue(e) {
    var t,
      n,
      a,
      r,
      o,
      i,
      l,
      s = [],
      u = $.ext.type.order,
      c = e.aoColumns,
      d = e.aaSortingFixed,
      f = B.isPlainObject(d),
      h = [];
    if (e.oFeatures.bSort) for (Array.isArray(d) && qe(e, h, d), f && d.pre && qe(e, h, d.pre), qe(e, h, e.aaSorting), f && d.post && qe(e, h, d.post), t = 0; t < h.length; t++) if (c[l = h[t][0]]) for (n = 0, a = (r = c[l].aDataSort).length; n < a; n++) i = c[o = r[n]].sType || "string", void 0 === h[t]._idx && (h[t]._idx = c[o].asSorting.indexOf(h[t][1])), h[t][1] && s.push({
      src: l,
      col: o,
      dir: h[t][1],
      index: h[t]._idx,
      type: i,
      formatter: u[i + "-pre"],
      sorter: u[i + "-" + h[t][1]]
    });
    return s;
  }
  function $e(e, t, n) {
    var a,
      r,
      o,
      i,
      l,
      c,
      d = [],
      s = $.ext.type.order,
      f = e.aoData,
      u = e.aiDisplayMaster;
    for (X(e), void 0 !== t ? (l = e.aoColumns[t], c = [{
      src: t,
      col: t,
      dir: n,
      index: 0,
      type: l.sType,
      formatter: s[l.sType + "-pre"],
      sorter: s[l.sType + "-" + n]
    }], u = u.slice()) : c = Ue(e), a = 0, r = c.length; a < r; a++) {
      i = c[a], S = x = D = g = p = h = y = b = v = m = void 0;
      var h,
        p,
        g,
        m = e,
        v = i.col,
        b = m.aoColumns[v],
        y = $.ext.order[b.sSortDataType];
      y && (h = y.call(m.oInstance, m, v, T(m, v)));
      for (var D = $.ext.type.order[b.sType + "-pre"], x = m.aoData, S = 0; S < x.length; S++) x[S] && ((p = x[S])._aSortData || (p._aSortData = []), p._aSortData[v] && !y || (g = y ? h[S] : G(m, S, v, "sort"), p._aSortData[v] = D ? D(g, m) : g));
    }
    if ("ssp" != te(e) && 0 !== c.length) {
      for (a = 0, o = u.length; a < o; a++) d[a] = a;
      c.length && "desc" === c[0].dir && d.reverse(), u.sort(function (e, t) {
        for (var n, a, r, o, i = c.length, l = f[e]._aSortData, s = f[t]._aSortData, u = 0; u < i; u++) if (n = l[(o = c[u]).col], a = s[o.col], o.sorter) {
          if (0 !== (r = o.sorter(n, a))) return r;
        } else if (0 !== (r = n < a ? -1 : a < n ? 1 : 0)) return "asc" === o.dir ? r : -r;
        return (n = d[e]) < (a = d[t]) ? -1 : a < n ? 1 : 0;
      });
    } else 0 === c.length && u.sort(function (e, t) {
      return e < t ? -1 : t < e ? 1 : 0;
    });
    return void 0 === t && (e.bSorted = !0, ee(e, null, "order", [e, c])), u;
  }
  function ze(e) {
    var t,
      n,
      a,
      r = e.aLastSort,
      o = e.oClasses.order.position,
      i = Ue(e),
      l = e.oFeatures;
    if (l.bSort && l.bSortClasses) {
      for (t = 0, n = r.length; t < n; t++) a = r[t].src, B(f(e.aoData, "anCells", a)).removeClass(o + (t < 2 ? t + 1 : 3));
      for (t = 0, n = i.length; t < n; t++) a = i[t].src, B(f(e.aoData, "anCells", a)).addClass(o + (t < 2 ? t + 1 : 3));
    }
    e.aLastSort = i;
  }
  function Ye(n) {
    var e;
    n._bLoadingState || (e = {
      time: +new Date(),
      start: n._iDisplayStart,
      length: n._iDisplayLength,
      order: B.extend(!0, [], n.aaSorting),
      search: B.extend({}, n.oPreviousSearch),
      columns: n.aoColumns.map(function (e, t) {
        return {
          visible: e.bVisible,
          search: B.extend({}, n.aoPreSearchCols[t])
        };
      })
    }, n.oSavedState = e, ee(n, "aoStateSaveParams", "stateSaveParams", [n, e]), n.oFeatures.bStateSave && !n.bDestroying && n.fnStateSaveCallback.call(n.oInstance, n, e));
  }
  function Ge(n, e, t) {
    var a,
      r,
      o = n.aoColumns,
      i = (n._bLoadingState = !0, n._bInitComplete ? new $.Api(n) : null);
    if (e && e.time) {
      var l = n.iStateDuration;
      if (0 < l && e.time < +new Date() - 1e3 * l) n._bLoadingState = !1;else if (-1 !== ee(n, "aoStateLoadParams", "stateLoadParams", [n, e]).indexOf(!1)) n._bLoadingState = !1;else if (e.columns && o.length !== e.columns.length) n._bLoadingState = !1;else {
        if (n.oLoadedState = B.extend(!0, {}, e), ee(n, null, "stateLoadInit", [n, e], !0), void 0 !== e.length && (i ? i.page.len(e.length) : n._iDisplayLength = e.length), void 0 !== e.start && (null === i ? (n._iDisplayStart = e.start, n.iInitDisplayStart = e.start) : Me(n, e.start / n._iDisplayLength)), void 0 !== e.order && (n.aaSorting = [], B.each(e.order, function (e, t) {
          n.aaSorting.push(t[0] >= o.length ? [0, t[1]] : t);
        })), void 0 !== e.search && B.extend(n.oPreviousSearch, e.search), e.columns) {
          for (a = 0, r = e.columns.length; a < r; a++) {
            var s = e.columns[a];
            void 0 !== s.visible && (i ? i.column(a).visible(s.visible, !1) : o[a].bVisible = s.visible), void 0 !== s.search && B.extend(n.aoPreSearchCols[a], s.search);
          }
          i && i.columns.adjust();
        }
        n._bLoadingState = !1, ee(n, "aoStateLoaded", "stateLoaded", [n, e]);
      }
    } else n._bLoadingState = !1;
    t();
  }
  function Z(e, t, n, a) {
    if (n = "DataTables warning: " + (e ? "table id=" + e.sTableId + " - " : "") + n, a && (n += ". For more information about this error, please see https://datatables.net/tn/" + a), t) q.console && console.log && console.log(n);else {
      t = $.ext, t = t.sErrMode || t.errMode;
      if (e && ee(e, null, "dt-error", [e, a, n], !0), "alert" == t) alert(n);else {
        if ("throw" == t) throw new Error(n);
        "function" == typeof t && t(e, a, n);
      }
    }
  }
  function Q(n, a, e, t) {
    Array.isArray(e) ? B.each(e, function (e, t) {
      Array.isArray(t) ? Q(n, a, t[0], t[1]) : Q(n, a, t);
    }) : (void 0 === t && (t = e), void 0 !== a[e] && (n[t] = a[e]));
  }
  function Je(e, t, n) {
    var a, r;
    for (r in t) Object.prototype.hasOwnProperty.call(t, r) && (a = t[r], B.isPlainObject(a) ? (B.isPlainObject(e[r]) || (e[r] = {}), B.extend(!0, e[r], a)) : n && "data" !== r && "aaData" !== r && Array.isArray(a) ? e[r] = a.slice() : e[r] = a);
    return e;
  }
  function Ze(e, t, n) {
    B(e).on("click.DT", t, function (e) {
      n(e);
    }).on("keypress.DT", t, function (e) {
      13 === e.which && (e.preventDefault(), n(e));
    }).on("selectstart.DT", t, function () {
      return !1;
    });
  }
  function K(e, t, n) {
    n && e[t].push(n);
  }
  function ee(t, e, n, a, r) {
    var o = [];
    return e && (o = t[e].slice().reverse().map(function (e) {
      return e.apply(t.oInstance, a);
    })), null !== n && (e = B.Event(n + ".dt"), n = B(t.nTable), e.dt = t.api, n[r ? "trigger" : "triggerHandler"](e, a), r && 0 === n.parents("body").length && B("body").trigger(e, a), o.push(e.result)), o;
  }
  function Qe(e) {
    var t = e._iDisplayStart,
      n = e.fnDisplayEnd(),
      a = e._iDisplayLength;
    n <= t && (t = n - a), t -= t % a, e._iDisplayStart = t = -1 === a || t < 0 ? 0 : t;
  }
  function Ke(e, t) {
    var e = e.renderer,
      n = $.ext.renderer[t];
    return B.isPlainObject(e) && e[t] ? n[e[t]] || n._ : "string" == typeof e && n[e] || n._;
  }
  function te(e) {
    return e.oFeatures.bServerSide ? "ssp" : e.ajax ? "ajax" : "dom";
  }
  function et(e, t, n) {
    var a = e.fnFormatNumber,
      r = e._iDisplayStart + 1,
      o = e._iDisplayLength,
      i = e.fnRecordsDisplay(),
      l = e.fnRecordsTotal(),
      s = -1 === o;
    return t.replace(/_START_/g, a.call(e, r)).replace(/_END_/g, a.call(e, e.fnDisplayEnd())).replace(/_MAX_/g, a.call(e, l)).replace(/_TOTAL_/g, a.call(e, i)).replace(/_PAGE_/g, a.call(e, s ? 1 : Math.ceil(r / o))).replace(/_PAGES_/g, a.call(e, s ? 1 : Math.ceil(i / o))).replace(/_ENTRIES_/g, e.api.i18n("entries", "", n)).replace(/_ENTRIES-MAX_/g, e.api.i18n("entries", "", l)).replace(/_ENTRIES-TOTAL_/g, e.api.i18n("entries", "", i));
  }
  var tt = [],
    n = Array.prototype;
  _U = function U(e, t) {
    if (!(this instanceof _U)) return new _U(e, t);
    function n(e) {
      e = e, t = $.settings, a = f(t, "nTable");
      var n,
        t,
        a,
        r = e ? e.nTable && e.oFeatures ? [e] : e.nodeName && "table" === e.nodeName.toLowerCase() ? -1 !== (r = a.indexOf(e)) ? [t[r]] : null : e && "function" == typeof e.settings ? e.settings().toArray() : ("string" == typeof e ? n = B(e).get() : e instanceof B && (n = e.get()), n ? t.filter(function (e, t) {
          return n.includes(a[t]);
        }) : void 0) : [];
      r && o.push.apply(o, r);
    }
    var o = [];
    if (Array.isArray(e)) for (var a = 0, r = e.length; a < r; a++) n(e[a]);else n(e);
    this.context = 1 < o.length ? x(o) : o, t && this.push.apply(this, t), this.selector = {
      rows: null,
      cols: null,
      opts: null
    }, _U.extend(this, this, tt);
  }, $.Api = _U, B.extend(_U.prototype, {
    any: function any() {
      return 0 !== this.count();
    },
    context: [],
    count: function count() {
      return this.flatten().length;
    },
    each: function each(e) {
      for (var t = 0, n = this.length; t < n; t++) e.call(this, this[t], t, this);
      return this;
    },
    eq: function eq(e) {
      var t = this.context;
      return t.length > e ? new _U(t[e], this[e]) : null;
    },
    filter: function filter(e) {
      e = n.filter.call(this, e, this);
      return new _U(this.context, e);
    },
    flatten: function flatten() {
      var e = [];
      return new _U(this.context, e.concat.apply(e, this.toArray()));
    },
    get: function get(e) {
      return this[e];
    },
    join: n.join,
    includes: function includes(e) {
      return -1 !== this.indexOf(e);
    },
    indexOf: n.indexOf,
    iterator: function iterator(e, t, n, a) {
      var r,
        o,
        i,
        l,
        s,
        u,
        c,
        d,
        f = [],
        h = this.context,
        p = this.selector;
      for ("string" == typeof e && (a = n, n = t, t = e, e = !1), o = 0, i = h.length; o < i; o++) {
        var g = new _U(h[o]);
        if ("table" === t) void 0 !== (r = n.call(g, h[o], o)) && f.push(r);else if ("columns" === t || "rows" === t) void 0 !== (r = n.call(g, h[o], this[o], o)) && f.push(r);else if ("every" === t || "column" === t || "column-rows" === t || "row" === t || "cell" === t) for (c = this[o], "column-rows" === t && (u = dt(h[o], p.opts)), l = 0, s = c.length; l < s; l++) d = c[l], void 0 !== (r = "cell" === t ? n.call(g, h[o], d.row, d.column, o, l) : n.call(g, h[o], d, o, l, u)) && f.push(r);
      }
      return f.length || a ? ((e = (a = new _U(h, e ? f.concat.apply([], f) : f)).selector).rows = p.rows, e.cols = p.cols, e.opts = p.opts, a) : this;
    },
    lastIndexOf: n.lastIndexOf,
    length: 0,
    map: function map(e) {
      e = n.map.call(this, e, this);
      return new _U(this.context, e);
    },
    pluck: function pluck(e) {
      var t = $.util.get(e);
      return this.map(function (e) {
        return t(e);
      });
    },
    pop: n.pop,
    push: n.push,
    reduce: n.reduce,
    reduceRight: n.reduceRight,
    reverse: n.reverse,
    selector: null,
    shift: n.shift,
    slice: function slice() {
      return new _U(this.context, this);
    },
    sort: n.sort,
    splice: n.splice,
    toArray: function toArray() {
      return n.slice.call(this);
    },
    to$: function to$() {
      return B(this);
    },
    toJQuery: function toJQuery() {
      return B(this);
    },
    unique: function unique() {
      return new _U(this.context, x(this.toArray()));
    },
    unshift: n.unshift
  }), q.__apiStruct = tt, _U.extend = function (e, t, n) {
    if (n.length && t && (t instanceof _U || t.__dt_wrapper)) for (var a, r = 0, o = n.length; r < o; r++) t[(a = n[r]).name] = "function" === a.type ? function (t, n, a) {
      return function () {
        var e = n.apply(t || this, arguments);
        return _U.extend(e, e, a.methodExt), e;
      };
    }(e, a.val, a) : "object" === a.type ? {} : a.val, t[a.name].__dt_wrapper = !0, _U.extend(e, t[a.name], a.propExt);
  }, _U.register = t = function t(e, _t2) {
    if (Array.isArray(e)) for (var n = 0, a = e.length; n < a; n++) _U.register(e[n], _t2);else for (var r = e.split("."), o = tt, i = 0, l = r.length; i < l; i++) {
      var s,
        u,
        c = function (e, t) {
          for (var n = 0, a = e.length; n < a; n++) if (e[n].name === t) return e[n];
          return null;
        }(o, u = (s = -1 !== r[i].indexOf("()")) ? r[i].replace("()", "") : r[i]);
      c || o.push(c = {
        name: u,
        val: {},
        methodExt: [],
        propExt: [],
        type: "object"
      }), i === l - 1 ? (c.val = _t2, c.type = "function" == typeof _t2 ? "function" : B.isPlainObject(_t2) ? "object" : "other") : o = s ? c.methodExt : c.propExt;
    }
  }, _U.registerPlural = e = function e(_e2, t, n) {
    _U.register(_e2, n), _U.register(t, function () {
      var e = n.apply(this, arguments);
      return e === this ? this : e instanceof _U ? e.length ? Array.isArray(e[0]) ? new _U(e.context, e[0]) : e[0] : void 0 : e;
    });
  };
  function nt(e, t) {
    var n, a;
    return Array.isArray(e) ? (n = [], e.forEach(function (e) {
      e = nt(e, t);
      n.push.apply(n, e);
    }), n.filter(function (e) {
      return e;
    })) : "number" == typeof e ? [t[e]] : (a = t.map(function (e) {
      return e.nTable;
    }), B(a).filter(e).map(function () {
      var e = a.indexOf(this);
      return t[e];
    }).toArray());
  }
  function at(r, o, e) {
    var t, n;
    e && (t = new _U(r)).one("draw", function () {
      e(t.ajax.json());
    }), "ssp" == te(r) ? s(r, o) : (w(r, !0), (n = r.jqXHR) && 4 !== n.readyState && n.abort(), Ie(r, {}, function (e) {
      he(r);
      for (var t = Ae(r, e), n = 0, a = t.length; n < a; n++) Y(r, t[n]);
      s(r, o), ke(r), w(r, !1);
    }));
  }
  function rt(e, t, n, a, r) {
    for (var o, i, l, s, u = [], c = _typeof(t), d = 0, f = (t = t && "string" != c && "function" != c && void 0 !== t.length ? t : [t]).length; d < f; d++) for (l = 0, s = (i = t[d] && t[d].split && !t[d].match(/[[(:]/) ? t[d].split(",") : [t[d]]).length; l < s; l++) (o = (o = n("string" == typeof i[l] ? i[l].trim() : i[l])).filter(function (e) {
      return null != e;
    })) && o.length && (u = u.concat(o));
    var h = C.selector[e];
    if (h.length) for (d = 0, f = h.length; d < f; d++) u = h[d](a, r, u);
    return x(u);
  }
  function ot(e) {
    return (e = e || {}).filter && void 0 === e.search && (e.search = e.filter), B.extend({
      search: "none",
      order: "current",
      page: "all"
    }, e);
  }
  function it(e) {
    var t = new _U(e.context[0]);
    return e.length && t.push(e[0]), t.selector = e.selector, t.length && 1 < t[0].length && t[0].splice(1), t;
  }
  t("tables()", function (e) {
    return null != e ? new _U(nt(e, this.context)) : this;
  }), t("table()", function (e) {
    var e = this.tables(e),
      t = e.context;
    return t.length ? new _U(t[0]) : e;
  }), [["nodes", "node", "nTable"], ["body", "body", "nTBody"], ["header", "header", "nTHead"], ["footer", "footer", "nTFoot"]].forEach(function (t) {
    e("tables()." + t[0] + "()", "table()." + t[1] + "()", function () {
      return this.iterator("table", function (e) {
        return e[t[2]];
      }, 1);
    });
  }), [["header", "aoHeader"], ["footer", "aoFooter"]].forEach(function (n) {
    t("table()." + n[0] + ".structure()", function (e) {
      var e = this.columns(e).indexes().flatten(),
        t = this.context[0];
      return De(t, t[n[1]], e);
    });
  }), e("tables().containers()", "table().container()", function () {
    return this.iterator("table", function (e) {
      return e.nTableWrapper;
    }, 1);
  }), t("tables().every()", function (n) {
    var a = this;
    return this.iterator("table", function (e, t) {
      n.call(a.table(t), t);
    });
  }), t("caption()", function (r, o) {
    var e,
      t = this.context;
    return void 0 === r ? (e = t[0].captionNode) && t.length ? e.innerHTML : null : this.iterator("table", function (e) {
      var t = B(e.nTable),
        n = B(e.captionNode),
        a = B(e.nTableWrapper);
      n.length || (n = B("<caption/>").html(r), e.captionNode = n[0], o) || (t.prepend(n), o = n.css("caption-side")), n.html(r), o && (n.css("caption-side", o), n[0]._captionSide = o), (a.find("div.dataTables_scroll").length ? (e = "top" === o ? "Head" : "Foot", a.find("div.dataTables_scroll" + e + " table")) : t).prepend(n);
    }, 1);
  }), t("caption.node()", function () {
    var e = this.context;
    return e.length ? e[0].captionNode : null;
  }), t("draw()", function (t) {
    return this.iterator("table", function (e) {
      "page" === t ? S(e) : s(e, !1 === (t = "string" == typeof t ? "full-hold" !== t : t));
    });
  }), t("page()", function (t) {
    return void 0 === t ? this.page.info().page : this.iterator("table", function (e) {
      Me(e, t);
    });
  }), t("page.info()", function () {
    var e, t, n, a, r;
    if (0 !== this.context.length) return t = (e = this.context[0])._iDisplayStart, n = e.oFeatures.bPaginate ? e._iDisplayLength : -1, a = e.fnRecordsDisplay(), {
      page: (r = -1 === n) ? 0 : Math.floor(t / n),
      pages: r ? 1 : Math.ceil(a / n),
      start: t,
      end: e.fnDisplayEnd(),
      length: n,
      recordsTotal: e.fnRecordsTotal(),
      recordsDisplay: a,
      serverSide: "ssp" === te(e)
    };
  }), t("page.len()", function (t) {
    return void 0 === t ? 0 !== this.context.length ? this.context[0]._iDisplayLength : void 0 : this.iterator("table", function (e) {
      Ee(e, t);
    });
  }), t("ajax.json()", function () {
    var e = this.context;
    if (0 < e.length) return e[0].json;
  }), t("ajax.params()", function () {
    var e = this.context;
    if (0 < e.length) return e[0].oAjaxData;
  }), t("ajax.reload()", function (t, n) {
    return this.iterator("table", function (e) {
      at(e, !1 === n, t);
    });
  }), t("ajax.url()", function (t) {
    var e = this.context;
    return void 0 === t ? 0 === e.length ? void 0 : (e = e[0], B.isPlainObject(e.ajax) ? e.ajax.url : e.ajax) : this.iterator("table", function (e) {
      B.isPlainObject(e.ajax) ? e.ajax.url = t : e.ajax = t;
    });
  }), t("ajax.url().load()", function (t, n) {
    return this.iterator("table", function (e) {
      at(e, !1 === n, t);
    });
  });
  function lt(o, i, e, t) {
    function l(e, t) {
      var n;
      if (Array.isArray(e) || e instanceof B) for (var a = 0, r = e.length; a < r; a++) l(e[a], t);else e.nodeName && "tr" === e.nodeName.toLowerCase() ? (e.setAttribute("data-dt-row", i.idx), s.push(e)) : (n = B("<tr><td></td></tr>").attr("data-dt-row", i.idx).addClass(t), B("td", n).addClass(t).html(e)[0].colSpan = H(o), s.push(n[0]));
    }
    var s = [];
    l(e, t), i._details && i._details.detach(), i._details = B(s), i._detailsShow && i._details.insertAfter(i.nTr);
  }
  function st(e, t) {
    var n = e.context;
    if (n.length && e.length) {
      var a = n[0].aoData[e[0]];
      if (a._details) {
        (a._detailsShow = t) ? (a._details.insertAfter(a.nTr), B(a.nTr).addClass("dt-hasChild")) : (a._details.detach(), B(a.nTr).removeClass("dt-hasChild")), ee(n[0], null, "childRow", [t, e.row(e[0])]);
        var i = n[0],
          r = new _U(i),
          a = ".dt.DT_details",
          t = "draw" + a,
          e = "column-sizing" + a,
          a = "destroy" + a,
          l = i.aoData;
        if (r.off(t + " " + e + " " + a), f(l, "_details").length > 0) {
          r.on(t, function (e, t) {
            if (i !== t) return;
            r.rows({
              page: "current"
            }).eq(0).each(function (e) {
              var t = l[e];
              if (t._detailsShow) t._details.insertAfter(t.nTr);
            });
          });
          r.on(e, function (e, t) {
            if (i !== t) return;
            var n,
              a = H(t);
            for (var r = 0, o = l.length; r < o; r++) {
              n = l[r];
              if (n && n._details) n._details.each(function () {
                var e = B(this).children("td");
                if (e.length == 1) e.attr("colspan", a);
              });
            }
          });
          r.on(a, function (e, t) {
            if (i !== t) return;
            for (var n = 0, a = l.length; n < a; n++) if (l[n] && l[n]._details) pt(r, n);
          });
        }
        ht(n);
      }
    }
  }
  function ut(e, t, n, a, r, o) {
    for (var i = [], l = 0, s = r.length; l < s; l++) i.push(G(e, r[l], t, o));
    return i;
  }
  function ct(t, n) {
    return function (e) {
      return y(e) || "string" != typeof e || (e = e.replace(d, " "), t && (e = I(e)), n && (e = R(e, !1))), e;
    };
  }
  var dt = function dt(e, t) {
      var n,
        a = [],
        r = e.aiDisplay,
        o = e.aiDisplayMaster,
        i = t.search,
        l = t.order,
        t = t.page;
      if ("ssp" == te(e)) return "removed" === i ? [] : h(0, o.length);
      if ("current" == t) for (u = e._iDisplayStart, c = e.fnDisplayEnd(); u < c; u++) a.push(r[u]);else if ("current" == l || "applied" == l) {
        if ("none" == i) a = o.slice();else if ("applied" == i) a = r.slice();else if ("removed" == i) {
          for (var s = {}, u = 0, c = r.length; u < c; u++) s[r[u]] = null;
          o.forEach(function (e) {
            Object.prototype.hasOwnProperty.call(s, e) || a.push(e);
          });
        }
      } else if ("index" == l || "original" == l) for (u = 0, c = e.aoData.length; u < c; u++) e.aoData[u] && ("none" == i || -1 === (n = r.indexOf(u)) && "removed" == i || 0 <= n && "applied" == i) && a.push(u);else if ("number" == typeof l) {
        var d = $e(e, l, "asc");
        if ("none" === i) a = d;else for (u = 0; u < d.length; u++) (-1 === (n = r.indexOf(d[u])) && "removed" == i || 0 <= n && "applied" == i) && a.push(d[u]);
      }
      return a;
    },
    ft = (t("rows()", function (n, a) {
      void 0 === n ? n = "" : B.isPlainObject(n) && (a = n, n = ""), a = ot(a);
      var e = this.iterator("table", function (e) {
        return t = rt("row", t = n, function (n) {
          var e = g(n),
            a = r.aoData;
          if (null !== e && !o) return [e];
          if (i = i || dt(r, o), null !== e && -1 !== i.indexOf(e)) return [e];
          if (null == n || "" === n) return i;
          if ("function" == typeof n) return i.map(function (e) {
            var t = a[e];
            return n(e, t._aData, t.nTr) ? e : null;
          });
          if (n.nodeName) return e = n._DT_RowIndex, t = n._DT_CellIndex, void 0 !== e ? a[e] && a[e].nTr === n ? [e] : [] : t ? a[t.row] && a[t.row].nTr === n.parentNode ? [t.row] : [] : (e = B(n).closest("*[data-dt-row]")).length ? [e.data("dt-row")] : [];
          if ("string" == typeof n && "#" === n.charAt(0)) {
            var t = r.aIds[n.replace(/^#/, "")];
            if (void 0 !== t) return [t.idx];
          }
          e = b(v(r.aoData, i, "nTr"));
          return B(e).filter(n).map(function () {
            return this._DT_RowIndex;
          }).toArray();
        }, r = e, o = a), "current" !== o.order && "applied" !== o.order || Be(r, t), t;
        var r, t, o, i;
      }, 1);
      return e.selector.rows = n, e.selector.opts = a, e;
    }), t("rows().nodes()", function () {
      return this.iterator("row", function (e, t) {
        return e.aoData[t].nTr || void 0;
      }, 1);
    }), t("rows().data()", function () {
      return this.iterator(!0, "rows", function (e, t) {
        return v(e.aoData, t, "_aData");
      }, 1);
    }), e("rows().cache()", "row().cache()", function (n) {
      return this.iterator("row", function (e, t) {
        e = e.aoData[t];
        return "search" === n ? e._aFilterData : e._aSortData;
      }, 1);
    }), e("rows().invalidate()", "row().invalidate()", function (n) {
      return this.iterator("row", function (e, t) {
        pe(e, t, n);
      });
    }), e("rows().indexes()", "row().index()", function () {
      return this.iterator("row", function (e, t) {
        return t;
      }, 1);
    }), e("rows().ids()", "row().id()", function (e) {
      for (var t = [], n = this.context, a = 0, r = n.length; a < r; a++) for (var o = 0, i = this[a].length; o < i; o++) {
        var l = n[a].rowIdFn(n[a].aoData[this[a][o]]._aData);
        t.push((!0 === e ? "#" : "") + l);
      }
      return new _U(n, t);
    }), e("rows().remove()", "row().remove()", function () {
      return this.iterator("row", function (e, t) {
        var n = e.aoData,
          a = n[t],
          r = e.aiDisplayMaster.indexOf(t),
          r = (-1 !== r && e.aiDisplayMaster.splice(r, 1), -1 !== (r = e.aiDisplay.indexOf(t)) && e.aiDisplay.splice(r, 1), 0 < e._iRecordsDisplay && e._iRecordsDisplay--, Qe(e), e.rowIdFn(a._aData));
        void 0 !== r && delete e.aIds[r], n[t] = null;
      }), this;
    }), t("rows.add()", function (o) {
      var e = this.iterator("table", function (e) {
          for (var t, n = [], a = 0, r = o.length; a < r; a++) (t = o[a]).nodeName && "TR" === t.nodeName.toUpperCase() ? n.push(se(e, t)[0]) : n.push(Y(e, t));
          return n;
        }, 1),
        t = this.rows(-1);
      return t.pop(), t.push.apply(t, e), t;
    }), t("row()", function (e, t) {
      return it(this.rows(e, t));
    }), t("row().data()", function (e) {
      var t,
        n = this.context;
      return void 0 === e ? n.length && this.length && this[0].length ? n[0].aoData[this[0]]._aData : void 0 : ((t = n[0].aoData[this[0]])._aData = e, Array.isArray(e) && t.nTr && t.nTr.id && m(n[0].rowId)(e, t.nTr.id), pe(n[0], this[0], "data"), this);
    }), t("row().node()", function () {
      var e = this.context;
      return e.length && this.length && this[0].length && e[0].aoData[this[0]].nTr || null;
    }), t("row.add()", function (t) {
      t instanceof B && t.length && (t = t[0]);
      var e = this.iterator("table", function (e) {
        return t.nodeName && "TR" === t.nodeName.toUpperCase() ? se(e, t)[0] : Y(e, t);
      });
      return this.row(e[0]);
    }), B(_).on("plugin-init.dt", function (e, t) {
      var a = new _U(t);
      a.on("stateSaveParams.DT", function (e, t, n) {
        for (var a = t.rowIdFn, r = t.aiDisplayMaster, o = [], i = 0; i < r.length; i++) {
          var l = r[i],
            l = t.aoData[l];
          l._detailsShow && o.push("#" + a(l._aData));
        }
        n.childRows = o;
      }), a.on("stateLoaded.DT", function (e, t, n) {
        ft(a, n);
      }), ft(a, a.state.loaded());
    }), function (e, t) {
      t && t.childRows && e.rows(t.childRows.map(function (e) {
        return e.replace(/:/g, "\\:");
      })).every(function () {
        ee(e.settings()[0], null, "requestChild", [this]);
      });
    }),
    ht = $.util.throttle(function (e) {
      Ye(e[0]);
    }, 500),
    pt = function pt(e, t) {
      var n = e.context;
      n.length && (t = n[0].aoData[void 0 !== t ? t : e[0]]) && t._details && (t._details.remove(), t._detailsShow = void 0, t._details = void 0, B(t.nTr).removeClass("dt-hasChild"), ht(n));
    },
    gt = "row().child",
    mt = gt + "()",
    vt = (t(mt, function (e, t) {
      var n = this.context;
      return void 0 === e ? n.length && this.length && n[0].aoData[this[0]] ? n[0].aoData[this[0]]._details : void 0 : (!0 === e ? this.child.show() : !1 === e ? pt(this) : n.length && this.length && lt(n[0], n[0].aoData[this[0]], e, t), this);
    }), t([gt + ".show()", mt + ".show()"], function () {
      return st(this, !0), this;
    }), t([gt + ".hide()", mt + ".hide()"], function () {
      return st(this, !1), this;
    }), t([gt + ".remove()", mt + ".remove()"], function () {
      return pt(this), this;
    }), t(gt + ".isShown()", function () {
      var e = this.context;
      return e.length && this.length && e[0].aoData[this[0]]._detailsShow || !1;
    }), /^([^:]+):(name|title|visIdx|visible)$/),
    mt = (t("columns()", function (n, a) {
      void 0 === n ? n = "" : B.isPlainObject(n) && (a = n, n = ""), a = ot(a);
      var e = this.iterator("table", function (e) {
        return t = n, l = a, s = (i = e).aoColumns, u = f(s, "sName"), c = f(s, "sTitle"), e = $.util.get("[].[].cell")(i.aoHeader), d = x(O([], e)), rt("column", t, function (n) {
          var a,
            e = g(n);
          if ("" === n) return h(s.length);
          if (null !== e) return [0 <= e ? e : s.length + e];
          if ("function" == typeof n) return a = dt(i, l), s.map(function (e, t) {
            return n(t, ut(i, t, 0, 0, a)) ? t : null;
          });
          var r = "string" == typeof n ? n.match(vt) : "";
          if (r) switch (r[2]) {
            case "visIdx":
            case "visible":
              var t,
                o = parseInt(r[1], 10);
              return o < 0 ? [(t = s.map(function (e, t) {
                return e.bVisible ? t : null;
              }))[t.length + o]] : [M(i, o)];
            case "name":
              return u.map(function (e, t) {
                return e === r[1] ? t : null;
              });
            case "title":
              return c.map(function (e, t) {
                return e === r[1] ? t : null;
              });
            default:
              return [];
          }
          return n.nodeName && n._DT_CellIndex ? [n._DT_CellIndex.column] : (e = B(d).filter(n).map(function () {
            return le(this);
          }).toArray()).length || !n.nodeName ? e : (e = B(n).closest("*[data-dt-column]")).length ? [e.data("dt-column")] : [];
        }, i, l);
        var i, t, l, s, u, c, d;
      }, 1);
      return e.selector.cols = n, e.selector.opts = a, e;
    }), e("columns().header()", "column().header()", function (a) {
      return this.iterator("column", function (e, t) {
        var n = e.aoHeader;
        return n[void 0 !== a ? a : e.bSortCellsTop ? 0 : n.length - 1][t].cell;
      }, 1);
    }), e("columns().footer()", "column().footer()", function (n) {
      return this.iterator("column", function (e, t) {
        return e.aoFooter.length ? e.aoFooter[void 0 !== n ? n : 0][t].cell : null;
      }, 1);
    }), e("columns().data()", "column().data()", function () {
      return this.iterator("column-rows", ut, 1);
    }), e("columns().render()", "column().render()", function (o) {
      return this.iterator("column-rows", function (e, t, n, a, r) {
        return ut(e, t, 0, 0, r, o);
      }, 1);
    }), e("columns().dataSrc()", "column().dataSrc()", function () {
      return this.iterator("column", function (e, t) {
        return e.aoColumns[t].mData;
      }, 1);
    }), e("columns().cache()", "column().cache()", function (o) {
      return this.iterator("column-rows", function (e, t, n, a, r) {
        return v(e.aoData, r, "search" === o ? "_aFilterData" : "_aSortData", t);
      }, 1);
    }), e("columns().init()", "column().init()", function () {
      return this.iterator("column", function (e, t) {
        return e.aoColumns[t];
      }, 1);
    }), e("columns().nodes()", "column().nodes()", function () {
      return this.iterator("column-rows", function (e, t, n, a, r) {
        return v(e.aoData, r, "anCells", t);
      }, 1);
    }), e("columns().titles()", "column().title()", function (n, a) {
      return this.iterator("column", function (e, t) {
        "number" == typeof n && (a = n, n = void 0);
        t = B("span.dt-column-title", this.column(t).header(a));
        return void 0 !== n ? (t.html(n), this) : t.html();
      }, 1);
    }), e("columns().types()", "column().type()", function () {
      return this.iterator("column", function (e, t) {
        t = e.aoColumns[t].sType;
        return t || X(e), t;
      }, 1);
    }), e("columns().visible()", "column().visible()", function (n, a) {
      var t = this,
        r = [],
        e = this.iterator("column", function (e, t) {
          if (void 0 === n) return e.aoColumns[t].bVisible;
          !function (e, t, n) {
            var a,
              r,
              o = e.aoColumns,
              i = o[t],
              l = e.aoData;
            if (void 0 === n) return i.bVisible;
            if (i.bVisible === n) return !1;
            if (n) for (var s = f(o, "bVisible").indexOf(!0, t + 1), u = 0, c = l.length; u < c; u++) l[u] && (r = l[u].nTr, a = l[u].anCells, r) && r.insertBefore(a[t], a[s] || null);else B(f(e.aoData, "anCells", t)).detach();
            return i.bVisible = n, Xe(e), !0;
          }(e, t, n) || r.push(t);
        });
      return void 0 !== n && this.iterator("table", function (e) {
        xe(e, e.aoHeader), xe(e, e.aoFooter), e.aiDisplay.length || B(e.nTBody).find("td[colspan]").attr("colspan", H(e)), Ye(e), t.iterator("column", function (e, t) {
          r.includes(t) && ee(e, null, "column-visibility", [e, t, n, a]);
        }), r.length && (void 0 === a || a) && t.columns.adjust();
      }), e;
    }), e("columns().widths()", "column().width()", function () {
      var e = this.columns(":visible").count(),
        e = B("<tr>").html("<td>" + Array(e).join("</td><td>") + "</td>"),
        n = (B(this.table().body()).append(e), e.children().map(function () {
          return B(this).outerWidth();
        }));
      return e.remove(), this.iterator("column", function (e, t) {
        e = T(e, t);
        return null !== e ? n[e] : 0;
      }, 1);
    }), e("columns().indexes()", "column().index()", function (n) {
      return this.iterator("column", function (e, t) {
        return "visible" === n ? T(e, t) : t;
      }, 1);
    }), t("columns.adjust()", function () {
      return this.iterator("table", function (e) {
        E(e);
      }, 1);
    }), t("column.index()", function (e, t) {
      var n;
      if (0 !== this.context.length) return n = this.context[0], "fromVisible" === e || "toData" === e ? M(n, t) : "fromData" === e || "toVisible" === e ? T(n, t) : void 0;
    }), t("column()", function (e, t) {
      return it(this.columns(e, t));
    }), t("cells()", function (g, e, m) {
      var a, r, o, i, l, s, t;
      return B.isPlainObject(g) && (void 0 === g.row ? (m = g, g = null) : (m = e, e = null)), B.isPlainObject(e) && (m = e, e = null), null == e ? this.iterator("table", function (e) {
        return a = e, e = g, t = ot(m), d = a.aoData, f = dt(a, t), n = b(v(d, f, "anCells")), h = B(O([], n)), p = a.aoColumns.length, rt("cell", e, function (e) {
          var t,
            n = "function" == typeof e;
          if (null == e || n) {
            for (o = [], i = 0, l = f.length; i < l; i++) for (r = f[i], s = 0; s < p; s++) u = {
              row: r,
              column: s
            }, (!n || (c = d[r], e(u, G(a, r, s), c.anCells ? c.anCells[s] : null))) && o.push(u);
            return o;
          }
          return B.isPlainObject(e) ? void 0 !== e.column && void 0 !== e.row && -1 !== f.indexOf(e.row) ? [e] : [] : (t = h.filter(e).map(function (e, t) {
            return {
              row: t._DT_CellIndex.row,
              column: t._DT_CellIndex.column
            };
          }).toArray()).length || !e.nodeName ? t : (c = B(e).closest("*[data-dt-row]")).length ? [{
            row: c.data("dt-row"),
            column: c.data("dt-column")
          }] : [];
        }, a, t);
        var a, t, r, o, i, l, s, u, c, d, f, n, h, p;
      }) : (t = m ? {
        page: m.page,
        order: m.order,
        search: m.search
      } : {}, a = this.columns(e, t), r = this.rows(g, t), t = this.iterator("table", function (e, t) {
        var n = [];
        for (o = 0, i = r[t].length; o < i; o++) for (l = 0, s = a[t].length; l < s; l++) n.push({
          row: r[t][o],
          column: a[t][l]
        });
        return n;
      }, 1), t = m && m.selected ? this.cells(t, m) : t, B.extend(t.selector, {
        cols: e,
        rows: g,
        opts: m
      }), t);
    }), e("cells().nodes()", "cell().node()", function () {
      return this.iterator("cell", function (e, t, n) {
        e = e.aoData[t];
        return e && e.anCells ? e.anCells[n] : void 0;
      }, 1);
    }), t("cells().data()", function () {
      return this.iterator("cell", function (e, t, n) {
        return G(e, t, n);
      }, 1);
    }), e("cells().cache()", "cell().cache()", function (a) {
      return a = "search" === a ? "_aFilterData" : "_aSortData", this.iterator("cell", function (e, t, n) {
        return e.aoData[t][a][n];
      }, 1);
    }), e("cells().render()", "cell().render()", function (a) {
      return this.iterator("cell", function (e, t, n) {
        return G(e, t, n, a);
      }, 1);
    }), e("cells().indexes()", "cell().index()", function () {
      return this.iterator("cell", function (e, t, n) {
        return {
          row: t,
          column: n,
          columnVisible: T(e, n)
        };
      }, 1);
    }), e("cells().invalidate()", "cell().invalidate()", function (a) {
      return this.iterator("cell", function (e, t, n) {
        pe(e, t, a, n);
      });
    }), t("cell()", function (e, t, n) {
      return it(this.cells(e, t, n));
    }), t("cell().data()", function (e) {
      var t,
        n,
        a,
        r,
        o,
        i = this.context,
        l = this[0];
      return void 0 === e ? i.length && l.length ? G(i[0], l[0].row, l[0].column) : void 0 : (t = i[0], n = l[0].row, a = l[0].column, r = t.aoColumns[a], o = t.aoData[n]._aData, r.fnSetData(o, e, {
        settings: t,
        row: n,
        col: a
      }), pe(i[0], l[0].row, "data", l[0].column), this);
    }), t("order()", function (t, e) {
      var n = this.context,
        a = Array.prototype.slice.call(arguments);
      return void 0 === t ? 0 !== n.length ? n[0].aaSorting : void 0 : ("number" == typeof t ? t = [[t, e]] : 1 < a.length && (t = a), this.iterator("table", function (e) {
        e.aaSorting = Array.isArray(t) ? t.slice() : t;
      }));
    }), t("order.listener()", function (t, n, a) {
      return this.iterator("table", function (e) {
        Ve(e, t, {}, n, a);
      });
    }), t("order.fixed()", function (t) {
      var e;
      return t ? this.iterator("table", function (e) {
        e.aaSortingFixed = B.extend(!0, {}, t);
      }) : (e = (e = this.context).length ? e[0].aaSortingFixed : void 0, Array.isArray(e) ? {
        pre: e
      } : e);
    }), t(["columns().order()", "column().order()"], function (n) {
      var a = this;
      return n ? this.iterator("table", function (e, t) {
        e.aaSorting = a[t].map(function (e) {
          return [e, n];
        });
      }) : this.iterator("column", function (e, t) {
        for (var n = Ue(e), a = 0, r = n.length; a < r; a++) if (n[a].col === t) return n[a].dir;
        return null;
      }, 1);
    }), e("columns().orderable()", "column().orderable()", function (n) {
      return this.iterator("column", function (e, t) {
        e = e.aoColumns[t];
        return n ? e.asSorting : e.bSortable;
      }, 1);
    }), t("processing()", function (t) {
      return this.iterator("table", function (e) {
        w(e, t);
      });
    }), t("search()", function (t, n, a, r) {
      var e = this.context;
      return void 0 === t ? 0 !== e.length ? e[0].oPreviousSearch.search : void 0 : this.iterator("table", function (e) {
        e.oFeatures.bFilter && Le(e, "object" == _typeof(n) ? B.extend(e.oPreviousSearch, n, {
          search: t
        }) : B.extend(e.oPreviousSearch, {
          search: t,
          regex: null !== n && n,
          smart: null === a || a,
          caseInsensitive: null === r || r
        }));
      });
    }), t("search.fixed()", function (t, n) {
      var e = this.iterator(!0, "table", function (e) {
        e = e.searchFixed;
        return t ? void 0 === n ? e[t] : (null === n ? delete e[t] : e[t] = n, this) : Object.keys(e);
      });
      return void 0 !== t && void 0 === n ? e[0] : e;
    }), e("columns().search()", "column().search()", function (a, r, o, i) {
      return this.iterator("column", function (e, t) {
        var n = e.aoPreSearchCols;
        if (void 0 === a) return n[t].search;
        e.oFeatures.bFilter && ("object" == _typeof(r) ? B.extend(n[t], r, {
          search: a
        }) : B.extend(n[t], {
          search: a,
          regex: null !== r && r,
          smart: null === o || o,
          caseInsensitive: null === i || i
        }), Le(e, e.oPreviousSearch));
      });
    }), t(["columns().search.fixed()", "column().search.fixed()"], function (n, a) {
      var e = this.iterator(!0, "column", function (e, t) {
        e = e.aoColumns[t].searchFixed;
        return n ? void 0 === a ? e[n] : (null === a ? delete e[n] : e[n] = a, this) : Object.keys(e);
      });
      return void 0 !== n && void 0 === a ? e[0] : e;
    }), t("state()", function (e, t) {
      var n;
      return e ? (n = B.extend(!0, {}, e), this.iterator("table", function (e) {
        !1 !== t && (n.time = +new Date() + 100), Ge(e, n, function () {});
      })) : this.context.length ? this.context[0].oSavedState : null;
    }), t("state.clear()", function () {
      return this.iterator("table", function (e) {
        e.fnStateSaveCallback.call(e.oInstance, e, {});
      });
    }), t("state.loaded()", function () {
      return this.context.length ? this.context[0].oLoadedState : null;
    }), t("state.save()", function () {
      return this.iterator("table", function (e) {
        Ye(e);
      });
    }), $.use = function (e, t) {
      "lib" === t || e.fn ? B = e : "win" == t || e.document ? _ = (q = e).document : "datetime" !== t && "DateTime" !== e.type || ($.DateTime = e);
    }, $.factory = function (e, t) {
      var n = !1;
      return e && e.document && (_ = (q = e).document), t && t.fn && t.fn.jquery && (B = t, n = !0), n;
    }, $.versionCheck = function (e, t) {
      for (var n, a, r = (t || $.version).split("."), o = e.split("."), i = 0, l = o.length; i < l; i++) if ((n = parseInt(r[i], 10) || 0) !== (a = parseInt(o[i], 10) || 0)) return a < n;
      return !0;
    }, $.isDataTable = function (e) {
      var r = B(e).get(0),
        o = !1;
      return e instanceof $.Api || (B.each($.settings, function (e, t) {
        var n = t.nScrollHead ? B("table", t.nScrollHead)[0] : null,
          a = t.nScrollFoot ? B("table", t.nScrollFoot)[0] : null;
        t.nTable !== r && n !== r && a !== r || (o = !0);
      }), o);
    }, $.tables = function (t) {
      var e = !1,
        n = (B.isPlainObject(t) && (e = t.api, t = t.visible), $.settings.filter(function (e) {
          return !(t && !B(e.nTable).is(":visible"));
        }).map(function (e) {
          return e.nTable;
        }));
      return e ? new _U(n) : n;
    }, $.camelToHungarian = z, t("$()", function (e, t) {
      t = this.rows(t).nodes(), t = B(t);
      return B([].concat(t.filter(e).toArray(), t.find(e).toArray()));
    }), B.each(["on", "one", "off"], function (e, n) {
      t(n + "()", function () {
        var e = Array.prototype.slice.call(arguments),
          t = (e[0] = e[0].split(/\s/).map(function (e) {
            return e.match(/\.dt\b/) ? e : e + ".dt";
          }).join(" "), B(this.tables().nodes()));
        return t[n].apply(t, e), this;
      });
    }), t("clear()", function () {
      return this.iterator("table", function (e) {
        he(e);
      });
    }), t("error()", function (t) {
      return this.iterator("table", function (e) {
        Z(e, 0, t);
      });
    }), t("settings()", function () {
      return new _U(this.context, this.context);
    }), t("init()", function () {
      var e = this.context;
      return e.length ? e[0].oInit : null;
    }), t("data()", function () {
      return this.iterator("table", function (e) {
        return f(e.aoData, "_aData");
      }).flatten();
    }), t("trigger()", function (t, n, a) {
      return this.iterator("table", function (e) {
        return ee(e, null, t, n, a);
      }).flatten();
    }), t("ready()", function (e) {
      var t = this.context;
      return e ? this.tables().every(function () {
        this.context[0]._bInitComplete ? e.call(this) : this.on("init", function () {
          e.call(this);
        });
      }) : t.length ? t[0]._bInitComplete || !1 : null;
    }), t("destroy()", function (c) {
      return c = c || !1, this.iterator("table", function (e) {
        var t = e.oClasses,
          n = e.nTable,
          a = e.nTBody,
          r = e.nTHead,
          o = e.nTFoot,
          i = B(n),
          a = B(a),
          l = B(e.nTableWrapper),
          s = e.aoData.map(function (e) {
            return e ? e.nTr : null;
          }),
          u = t.order,
          o = (e.bDestroying = !0, ee(e, "aoDestroyCallback", "destroy", [e], !0), c || new _U(e).columns().visible(!0), l.off(".DT").find(":not(tbody *)").off(".DT"), B(q).off(".DT-" + e.sInstance), n != r.parentNode && (i.children("thead").detach(), i.append(r)), o && n != o.parentNode && (i.children("tfoot").detach(), i.append(o)), e.colgroup.remove(), e.aaSorting = [], e.aaSortingFixed = [], ze(e), B("th, td", r).removeClass(u.canAsc + " " + u.canDesc + " " + u.isAsc + " " + u.isDesc).css("width", ""), a.children().detach(), a.append(s), e.nTableWrapper.parentNode),
          r = e.nTableWrapper.nextSibling,
          u = c ? "remove" : "detach",
          a = (i[u](), l[u](), !c && o && (o.insertBefore(n, r), i.css("width", e.sDestroyWidth).removeClass(t.table)), $.settings.indexOf(e));
        -1 !== a && $.settings.splice(a, 1);
      });
    }), B.each(["column", "row", "cell"], function (e, s) {
      t(s + "s().every()", function (a) {
        var r,
          o = this.selector.opts,
          i = this,
          l = 0;
        return this.iterator("every", function (e, t, n) {
          r = i[s](t, o), "cell" === s ? a.call(r, r[0][0].row, r[0][0].column, n, l) : a.call(r, t, n, l), l++;
        });
      });
    }), t("i18n()", function (e, t, n) {
      var a = this.context[0],
        e = J(e)(a.oLanguage);
      return "string" == typeof (e = B.isPlainObject(e = void 0 === e ? t : e) ? void 0 !== n && void 0 !== e[n] ? e[n] : e._ : e) ? e.replace("%d", n) : e;
    }), $.version = "2.0.3", $.settings = [], $.models = {}, $.models.oSearch = {
      caseInsensitive: !0,
      search: "",
      regex: !1,
      smart: !0,
      "return": !1
    }, $.models.oRow = {
      nTr: null,
      anCells: null,
      _aData: [],
      _aSortData: null,
      _aFilterData: null,
      _sFilterRow: null,
      src: null,
      idx: -1,
      displayData: null
    }, $.models.oColumn = {
      idx: null,
      aDataSort: null,
      asSorting: null,
      bSearchable: null,
      bSortable: null,
      bVisible: null,
      _sManualType: null,
      _bAttrSrc: !1,
      fnCreatedCell: null,
      fnGetData: null,
      fnSetData: null,
      mData: null,
      mRender: null,
      sClass: null,
      sContentPadding: null,
      sDefaultContent: null,
      sName: null,
      sSortDataType: "std",
      sSortingClass: null,
      sTitle: null,
      sType: null,
      sWidth: null,
      sWidthOrig: null,
      maxLenString: null,
      searchFixed: null
    }, $.defaults = {
      aaData: null,
      aaSorting: [[0, "asc"]],
      aaSortingFixed: [],
      ajax: null,
      aLengthMenu: [10, 25, 50, 100],
      aoColumns: null,
      aoColumnDefs: null,
      aoSearchCols: [],
      bAutoWidth: !0,
      bDeferRender: !0,
      bDestroy: !1,
      bFilter: !0,
      bInfo: !0,
      bLengthChange: !0,
      bPaginate: !0,
      bProcessing: !1,
      bRetrieve: !1,
      bScrollCollapse: !1,
      bServerSide: !1,
      bSort: !0,
      bSortMulti: !0,
      bSortCellsTop: null,
      bSortClasses: !0,
      bStateSave: !1,
      fnCreatedRow: null,
      fnDrawCallback: null,
      fnFooterCallback: null,
      fnFormatNumber: function fnFormatNumber(e) {
        return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, this.oLanguage.sThousands);
      },
      fnHeaderCallback: null,
      fnInfoCallback: null,
      fnInitComplete: null,
      fnPreDrawCallback: null,
      fnRowCallback: null,
      fnStateLoadCallback: function fnStateLoadCallback(e) {
        try {
          return JSON.parse((-1 === e.iStateDuration ? sessionStorage : localStorage).getItem("DataTables_" + e.sInstance + "_" + location.pathname));
        } catch (e) {
          return {};
        }
      },
      fnStateLoadParams: null,
      fnStateLoaded: null,
      fnStateSaveCallback: function fnStateSaveCallback(e, t) {
        try {
          (-1 === e.iStateDuration ? sessionStorage : localStorage).setItem("DataTables_" + e.sInstance + "_" + location.pathname, JSON.stringify(t));
        } catch (e) {}
      },
      fnStateSaveParams: null,
      iStateDuration: 7200,
      iDisplayLength: 10,
      iDisplayStart: 0,
      iTabIndex: 0,
      oClasses: {},
      oLanguage: {
        oAria: {
          orderable: ": Activate to sort",
          orderableReverse: ": Activate to invert sorting",
          orderableRemove: ": Activate to remove sorting",
          paginate: {
            first: "First",
            last: "Last",
            next: "Next",
            previous: "Previous"
          }
        },
        oPaginate: {
          sFirst: "«",
          sLast: "»",
          sNext: "›",
          sPrevious: "‹"
        },
        entries: {
          _: "entries",
          1: "entry"
        },
        sEmptyTable: "No data available in table",
        sInfo: "Showing _START_ to _END_ of _TOTAL_ _ENTRIES-TOTAL_",
        sInfoEmpty: "Showing 0 to 0 of 0 _ENTRIES-TOTAL_",
        sInfoFiltered: "(filtered from _MAX_ total _ENTRIES-MAX_)",
        sInfoPostFix: "",
        sDecimal: "",
        sThousands: ",",
        sLengthMenu: "_MENU_ _ENTRIES_ per page",
        sLoadingRecords: "Loading...",
        sProcessing: "",
        sSearch: "Search:",
        sSearchPlaceholder: "",
        sUrl: "",
        sZeroRecords: "No matching records found"
      },
      oSearch: B.extend({}, $.models.oSearch),
      layout: {
        topStart: "pageLength",
        topEnd: "search",
        bottomStart: "info",
        bottomEnd: "paging"
      },
      sDom: null,
      searchDelay: null,
      sPaginationType: "full_numbers",
      sScrollX: "",
      sScrollXInner: "",
      sScrollY: "",
      sServerMethod: "GET",
      renderer: null,
      rowId: "DT_RowId",
      caption: null
    }, k($.defaults), $.defaults.column = {
      aDataSort: null,
      iDataSort: -1,
      ariaTitle: "",
      asSorting: ["asc", "desc", ""],
      bSearchable: !0,
      bSortable: !0,
      bVisible: !0,
      fnCreatedCell: null,
      mData: null,
      mRender: null,
      sCellType: "td",
      sClass: "",
      sContentPadding: "",
      sDefaultContent: null,
      sName: "",
      sSortDataType: "std",
      sTitle: null,
      sType: null,
      sWidth: null
    }, k($.defaults.column), $.models.oSettings = {
      oFeatures: {
        bAutoWidth: null,
        bDeferRender: null,
        bFilter: null,
        bInfo: !0,
        bLengthChange: !0,
        bPaginate: null,
        bProcessing: null,
        bServerSide: null,
        bSort: null,
        bSortMulti: null,
        bSortClasses: null,
        bStateSave: null
      },
      oScroll: {
        bCollapse: null,
        iBarWidth: 0,
        sX: null,
        sXInner: null,
        sY: null
      },
      oLanguage: {
        fnInfoCallback: null
      },
      oBrowser: {
        bScrollbarLeft: !1,
        barWidth: 0
      },
      ajax: null,
      aanFeatures: [],
      aoData: [],
      aiDisplay: [],
      aiDisplayMaster: [],
      aIds: {},
      aoColumns: [],
      aoHeader: [],
      aoFooter: [],
      oPreviousSearch: {},
      searchFixed: {},
      aoPreSearchCols: [],
      aaSorting: null,
      aaSortingFixed: [],
      sDestroyWidth: 0,
      aoRowCallback: [],
      aoHeaderCallback: [],
      aoFooterCallback: [],
      aoDrawCallback: [],
      aoRowCreatedCallback: [],
      aoPreDrawCallback: [],
      aoInitComplete: [],
      aoStateSaveParams: [],
      aoStateLoadParams: [],
      aoStateLoaded: [],
      sTableId: "",
      nTable: null,
      nTHead: null,
      nTFoot: null,
      nTBody: null,
      nTableWrapper: null,
      bInitialised: !1,
      aoOpenRows: [],
      sDom: null,
      searchDelay: null,
      sPaginationType: "two_button",
      pagingControls: 0,
      iStateDuration: 0,
      aoStateSave: [],
      aoStateLoad: [],
      oSavedState: null,
      oLoadedState: null,
      bAjaxDataGet: !0,
      jqXHR: null,
      json: void 0,
      oAjaxData: void 0,
      sServerMethod: null,
      fnFormatNumber: null,
      aLengthMenu: null,
      iDraw: 0,
      bDrawing: !1,
      iDrawError: -1,
      _iDisplayLength: 10,
      _iDisplayStart: 0,
      _iRecordsTotal: 0,
      _iRecordsDisplay: 0,
      oClasses: {},
      bFiltered: !1,
      bSorted: !1,
      bSortCellsTop: null,
      oInit: null,
      aoDestroyCallback: [],
      fnRecordsTotal: function fnRecordsTotal() {
        return "ssp" == te(this) ? +this._iRecordsTotal : this.aiDisplayMaster.length;
      },
      fnRecordsDisplay: function fnRecordsDisplay() {
        return "ssp" == te(this) ? +this._iRecordsDisplay : this.aiDisplay.length;
      },
      fnDisplayEnd: function fnDisplayEnd() {
        var e = this._iDisplayLength,
          t = this._iDisplayStart,
          n = t + e,
          a = this.aiDisplay.length,
          r = this.oFeatures,
          o = r.bPaginate;
        return r.bServerSide ? !1 === o || -1 === e ? t + a : Math.min(t + e, this._iRecordsDisplay) : !o || a < n || -1 === e ? a : n;
      },
      oInstance: null,
      sInstance: null,
      iTabIndex: 0,
      nScrollHead: null,
      nScrollFoot: null,
      aLastSort: [],
      oPlugins: {},
      rowIdFn: null,
      rowId: null,
      caption: "",
      captionNode: null,
      colgroup: null
    }, $.ext = C = {
      buttons: {},
      classes: {},
      builder: "ju/dt-2.0.3/b-3.0.1/b-colvis-3.0.1/r-3.0.1",
      errMode: "alert",
      feature: [],
      features: {},
      search: [],
      selector: {
        cell: [],
        column: [],
        row: []
      },
      legacy: {
        ajax: null
      },
      pager: {},
      renderer: {
        pageButton: {},
        header: {}
      },
      order: {},
      type: {
        className: {},
        detect: [],
        render: {},
        search: {},
        order: {}
      },
      _unique: 0,
      fnVersionCheck: $.fnVersionCheck,
      iApiIndex: 0,
      sVersion: $.version
    }, B.extend(C, {
      afnFiltering: C.search,
      aTypes: C.type.detect,
      ofnSearch: C.type.search,
      oSort: C.type.order,
      afnSortData: C.order,
      aoFeatures: C.feature,
      oStdClasses: C.classes,
      oPagination: C.pager
    }), B.extend($.ext.classes, {
      container: "dt-container",
      empty: {
        row: "dt-empty"
      },
      info: {
        container: "dt-info"
      },
      length: {
        container: "dt-length",
        select: "dt-input"
      },
      order: {
        canAsc: "dt-orderable-asc",
        canDesc: "dt-orderable-desc",
        isAsc: "dt-ordering-asc",
        isDesc: "dt-ordering-desc",
        none: "dt-orderable-none",
        position: "sorting_"
      },
      processing: {
        container: "dt-processing"
      },
      scrolling: {
        body: "dt-scroll-body",
        container: "dt-scroll",
        footer: {
          self: "dt-scroll-foot",
          inner: "dt-scroll-footInner"
        },
        header: {
          self: "dt-scroll-head",
          inner: "dt-scroll-headInner"
        }
      },
      search: {
        container: "dt-search",
        input: "dt-input"
      },
      table: "dataTable",
      tbody: {
        cell: "",
        row: ""
      },
      thead: {
        cell: "",
        row: ""
      },
      tfoot: {
        cell: "",
        row: ""
      },
      paging: {
        active: "current",
        button: "dt-paging-button",
        container: "dt-paging",
        disabled: "disabled"
      }
    }), $.ext.pager);
  B.extend(mt, {
    simple: function simple() {
      return ["previous", "next"];
    },
    full: function full() {
      return ["first", "previous", "next", "last"];
    },
    numbers: function numbers() {
      return ["numbers"];
    },
    simple_numbers: function simple_numbers() {
      return ["previous", "numbers", "next"];
    },
    full_numbers: function full_numbers() {
      return ["first", "previous", "numbers", "next", "last"];
    },
    first_last: function first_last() {
      return ["first", "last"];
    },
    first_last_numbers: function first_last_numbers() {
      return ["first", "numbers", "last"];
    },
    _numbers: Ft,
    numbers_length: 7
  }), B.extend(!0, $.ext.renderer, {
    pagingButton: {
      _: function _(e, t, n, a, r) {
        var e = e.oClasses.paging,
          o = [e.button];
        return a && o.push(e.active), r && o.push(e.disabled), {
          display: a = "ellipsis" === t ? B('<span class="ellipsis"></span>').html(n)[0] : B("<button>", {
            "class": o.join(" "),
            role: "link",
            type: "button"
          }).html(n),
          clicker: a
        };
      }
    },
    pagingContainer: {
      _: function _(e, t) {
        return t;
      }
    }
  });
  function bt(e) {
    return e.replace(/[\W]/g, "_");
  }
  function yt(e, t, n, a, r) {
    return q.moment ? e[t](r) : q.luxon ? e[n](r) : a ? e[a](r) : e;
  }
  var Dt = !1;
  function xt(e, t, n) {
    var a;
    if (q.moment) {
      if (!(a = q.moment.utc(e, t, n, !0)).isValid()) return null;
    } else if (q.luxon) {
      if (!(a = t && "string" == typeof e ? q.luxon.DateTime.fromFormat(e, t) : q.luxon.DateTime.fromISO(e)).isValid) return null;
      a.setLocale(n);
    } else t ? (Dt || alert("DataTables warning: Formatted date without Moment.js or Luxon - https://datatables.net/tn/17"), Dt = !0) : a = new Date(e);
    return a;
  }
  function St(s) {
    return function (a, r, o, i) {
      0 === arguments.length ? (o = "en", a = r = null) : 1 === arguments.length ? (o = "en", r = a, a = null) : 2 === arguments.length && (o = r, r = a, a = null);
      var l = "datetime" + (r ? "-" + bt(r) : "");
      return $.ext.type.order[l] || $.type(l, {
        detect: function detect(e) {
          return e === l && l;
        },
        order: {
          pre: function pre(e) {
            return e.valueOf();
          }
        },
        className: "dt-right"
      }), function (e, t) {
        var n;
        return null == e && (e = "--now" === i ? (n = new Date(), new Date(Date.UTC(n.getFullYear(), n.getMonth(), n.getDate(), n.getHours(), n.getMinutes(), n.getSeconds()))) : ""), "type" === t ? l : "" === e ? "sort" !== t ? "" : xt("0000-01-01 00:00:00", null, o) : !(null === r || a !== r || "sort" === t || "type" === t || e instanceof Date) || null === (n = xt(e, a, o)) ? e : "sort" === t ? n : (e = null === r ? yt(n, "toDate", "toJSDate", "")[s]() : yt(n, "format", "toFormat", "toISOString", r), "display" === t ? u(e) : e);
      };
    };
  }
  var Tt = ",",
    wt = ".";
  if (void 0 !== q.Intl) try {
    for (var _t = new Intl.NumberFormat().formatToParts(100000.1), a = 0; a < _t.length; a++) "group" === _t[a].type ? Tt = _t[a].value : "decimal" === _t[a].type && (wt = _t[a].value);
  } catch (e) {}
  $.datetime = function (n, a) {
    var r = "datetime-detect-" + bt(n);
    a = a || "en", $.ext.type.order[r] || $.type(r, {
      detect: function detect(e) {
        var t = xt(e, n, a);
        return !("" !== e && !t) && r;
      },
      order: {
        pre: function pre(e) {
          return xt(e, n, a) || 0;
        }
      },
      className: "dt-right"
    });
  }, $.render = {
    date: St("toLocaleDateString"),
    datetime: St("toLocaleString"),
    time: St("toLocaleTimeString"),
    number: function number(r, o, i, l, s) {
      return null == r && (r = Tt), null == o && (o = wt), {
        display: function display(e) {
          if ("number" != typeof e && "string" != typeof e) return e;
          if ("" === e || null === e) return e;
          var t = e < 0 ? "-" : "",
            n = parseFloat(e),
            a = Math.abs(n);
          if (1e11 <= a || a < 1e-4 && 0 !== a) return (a = n.toExponential(i).split(/e\+?/))[0] + " x 10<sup>" + a[1] + "</sup>";
          if (isNaN(n)) return u(e);
          n = n.toFixed(i), e = Math.abs(n);
          a = parseInt(e, 10), n = i ? o + (e - a).toFixed(i).substring(2) : "";
          return (t = 0 === a && 0 === parseFloat(n) ? "" : t) + (l || "") + a.toString().replace(/\B(?=(\d{3})+(?!\d))/g, r) + n + (s || "");
        }
      };
    },
    text: function text() {
      return {
        display: u,
        filter: u
      };
    }
  };
  var i = $.ext.type,
    Ct = ($.type = function (a, e, t) {
      if (!e) return {
        className: i.className[a],
        detect: i.detect.find(function (e) {
          return e.name === a;
        }),
        order: {
          pre: i.order[a + "-pre"],
          asc: i.order[a + "-asc"],
          desc: i.order[a + "-desc"]
        },
        render: i.render[a],
        search: i.search[a]
      };
      function n(e, t) {
        i[e][a] = t;
      }
      function r(n) {
        function e(e, t) {
          return !0 === (e = n(e, t)) ? a : e;
        }
        Object.defineProperty(e, "name", {
          value: a
        });
        var t = i.detect.findIndex(function (e) {
          return e.name === a;
        });
        -1 === t ? i.detect.unshift(e) : i.detect.splice(t, 1, e);
      }
      function o(e) {
        i.order[a + "-pre"] = e.pre, i.order[a + "-asc"] = e.asc, i.order[a + "-desc"] = e.desc;
      }
      void 0 === t && (t = e, e = null), "className" === e ? n("className", t) : "detect" === e ? r(t) : "order" === e ? o(t) : "render" === e ? n("render", t) : "search" === e ? n("search", t) : e || (t.className && n("className", t.className), void 0 !== t.detect && r(t.detect), t.order && o(t.order), void 0 !== t.render && n("render", t.render), void 0 !== t.search && n("search", t.search));
    }, $.types = function () {
      return i.detect.map(function (e) {
        return e.name;
      });
    }, $.type("string", {
      detect: function detect() {
        return "string";
      },
      order: {
        pre: function pre(e) {
          return y(e) ? "" : "string" == typeof e ? e.toLowerCase() : e.toString ? e.toString() : "";
        }
      },
      search: ct(!1, !0)
    }), $.type("html", {
      detect: function detect(e) {
        return y(e) || "string" == typeof e && -1 !== e.indexOf("<") ? "html" : null;
      },
      order: {
        pre: function pre(e) {
          return y(e) ? "" : e.replace ? I(e).trim().toLowerCase() : e + "";
        }
      },
      search: ct(!0, !0)
    }), $.type("date", {
      className: "dt-type-date",
      detect: function detect(e) {
        var t;
        return (!e || e instanceof Date || L.test(e)) && (null !== (t = Date.parse(e)) && !isNaN(t) || y(e)) ? "date" : null;
      },
      order: {
        pre: function pre(e) {
          e = Date.parse(e);
          return isNaN(e) ? -1 / 0 : e;
        }
      }
    }), $.type("html-num-fmt", {
      className: "dt-type-numeric",
      detect: function detect(e, t) {
        t = t.oLanguage.sDecimal;
        return l(e, t, !0) ? "html-num-fmt" : null;
      },
      order: {
        pre: function pre(e, t) {
          t = t.oLanguage.sDecimal;
          return Ct(e, t, F, j);
        }
      },
      search: ct(!0, !0)
    }), $.type("html-num", {
      className: "dt-type-numeric",
      detect: function detect(e, t) {
        t = t.oLanguage.sDecimal;
        return l(e, t) ? "html-num" : null;
      },
      order: {
        pre: function pre(e, t) {
          t = t.oLanguage.sDecimal;
          return Ct(e, t, F);
        }
      },
      search: ct(!0, !0)
    }), $.type("num-fmt", {
      className: "dt-type-numeric",
      detect: function detect(e, t) {
        t = t.oLanguage.sDecimal;
        return o(e, t, !0) ? "num-fmt" : null;
      },
      order: {
        pre: function pre(e, t) {
          t = t.oLanguage.sDecimal;
          return Ct(e, t, j);
        }
      }
    }), $.type("num", {
      className: "dt-type-numeric",
      detect: function detect(e, t) {
        t = t.oLanguage.sDecimal;
        return o(e, t) ? "num" : null;
      },
      order: {
        pre: function pre(e, t) {
          t = t.oLanguage.sDecimal;
          return Ct(e, t);
        }
      }
    }), function (e, t, n, a) {
      var r;
      return 0 === e || e && "-" !== e ? "number" == (r = _typeof(e)) || "bigint" == r ? e : +(e = (e = t ? P(e, t) : e).replace && (n && (e = e.replace(n, "")), a) ? e.replace(a, "") : e) : -1 / 0;
    });
  B.extend(!0, $.ext.renderer, {
    footer: {
      _: function _(e, t, n) {
        t.addClass(n.tfoot.cell);
      }
    },
    header: {
      _: function _(d, f, h) {
        f.addClass(h.thead.cell), d.oFeatures.bSort || f.addClass(h.order.none);
        var e = d.bSortCellsTop,
          t = f.closest("thead").find("tr"),
          n = f.parent().index();
        "disable" === f.attr("data-dt-order") || "disable" === f.parent().attr("data-dt-order") || !0 === e && 0 !== n || !1 === e && n !== t.length - 1 || B(d.nTable).on("order.dt.DT", function (e, t, n) {
          var a, r, o, i, l, s, u, c;
          d === t && (a = h.order, c = t.api.columns(f), r = d.aoColumns[c.flatten()[0]], o = c.orderable().includes(!0), i = "", u = c.indexes(), l = c.orderable(!0).flatten(), s = "," + n.map(function (e) {
            return e.col;
          }).join(",") + ",", f.removeClass(a.isAsc + " " + a.isDesc).toggleClass(a.none, !o).toggleClass(a.canAsc, o && l.includes("asc")).toggleClass(a.canDesc, o && l.includes("desc")), -1 !== (l = s.indexOf("," + u.toArray().join(",") + ",")) && (s = c.order(), f.addClass(s.includes("asc") ? a.isAsc : "" + s.includes("desc") ? a.isDesc : "")), 0 === l ? (u = n[0], c = r.asSorting, f.attr("aria-sort", "asc" === u.dir ? "ascending" : "descending"), i = c[u.index + 1] ? "Reverse" : "Remove") : f.removeAttr("aria-sort"), f.attr("aria-label", o ? r.ariaTitle + t.api.i18n("oAria.orderable" + i) : r.ariaTitle), o) && (f.find(".dt-column-title").attr("role", "button"), f.attr("tabindex", 0));
        });
      }
    },
    layout: {
      _: function _(e, t, n) {
        var a = B("<div/>").addClass("dt-layout-row").appendTo(t);
        B.each(n, function (e, t) {
          e = t.table ? "" : "dt-" + e + " ";
          t.table && a.addClass("dt-layout-table"), B("<div/>").attr({
            id: t.id || null,
            "class": "dt-layout-cell " + e + (t.className || "")
          }).append(t.contents).appendTo(a);
        });
      }
    }
  }), $.feature = {}, $.feature.register = function (e, t, n) {
    $.ext.features[e] = t, n && C.feature.push({
      cFeature: n,
      fnInit: t
    });
  }, $.feature.register("info", function (e, s) {
    var t, n, u;
    return e.oFeatures.bInfo ? (t = e.oLanguage, n = e.sTableId, u = B("<div/>", {
      "class": e.oClasses.info.container
    }), s = B.extend({
      callback: t.fnInfoCallback,
      empty: t.sInfoEmpty,
      postfix: t.sInfoPostFix,
      search: t.sInfoFiltered,
      text: t.sInfo
    }, s), e.aoDrawCallback.push(function (e) {
      var t = s,
        n = u,
        a = e._iDisplayStart + 1,
        r = e.fnDisplayEnd(),
        o = e.fnRecordsTotal(),
        i = e.fnRecordsDisplay(),
        l = i ? t.text : t.empty;
      i !== o && (l += " " + t.search), l += t.postfix, l = et(e, l), t.callback && (l = t.callback.call(e.oInstance, e, a, r, o, i, l)), n.html(l), ee(e, null, "info", [e, n[0], l]);
    }), B("#" + n + "_info", e.nWrapper).length || (u.attr({
      "aria-live": "polite",
      id: n + "_info",
      role: "status"
    }), B(e.nTable).attr("aria-describedby", n + "_info")), u) : null;
  }, "i");
  var It = 0;
  function At(e, t, n, a) {
    var r = e.oLanguage.oPaginate,
      o = {
        display: "",
        active: !1,
        disabled: !1
      };
    switch (t) {
      case "ellipsis":
        o.display = "&#x2026;", o.disabled = !0;
        break;
      case "first":
        o.display = r.sFirst, 0 === n && (o.disabled = !0);
        break;
      case "previous":
        o.display = r.sPrevious, 0 === n && (o.disabled = !0);
        break;
      case "next":
        o.display = r.sNext, 0 !== a && n !== a - 1 || (o.disabled = !0);
        break;
      case "last":
        o.display = r.sLast, 0 !== a && n !== a - 1 || (o.disabled = !0);
        break;
      default:
        "number" == typeof t && (o.display = e.fnFormatNumber(t + 1), n === t) && (o.active = !0);
    }
    return o;
  }
  function Ft(e, t, n) {
    var a = [],
      r = Math.floor(n / 2);
    return t <= n ? a = h(0, t) : 1 === n ? a = [e] : 3 === n ? e <= 1 ? a = [0, 1, "ellipsis"] : t - 2 <= e ? (a = h(t - 2, t)).unshift("ellipsis") : a = ["ellipsis", e, "ellipsis"] : e <= r ? (a = h(0, n - 2)).push("ellipsis", t - 1) : (t - 1 - r <= e ? a = h(t - (n - 2), t) : ((a = h(e - r + 2, e + r - 1)).push("ellipsis", t - 1), a)).unshift(0, "ellipsis"), a;
  }
  $.feature.register("search", function (n, e) {
    var t, a, r, o, i, l, s, u, c, d;
    return n.oFeatures.bFilter ? (t = n.oClasses.search, a = n.sTableId, c = n.oLanguage, r = n.oPreviousSearch, o = '<input type="search" class="' + t.input + '"/>', -1 === (e = B.extend({
      placeholder: c.sSearchPlaceholder,
      text: c.sSearch
    }, e)).text.indexOf("_INPUT_") && (e.text += "_INPUT_"), e.text = et(n, e.text), c = e.text.match(/_INPUT_$/), s = e.text.match(/^_INPUT_/), i = e.text.replace(/_INPUT_/, ""), l = "<label>" + e.text + "</label>", s ? l = "_INPUT_<label>" + i + "</label>" : c && (l = "<label>" + i + "</label>_INPUT_"), (s = B("<div>").addClass(t.container).append(l.replace(/_INPUT_/, o))).find("label").attr("for", "dt-search-" + It), s.find("input").attr("id", "dt-search-" + It), It++, u = function u(e) {
      var t = this.value;
      r["return"] && "Enter" !== e.key || t != r.search && (r.search = t, Le(n, r), n._iDisplayStart = 0, S(n));
    }, c = null !== n.searchDelay ? n.searchDelay : 0, d = B("input", s).val(r.search).attr("placeholder", e.placeholder).on("keyup.DT search.DT input.DT paste.DT cut.DT", c ? $.util.debounce(u, c) : u).on("mouseup.DT", function (e) {
      setTimeout(function () {
        u.call(d[0], e);
      }, 10);
    }).on("keypress.DT", function (e) {
      if (13 == e.keyCode) return !1;
    }).attr("aria-controls", a), B(n.nTable).on("search.dt.DT", function (e, t) {
      n === t && d[0] !== _.activeElement && d.val("function" != typeof r.search ? r.search : "");
    }), s) : null;
  }, "f"), $.feature.register("paging", function (e, t) {
    if (!e.oFeatures.bPaginate) return null;
    t = B.extend({
      numbers: $.ext.pager.numbers_length,
      type: e.sPaginationType
    }, t);
    function n() {
      !function e(t, n, a) {
        if (!t._bInitComplete) return;
        var r = $.ext.pager[a.type],
          o = t.oLanguage.oAria.paginate || {},
          i = t._iDisplayStart,
          l = t._iDisplayLength,
          s = t.fnRecordsDisplay(),
          u = -1 === l,
          c = u ? 0 : Math.ceil(i / l),
          d = u ? 1 : Math.ceil(s / l),
          f = r().map(function (e) {
            return "numbers" === e ? Ft(c, d, a.numbers) : e;
          }).flat();
        var h = [];
        for (var p = 0; p < f.length; p++) {
          var g = f[p],
            m = At(t, g, c, d),
            v = Ke(t, "pagingButton")(t, g, m.display, m.active, m.disabled);
          B(v.clicker).attr({
            "aria-controls": t.sTableId,
            "aria-disabled": m.disabled ? "true" : null,
            "aria-current": m.active ? "page" : null,
            "aria-label": o[g],
            "data-dt-idx": g,
            tabIndex: m.disabled ? -1 : t.iTabIndex
          }), "number" != typeof g && B(v.clicker).addClass(g), Ze(v.clicker, {
            action: g
          }, function (e) {
            e.preventDefault(), Me(t, e.data.action, !0);
          }), h.push(v.display);
        }
        i = Ke(t, "pagingContainer")(t, h);
        u = n.find(_.activeElement).data("dt-idx");
        n.empty().append(i);
        void 0 !== u && n.find("[data-dt-idx=" + u + "]").trigger("focus");
        h.length && 1 < a.numbers && B(n).height() >= 2 * B(h[0]).outerHeight() - 10 && e(t, n, B.extend({}, a, {
          numbers: a.numbers - 2
        }));
      }(e, a, t);
    }
    var a = B("<div/>").addClass(e.oClasses.paging.container + " paging_" + t.type);
    return e.aoDrawCallback.push(n), B(e.nTable).on("column-sizing.dt.DT", n), a;
  }, "p");
  var Lt = 0;
  return $.feature.register("pageLength", function (a, e) {
    var t = a.oFeatures;
    if (!t.bPaginate || !t.bLengthChange) return null;
    e = B.extend({
      menu: a.aLengthMenu,
      text: a.oLanguage.sLengthMenu
    }, e);
    var t = a.oClasses.length,
      n = a.sTableId,
      r = e.menu,
      o = [],
      i = [];
    if (Array.isArray(r[0])) o = r[0], i = r[1];else for (p = 0; p < r.length; p++) B.isPlainObject(r[p]) ? (o.push(r[p].value), i.push(r[p].label)) : (o.push(r[p]), i.push(r[p]));
    for (var l = e.text.match(/_MENU_$/), s = e.text.match(/^_MENU_/), u = e.text.replace(/_MENU_/, ""), e = "<label>" + e.text + "</label>", c = (s ? e = "_MENU_<label>" + u + "</label>" : l && (e = "<label>" + u + "</label>_MENU_"), B("<div/>").addClass(t.container).append(e.replace("_MENU_", "<span></span>"))), d = [], f = (c.find("label")[0].childNodes.forEach(function (e) {
        e.nodeType === Node.TEXT_NODE && d.push({
          el: e,
          text: e.textContent
        });
      }), function (t) {
        d.forEach(function (e) {
          e.el.textContent = et(a, e.text, t);
        });
      }), h = B("<select/>", {
        name: n + "_length",
        "aria-controls": n,
        "class": t.select
      }), p = 0; p < o.length; p++) h[0][p] = new Option("number" == typeof i[p] ? a.fnFormatNumber(i[p]) : i[p], o[p]);
    return c.find("label").attr("for", "dt-length-" + Lt), h.attr("id", "dt-length-" + Lt), Lt++, c.find("span").replaceWith(h), B("select", c).val(a._iDisplayLength).on("change.DT", function () {
      Ee(a, B(this).val()), S(a);
    }), B(a.nTable).on("length.dt.DT", function (e, t, n) {
      a === t && (B("select", c).val(n), f(n));
    }), f(a._iDisplayLength), c;
  }, "l"), ((B.fn.dataTable = $).$ = B).fn.dataTableSettings = $.settings, B.fn.dataTableExt = $.ext, B.fn.DataTable = function (e) {
    return B(this).dataTable(e).api();
  }, B.each($, function (e, t) {
    B.fn.DataTable[e] = t;
  }), $;
});

/*! DataTables jQuery UI integration
 * ©2011-2014 SpryMedia Ltd - datatables.net/license
 */
!function (n) {
  var a, d;
  "function" == typeof define && define.amd ? define(["jquery", "datatables.net"], function (t) {
    return n(t, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (a = require("jquery"), d = function d(t, e) {
    e.fn.dataTable || require("datatables.net")(t, e);
  }, "undefined" == typeof window ? module.exports = function (t, e) {
    return t = t || window, e = e || a(t), d(t, e), n(e, 0, t.document);
  } : (d(window, a), module.exports = n(a, window, window.document))) : n(jQuery, window, document);
}(function (u, t, e) {
  "use strict";

  var n = u.fn.dataTable;
  return u.extend(!0, n.ext.classes, {
    container: "dt-container dt-jqueryui",
    paging: {
      active: "ui-state-disabled",
      button: "fg-button ui-button ui-state-default",
      container: "dt-paging fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi",
      disabled: "ui-state-disabled"
    },
    thead: {
      cell: "ui-state-default"
    },
    tfoot: {
      cell: "ui-state-default"
    }
  }), n.ext.renderer.layout.jqueryui = function (t, e, n) {
    var a = !1,
      d = u("<div/>", {
        "class": "dt-layout-row ui-helper-clearfix"
      }).appendTo(e);
    u.each(n, function (t, e) {
      t = u("<div/>", {
        id: e.id || null,
        "class": "dt-layout-cell dt-" + t + " " + (e.className || "")
      }).append(e.contents).appendTo(d);
      u(e.contents).hasClass("dataTable") && (a = !0, t.addClass("table"));
    }), a || d.addClass("fg-toolbar ui-toolbar ui-widget-header");
  }, n;
});

/*! Buttons for DataTables 3.0.1
 * © SpryMedia Ltd - datatables.net/license
 */
!function (e) {
  var o, i;
  "function" == typeof define && define.amd ? define(["jquery", "datatables.net"], function (t) {
    return e(t, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (o = require("jquery"), i = function i(t, n) {
    n.fn.dataTable || require("datatables.net")(t, n);
  }, "undefined" == typeof window ? module.exports = function (t, n) {
    return t = t || window, n = n || o(t), i(t, n), e(n, t, t.document);
  } : (i(window, o), module.exports = e(o, window, window.document))) : e(jQuery, window, document);
}(function (x, g, m) {
  "use strict";

  var e = x.fn.dataTable,
    o = 0,
    C = 0,
    w = e.ext.buttons,
    i = null;
  function v(t, n, e) {
    x.fn.animate ? t.stop().fadeIn(n, e) : (t.css("display", "block"), e && e.call(t));
  }
  function y(t, n, e) {
    x.fn.animate ? t.stop().fadeOut(n, e) : (t.css("display", "none"), e && e.call(t));
  }
  function _(n, t) {
    if (!e.versionCheck("2")) throw "Warning: Buttons requires DataTables 2 or newer";
    if (!(this instanceof _)) return function (t) {
      return new _(t, n).container();
    };
    !0 === (t = void 0 === t ? {} : t) && (t = {}), Array.isArray(t) && (t = {
      buttons: t
    }), this.c = x.extend(!0, {}, _.defaults, t), t.buttons && (this.c.buttons = t.buttons), this.s = {
      dt: new e.Api(n),
      buttons: [],
      listenKeys: "",
      namespace: "dtb" + o++
    }, this.dom = {
      container: x("<" + this.c.dom.container.tag + "/>").addClass(this.c.dom.container.className)
    }, this._constructor();
  }
  x.extend(_.prototype, {
    action: function action(t, n) {
      t = this._nodeToButton(t);
      return void 0 === n ? t.conf.action : (t.conf.action = n, this);
    },
    active: function active(t, n) {
      var t = this._nodeToButton(t),
        e = this.c.dom.button.active,
        o = x(t.node);
      return t.inCollection && this.c.dom.collection.button && void 0 !== this.c.dom.collection.button.active && (e = this.c.dom.collection.button.active), void 0 === n ? o.hasClass(e) : (o.toggleClass(e, void 0 === n || n), this);
    },
    add: function add(t, n, e) {
      var o = this.s.buttons;
      if ("string" == typeof n) {
        for (var i = n.split("-"), s = this.s, r = 0, a = i.length - 1; r < a; r++) s = s.buttons[+i[r]];
        o = s.buttons, n = +i[i.length - 1];
      }
      return this._expandButton(o, t, void 0 !== t ? t.split : void 0, (void 0 === t || void 0 === t.split || 0 === t.split.length) && void 0 !== s, !1, n), void 0 !== e && !0 !== e || this._draw(), this;
    },
    collectionRebuild: function collectionRebuild(t, n) {
      var e = this._nodeToButton(t);
      if (void 0 !== n) {
        for (var o = e.buttons.length - 1; 0 <= o; o--) this.remove(e.buttons[o].node);
        for (e.conf.prefixButtons && n.unshift.apply(n, e.conf.prefixButtons), e.conf.postfixButtons && n.push.apply(n, e.conf.postfixButtons), o = 0; o < n.length; o++) {
          var i = n[o];
          this._expandButton(e.buttons, i, void 0 !== i && void 0 !== i.config && void 0 !== i.config.split, !0, void 0 !== i.parentConf && void 0 !== i.parentConf.split, null, i.parentConf);
        }
      }
      this._draw(e.collection, e.buttons);
    },
    container: function container() {
      return this.dom.container;
    },
    disable: function disable(t) {
      t = this._nodeToButton(t);
      return x(t.node).addClass(this.c.dom.button.disabled).prop("disabled", !0), this;
    },
    destroy: function destroy() {
      x("body").off("keyup." + this.s.namespace);
      for (var t = this.s.buttons.slice(), n = 0, e = t.length; n < e; n++) this.remove(t[n].node);
      this.dom.container.remove();
      var o = this.s.dt.settings()[0];
      for (n = 0, e = o.length; n < e; n++) if (o.inst === this) {
        o.splice(n, 1);
        break;
      }
      return this;
    },
    enable: function enable(t, n) {
      return !1 === n ? this.disable(t) : (n = this._nodeToButton(t), x(n.node).removeClass(this.c.dom.button.disabled).prop("disabled", !1), this);
    },
    index: function index(t, n, e) {
      n || (n = "", e = this.s.buttons);
      for (var o = 0, i = e.length; o < i; o++) {
        var s = e[o].buttons;
        if (e[o].node === t) return n + o;
        if (s && s.length) {
          s = this.index(t, o + "-", s);
          if (null !== s) return s;
        }
      }
      return null;
    },
    name: function name() {
      return this.c.name;
    },
    node: function node(t) {
      return t ? (t = this._nodeToButton(t), x(t.node)) : this.dom.container;
    },
    processing: function processing(t, n) {
      var e = this.s.dt,
        o = this._nodeToButton(t);
      return void 0 === n ? x(o.node).hasClass("processing") : (x(o.node).toggleClass("processing", n), x(e.table().node()).triggerHandler("buttons-processing.dt", [n, e.button(t), e, x(t), o.conf]), this);
    },
    remove: function remove(t) {
      var n = this._nodeToButton(t),
        e = this._nodeToHost(t),
        o = this.s.dt;
      if (n.buttons.length) for (var i = n.buttons.length - 1; 0 <= i; i--) this.remove(n.buttons[i].node);
      n.conf.destroying = !0, n.conf.destroy && n.conf.destroy.call(o.button(t), o, x(t), n.conf), this._removeKey(n.conf), x(n.node).remove();
      o = x.inArray(n, e);
      return e.splice(o, 1), this;
    },
    text: function text(t, n) {
      function e(t) {
        return "function" == typeof t ? t(i, s, o.conf) : t;
      }
      var o = this._nodeToButton(t),
        t = o.textNode,
        i = this.s.dt,
        s = x(o.node);
      return void 0 === n ? e(o.conf.text) : (o.conf.text = n, t.html(e(n)), this);
    },
    _constructor: function _constructor() {
      var e = this,
        t = this.s.dt,
        o = t.settings()[0],
        n = this.c.buttons;
      o._buttons || (o._buttons = []), o._buttons.push({
        inst: this,
        name: this.c.name
      });
      for (var i = 0, s = n.length; i < s; i++) this.add(n[i]);
      t.on("destroy", function (t, n) {
        n === o && e.destroy();
      }), x("body").on("keyup." + this.s.namespace, function (t) {
        var n;
        m.activeElement && m.activeElement !== m.body || (n = String.fromCharCode(t.keyCode).toLowerCase(), -1 !== e.s.listenKeys.toLowerCase().indexOf(n) && e._keypress(n, t));
      });
    },
    _addKey: function _addKey(t) {
      t.key && (this.s.listenKeys += (x.isPlainObject(t.key) ? t.key : t).key);
    },
    _draw: function _draw(t, n) {
      t || (t = this.dom.container, n = this.s.buttons), t.children().detach();
      for (var e = 0, o = n.length; e < o; e++) t.append(n[e].inserter), t.append(" "), n[e].buttons && n[e].buttons.length && this._draw(n[e].collection, n[e].buttons);
    },
    _expandButton: function _expandButton(t, n, e, o, i, s, r) {
      for (var a, l = this.s.dt, c = this.c.dom.collection, u = Array.isArray(n) ? n : [n], d = 0, f = (u = void 0 === n ? Array.isArray(e) ? e : [e] : u).length; d < f; d++) {
        var p = this._resolveExtends(u[d]);
        if (p) if (a = !(!p.config || !p.config.split), Array.isArray(p)) this._expandButton(t, p, void 0 !== h && void 0 !== h.conf ? h.conf.split : void 0, o, void 0 !== r && void 0 !== r.split, s, r);else {
          var h = this._buildButton(p, o, void 0 !== p.split || void 0 !== p.config && void 0 !== p.config.split, i);
          if (h) {
            if (null != s ? (t.splice(s, 0, h), s++) : t.push(h), h.conf.buttons && (h.collection = x("<" + c.container.content.tag + "/>"), h.conf._collection = h.collection, x(h.node).append(c.action.dropHtml), this._expandButton(h.buttons, h.conf.buttons, h.conf.split, !a, a, s, h.conf)), h.conf.split) {
              h.collection = x("<" + c.container.tag + "/>"), h.conf._collection = h.collection;
              for (var b = 0; b < h.conf.split.length; b++) {
                var g = h.conf.split[b];
                "object" == _typeof(g) && (g.parent = r, void 0 === g.collectionLayout && (g.collectionLayout = h.conf.collectionLayout), void 0 === g.dropup && (g.dropup = h.conf.dropup), void 0 === g.fade) && (g.fade = h.conf.fade);
              }
              this._expandButton(h.buttons, h.conf.buttons, h.conf.split, !a, a, s, h.conf);
            }
            h.conf.parent = r, p.init && p.init.call(l.button(h.node), l, x(h.node), p);
          }
        }
      }
    },
    _buildButton: function _buildButton(n, t, e, o) {
      function i(t) {
        return "function" == typeof t ? t(f, c, n) : t;
      }
      var s,
        r,
        a,
        l,
        c,
        u = this,
        d = this.c.dom,
        f = this.s.dt,
        p = x.extend(!0, {}, d.button);
      if (t && e && d.collection.split ? x.extend(!0, p, d.collection.split.action) : o || t ? x.extend(!0, p, d.collection.button) : e && x.extend(!0, p, d.split.button), n.spacer) return d = x("<" + p.spacer.tag + "/>").addClass("dt-button-spacer " + n.style + " " + p.spacer.className).html(i(n.text)), {
        conf: n,
        node: d,
        inserter: d,
        buttons: [],
        inCollection: t,
        isSplit: e,
        collection: null,
        textNode: d
      };
      if (n.available && !n.available(f, n) && !n.html) return !1;
      n.html ? c = x(n.html) : (r = function r(t, n, e, o, i) {
        o.action.call(n.button(e), t, n, e, o, i), x(n.table().node()).triggerHandler("buttons-action.dt", [n.button(e), n, e, o]);
      }, a = function a(t, n, e, o) {
        o.async ? (u.processing(e[0], !0), setTimeout(function () {
          r(t, n, e, o, function () {
            u.processing(e[0], !1);
          });
        }, o.async)) : r(t, n, e, o, function () {});
      }, d = n.tag || p.tag, l = void 0 === n.clickBlurs || n.clickBlurs, c = x("<" + d + "/>").addClass(p.className).attr("tabindex", this.s.dt.settings()[0].iTabIndex).attr("aria-controls", this.s.dt.table().node().id).on("click.dtb", function (t) {
        t.preventDefault(), !c.hasClass(p.disabled) && n.action && a(t, f, c, n), l && c.trigger("blur");
      }).on("keypress.dtb", function (t) {
        13 === t.keyCode && (t.preventDefault(), !c.hasClass(p.disabled)) && n.action && a(t, f, c, n);
      }), "a" === d.toLowerCase() && c.attr("href", "#"), "button" === d.toLowerCase() && c.attr("type", "button"), s = p.liner.tag ? (d = x("<" + p.liner.tag + "/>").html(i(n.text)).addClass(p.liner.className), "a" === p.liner.tag.toLowerCase() && d.attr("href", "#"), c.append(d), d) : (c.html(i(n.text)), c), !1 === n.enabled && c.addClass(p.disabled), n.className && c.addClass(n.className), n.titleAttr && c.attr("title", i(n.titleAttr)), n.attr && c.attr(n.attr), n.namespace || (n.namespace = ".dt-button-" + C++), void 0 !== n.config && n.config.split && (n.split = n.config.split));
      var h,
        b,
        g,
        m,
        v,
        y,
        d = this.c.dom.buttonContainer,
        d = d && d.tag ? x("<" + d.tag + "/>").addClass(d.className).append(c) : c;
      return this._addKey(n), this.c.buttonCreated && (d = this.c.buttonCreated(n, d)), e && (b = (h = t ? x.extend(!0, this.c.dom.split, this.c.dom.collection.split) : this.c.dom.split).wrapper, g = x("<" + b.tag + "/>").addClass(b.className).append(c), m = x.extend(n, {
        align: h.dropdown.align,
        attr: {
          "aria-haspopup": "dialog",
          "aria-expanded": !1
        },
        className: h.dropdown.className,
        closeButton: !1,
        splitAlignClass: h.dropdown.splitAlignClass,
        text: h.dropdown.text
      }), this._addKey(m), v = function v(t, n, e, o) {
        w.split.action.call(n.button(g), t, n, e, o), x(n.table().node()).triggerHandler("buttons-action.dt", [n.button(e), n, e, o]), e.attr("aria-expanded", !0);
      }, y = x('<button class="' + h.dropdown.className + ' dt-button"></button>').html(h.dropdown.dropHtml).on("click.dtb", function (t) {
        t.preventDefault(), t.stopPropagation(), y.hasClass(p.disabled) || v(t, f, y, m), l && y.trigger("blur");
      }).on("keypress.dtb", function (t) {
        13 === t.keyCode && (t.preventDefault(), y.hasClass(p.disabled) || v(t, f, y, m));
      }), 0 === n.split.length && y.addClass("dtb-hide-drop"), g.append(y).attr(m.attr)), {
        conf: n,
        node: (e ? g : c).get(0),
        inserter: e ? g : d,
        buttons: [],
        inCollection: t,
        isSplit: e,
        inSplit: o,
        collection: null,
        textNode: s
      };
    },
    _nodeToButton: function _nodeToButton(t, n) {
      for (var e = 0, o = (n = n || this.s.buttons).length; e < o; e++) {
        if (n[e].node === t) return n[e];
        if (n[e].buttons.length) {
          var i = this._nodeToButton(t, n[e].buttons);
          if (i) return i;
        }
      }
    },
    _nodeToHost: function _nodeToHost(t, n) {
      for (var e = 0, o = (n = n || this.s.buttons).length; e < o; e++) {
        if (n[e].node === t) return n;
        if (n[e].buttons.length) {
          var i = this._nodeToHost(t, n[e].buttons);
          if (i) return i;
        }
      }
    },
    _keypress: function _keypress(s, r) {
      var _a;
      r._buttonsHandled || (_a = function a(t) {
        for (var n, e, o = 0, i = t.length; o < i; o++) n = t[o].conf, e = t[o].node, !n.key || n.key !== s && (!x.isPlainObject(n.key) || n.key.key !== s || n.key.shiftKey && !r.shiftKey || n.key.altKey && !r.altKey || n.key.ctrlKey && !r.ctrlKey || n.key.metaKey && !r.metaKey) || (r._buttonsHandled = !0, x(e).click()), t[o].buttons.length && _a(t[o].buttons);
      })(this.s.buttons);
    },
    _removeKey: function _removeKey(t) {
      var n;
      t.key && (t = (x.isPlainObject(t.key) ? t.key : t).key, n = this.s.listenKeys.split(""), t = x.inArray(t, n), n.splice(t, 1), this.s.listenKeys = n.join(""));
    },
    _resolveExtends: function _resolveExtends(e) {
      function t(t) {
        for (var n = 0; !x.isPlainObject(t) && !Array.isArray(t);) {
          if (void 0 === t) return;
          if ("function" == typeof t) {
            if (!(t = t.call(i, s, e))) return !1;
          } else if ("string" == typeof t) {
            if (!w[t]) return {
              html: t
            };
            t = w[t];
          }
          if (30 < ++n) throw "Buttons: Too many iterations";
        }
        return Array.isArray(t) ? t : x.extend({}, t);
      }
      var n,
        o,
        i = this,
        s = this.s.dt;
      for (e = t(e); e && e.extend;) {
        if (!w[e.extend]) throw "Cannot extend unknown button type: " + e.extend;
        var r = t(w[e.extend]);
        if (Array.isArray(r)) return r;
        if (!r) return !1;
        var a = r.className;
        void 0 !== e.config && void 0 !== r.config && (e.config = x.extend({}, r.config, e.config)), e = x.extend({}, r, e), a && e.className !== a && (e.className = a + " " + e.className), e.extend = r.extend;
      }
      var l = e.postfixButtons;
      if (l) for (e.buttons || (e.buttons = []), n = 0, o = l.length; n < o; n++) e.buttons.push(l[n]);
      var c = e.prefixButtons;
      if (c) for (e.buttons || (e.buttons = []), n = 0, o = c.length; n < o; n++) e.buttons.splice(n, 0, c[n]);
      return e;
    },
    _popover: function _popover(o, t, n) {
      function i() {
        f = !0, y(x(h), p.fade, function () {
          x(this).detach();
        }), x(u.buttons('[aria-haspopup="dialog"][aria-expanded="true"]').nodes()).attr("aria-expanded", "false"), x("div.dt-button-background").off("click.dtb-collection"), _.background(!1, p.backgroundClassName, p.fade, b), x(g).off("resize.resize.dtb-collection"), x("body").off(".dtb-collection"), u.off("buttons-action.b-internal"), u.off("destroy");
      }
      var e,
        s,
        r,
        a,
        l,
        c,
        u = t,
        d = this.c,
        f = !1,
        p = x.extend({
          align: "button-left",
          autoClose: !1,
          background: !0,
          backgroundClassName: "dt-button-background",
          closeButton: !0,
          containerClassName: d.dom.collection.container.className,
          contentClassName: d.dom.collection.container.content.className,
          collectionLayout: "",
          collectionTitle: "",
          dropup: !1,
          fade: 400,
          popoverTitle: "",
          rightAlignClassName: "dt-button-right",
          tag: d.dom.collection.container.tag
        }, n),
        h = p.tag + "." + p.containerClassName.replace(/ /g, "."),
        b = t.node();
      !1 === o ? i() : ((d = x(u.buttons('[aria-haspopup="dialog"][aria-expanded="true"]').nodes())).length && (b.closest(h).length && (b = d.eq(0)), i()), n = x(".dt-button", o).length, d = "", 3 === n ? d = "dtb-b3" : 2 === n ? d = "dtb-b2" : 1 === n && (d = "dtb-b1"), e = x("<" + p.tag + "/>").addClass(p.containerClassName).addClass(p.collectionLayout).addClass(p.splitAlignClass).addClass(d).css("display", "none").attr({
        "aria-modal": !0,
        role: "dialog"
      }), o = x(o).addClass(p.contentClassName).attr("role", "menu").appendTo(e), b.attr("aria-expanded", "true"), b.parents("body")[0] !== m.body && (b = m.body.lastChild), p.popoverTitle ? e.prepend('<div class="dt-button-collection-title">' + p.popoverTitle + "</div>") : p.collectionTitle && e.prepend('<div class="dt-button-collection-title">' + p.collectionTitle + "</div>"), p.closeButton && e.prepend('<div class="dtb-popover-close">&times;</div>').addClass("dtb-collection-closeable"), v(e.insertAfter(b), p.fade), n = x(t.table().container()), d = e.css("position"), "container" !== p.span && "dt-container" !== p.align || (b = b.parent(), e.css("width", n.width())), "absolute" === d ? (t = x(b[0].offsetParent), n = b.position(), d = b.offset(), a = t.offset(), s = t.position(), r = g.getComputedStyle(t[0]), a.height = t.outerHeight(), a.width = t.width() + parseFloat(r.paddingLeft), a.right = a.left + a.width, a.bottom = a.top + a.height, t = n.top + b.outerHeight(), a = n.left, e.css({
        top: t,
        left: a
      }), r = g.getComputedStyle(e[0]), (l = e.offset()).height = e.outerHeight(), l.width = e.outerWidth(), l.right = l.left + l.width, l.bottom = l.top + l.height, l.marginTop = parseFloat(r.marginTop), l.marginBottom = parseFloat(r.marginBottom), p.dropup && (t = n.top - l.height - l.marginTop - l.marginBottom), "button-right" !== p.align && !e.hasClass(p.rightAlignClassName) || (a = n.left - l.width + b.outerWidth()), "dt-container" !== p.align && "container" !== p.align || a < n.left && (a = -n.left), s.left + a + l.width > x(g).width() && (a = x(g).width() - l.width - s.left), d.left + a < 0 && (a = -d.left), s.top + t + l.height > x(g).height() + x(g).scrollTop() && (t = n.top - l.height - l.marginTop - l.marginBottom), s.top + t < x(g).scrollTop() && (t = n.top + b.outerHeight()), e.css({
        top: t,
        left: a
      })) : ((c = function c() {
        var t = x(g).height() / 2,
          n = e.height() / 2;
        e.css("marginTop", -1 * (n = t < n ? t : n));
      })(), x(g).on("resize.dtb-collection", function () {
        c();
      })), p.background && _.background(!0, p.backgroundClassName, p.fade, p.backgroundHost || b), x("div.dt-button-background").on("click.dtb-collection", function () {}), p.autoClose && setTimeout(function () {
        u.on("buttons-action.b-internal", function (t, n, e, o) {
          o[0] !== b[0] && i();
        });
      }, 0), x(e).trigger("buttons-popover.dt"), u.on("destroy", i), setTimeout(function () {
        f = !1, x("body").on("click.dtb-collection", function (t) {
          var n, e;
          !f && (n = x.fn.addBack ? "addBack" : "andSelf", e = x(t.target).parent()[0], !x(t.target).parents()[n]().filter(o).length && !x(e).hasClass("dt-buttons") || x(t.target).hasClass("dt-button-background")) && i();
        }).on("keyup.dtb-collection", function (t) {
          27 === t.keyCode && i();
        }).on("keydown.dtb-collection", function (t) {
          var n = x("a, button", o),
            e = m.activeElement;
          9 === t.keyCode && (-1 === n.index(e) ? (n.first().focus(), t.preventDefault()) : t.shiftKey ? e === n[0] && (n.last().focus(), t.preventDefault()) : e === n.last()[0] && (n.first().focus(), t.preventDefault()));
        });
      }, 0));
    }
  }), _.background = function (t, n, e, o) {
    void 0 === e && (e = 400), o = o || m.body, t ? v(x("<div/>").addClass(n).css("display", "none").insertAfter(o), e) : y(x("div." + n), e, function () {
      x(this).removeClass(n).remove();
    });
  }, _.instanceSelector = function (t, i) {
    var s, r, _a2;
    return null == t ? x.map(i, function (t) {
      return t.inst;
    }) : (s = [], r = x.map(i, function (t) {
      return t.name;
    }), (_a2 = function a(t) {
      var n;
      if (Array.isArray(t)) for (var e = 0, o = t.length; e < o; e++) _a2(t[e]);else "string" == typeof t ? -1 !== t.indexOf(",") ? _a2(t.split(",")) : -1 !== (n = x.inArray(t.trim(), r)) && s.push(i[n].inst) : "number" == typeof t ? s.push(i[t].inst) : "object" == _typeof(t) && s.push(t);
    })(t), s);
  }, _.buttonSelector = function (t, n) {
    for (var c = [], u = function u(t, n, e) {
        for (var o, i, s = 0, r = n.length; s < r; s++) (o = n[s]) && (t.push({
          node: o.node,
          name: o.conf.name,
          idx: i = void 0 !== e ? e + s : s + ""
        }), o.buttons) && u(t, o.buttons, i + "-");
      }, d = function d(t, n) {
        var e = [],
          o = (u(e, n.s.buttons), x.map(e, function (t) {
            return t.node;
          }));
        if (Array.isArray(t) || t instanceof x) for (s = 0, r = t.length; s < r; s++) d(t[s], n);else if (null == t || "*" === t) for (s = 0, r = e.length; s < r; s++) c.push({
          inst: n,
          node: e[s].node
        });else if ("number" == typeof t) n.s.buttons[t] && c.push({
          inst: n,
          node: n.s.buttons[t].node
        });else if ("string" == typeof t) {
          if (-1 !== t.indexOf(",")) for (var i = t.split(","), s = 0, r = i.length; s < r; s++) d(i[s].trim(), n);else if (t.match(/^\d+(\-\d+)*$/)) {
            var a = x.map(e, function (t) {
              return t.idx;
            });
            c.push({
              inst: n,
              node: e[x.inArray(t, a)].node
            });
          } else if (-1 !== t.indexOf(":name")) {
            var l = t.replace(":name", "");
            for (s = 0, r = e.length; s < r; s++) e[s].name === l && c.push({
              inst: n,
              node: e[s].node
            });
          } else x(o).filter(t).each(function () {
            c.push({
              inst: n,
              node: this
            });
          });
        } else "object" == _typeof(t) && t.nodeName && -1 !== (a = x.inArray(t, o)) && c.push({
          inst: n,
          node: o[a]
        });
      }, e = 0, o = t.length; e < o; e++) {
      var i = t[e];
      d(n, i);
    }
    return c;
  }, _.stripData = function (t, n) {
    return t = "string" == typeof t && (t = (t = t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, "")).replace(/<!\-\-.*?\-\->/g, ""), n && !n.stripHtml || (t = t.replace(/<[^>]*>/g, "")), n && !n.trim || (t = t.replace(/^\s+|\s+$/g, "")), n && !n.stripNewlines || (t = t.replace(/\n/g, " ")), !n || n.decodeEntities) ? i ? i(t) : (c.innerHTML = t, c.value) : t;
  }, _.entityDecoder = function (t) {
    i = t;
  }, _.defaults = {
    buttons: ["copy", "excel", "csv", "pdf", "print"],
    name: "main",
    tabIndex: 0,
    dom: {
      container: {
        tag: "div",
        className: "dt-buttons"
      },
      collection: {
        action: {
          dropHtml: '<span class="dt-button-down-arrow">&#x25BC;</span>'
        },
        container: {
          className: "dt-button-collection",
          content: {
            className: "",
            tag: "div"
          },
          tag: "div"
        }
      },
      button: {
        tag: "button",
        className: "dt-button",
        active: "dt-button-active",
        disabled: "disabled",
        spacer: {
          className: "dt-button-spacer",
          tag: "span"
        },
        liner: {
          tag: "span",
          className: ""
        }
      },
      split: {
        action: {
          className: "dt-button-split-drop-button dt-button",
          tag: "button"
        },
        dropdown: {
          align: "split-right",
          className: "dt-button-split-drop",
          dropHtml: '<span class="dt-button-down-arrow">&#x25BC;</span>',
          splitAlignClass: "dt-button-split-left",
          tag: "button"
        },
        wrapper: {
          className: "dt-button-split",
          tag: "div"
        }
      }
    }
  }, x.extend(w, {
    collection: {
      text: function text(t) {
        return t.i18n("buttons.collection", "Collection");
      },
      className: "buttons-collection",
      closeButton: !(_.version = "3.0.1"),
      init: function init(t, n) {
        n.attr("aria-expanded", !1);
      },
      action: function action(t, n, e, o) {
        o._collection.parents("body").length ? this.popover(!1, o) : this.popover(o._collection, o), "keypress" === t.type && x("a, button", o._collection).eq(0).focus();
      },
      attr: {
        "aria-haspopup": "dialog"
      }
    },
    split: {
      text: function text(t) {
        return t.i18n("buttons.split", "Split");
      },
      className: "buttons-split",
      closeButton: !1,
      init: function init(t, n) {
        return n.attr("aria-expanded", !1);
      },
      action: function action(t, n, e, o) {
        this.popover(o._collection, o);
      },
      attr: {
        "aria-haspopup": "dialog"
      }
    },
    copy: function copy() {
      if (w.copyHtml5) return "copyHtml5";
    },
    csv: function csv(t, n) {
      if (w.csvHtml5 && w.csvHtml5.available(t, n)) return "csvHtml5";
    },
    excel: function excel(t, n) {
      if (w.excelHtml5 && w.excelHtml5.available(t, n)) return "excelHtml5";
    },
    pdf: function pdf(t, n) {
      if (w.pdfHtml5 && w.pdfHtml5.available(t, n)) return "pdfHtml5";
    },
    pageLength: function pageLength(t) {
      var n = t.settings()[0].aLengthMenu,
        e = [],
        o = [];
      if (Array.isArray(n[0])) e = n[0], o = n[1];else for (var i = 0; i < n.length; i++) {
        var s = n[i];
        x.isPlainObject(s) ? (e.push(s.value), o.push(s.label)) : (e.push(s), o.push(s));
      }
      return {
        extend: "collection",
        text: function text(t) {
          return t.i18n("buttons.pageLength", {
            "-1": "Show all rows",
            _: "Show %d rows"
          }, t.page.len());
        },
        className: "buttons-page-length",
        autoClose: !0,
        buttons: x.map(e, function (s, t) {
          return {
            text: o[t],
            className: "button-page-length",
            action: function action(t, n) {
              n.page.len(s).draw();
            },
            init: function init(t, n, e) {
              function o() {
                i.active(t.page.len() === s);
              }
              var i = this;
              t.on("length.dt" + e.namespace, o), o();
            },
            destroy: function destroy(t, n, e) {
              t.off("length.dt" + e.namespace);
            }
          };
        }),
        init: function init(t, n, e) {
          var o = this;
          t.on("length.dt" + e.namespace, function () {
            o.text(e.text);
          });
        },
        destroy: function destroy(t, n, e) {
          t.off("length.dt" + e.namespace);
        }
      };
    },
    spacer: {
      style: "empty",
      spacer: !0,
      text: function text(t) {
        return t.i18n("buttons.spacer", "");
      }
    }
  }), e.Api.register("buttons()", function (n, e) {
    void 0 === e && (e = n, n = void 0), this.selector.buttonGroup = n;
    var t = this.iterator(!0, "table", function (t) {
      if (t._buttons) return _.buttonSelector(_.instanceSelector(n, t._buttons), e);
    }, !0);
    return t._groupSelector = n, t;
  }), e.Api.register("button()", function (t, n) {
    t = this.buttons(t, n);
    return 1 < t.length && t.splice(1, t.length), t;
  }), e.Api.registerPlural("buttons().active()", "button().active()", function (n) {
    return void 0 === n ? this.map(function (t) {
      return t.inst.active(t.node);
    }) : this.each(function (t) {
      t.inst.active(t.node, n);
    });
  }), e.Api.registerPlural("buttons().action()", "button().action()", function (n) {
    return void 0 === n ? this.map(function (t) {
      return t.inst.action(t.node);
    }) : this.each(function (t) {
      t.inst.action(t.node, n);
    });
  }), e.Api.registerPlural("buttons().collectionRebuild()", "button().collectionRebuild()", function (e) {
    return this.each(function (t) {
      for (var n = 0; n < e.length; n++) "object" == _typeof(e[n]) && (e[n].parentConf = t);
      t.inst.collectionRebuild(t.node, e);
    });
  }), e.Api.register(["buttons().enable()", "button().enable()"], function (n) {
    return this.each(function (t) {
      t.inst.enable(t.node, n);
    });
  }), e.Api.register(["buttons().disable()", "button().disable()"], function () {
    return this.each(function (t) {
      t.inst.disable(t.node);
    });
  }), e.Api.register("button().index()", function () {
    var n = null;
    return this.each(function (t) {
      t = t.inst.index(t.node);
      null !== t && (n = t);
    }), n;
  }), e.Api.registerPlural("buttons().nodes()", "button().node()", function () {
    var n = x();
    return x(this.each(function (t) {
      n = n.add(t.inst.node(t.node));
    })), n;
  }), e.Api.registerPlural("buttons().processing()", "button().processing()", function (n) {
    return void 0 === n ? this.map(function (t) {
      return t.inst.processing(t.node);
    }) : this.each(function (t) {
      t.inst.processing(t.node, n);
    });
  }), e.Api.registerPlural("buttons().text()", "button().text()", function (n) {
    return void 0 === n ? this.map(function (t) {
      return t.inst.text(t.node);
    }) : this.each(function (t) {
      t.inst.text(t.node, n);
    });
  }), e.Api.registerPlural("buttons().trigger()", "button().trigger()", function () {
    return this.each(function (t) {
      t.inst.node(t.node).trigger("click");
    });
  }), e.Api.register("button().popover()", function (n, e) {
    return this.map(function (t) {
      return t.inst._popover(n, this.button(this[0].node), e);
    });
  }), e.Api.register("buttons().containers()", function () {
    var i = x(),
      s = this._groupSelector;
    return this.iterator(!0, "table", function (t) {
      if (t._buttons) for (var n = _.instanceSelector(s, t._buttons), e = 0, o = n.length; e < o; e++) i = i.add(n[e].container());
    }), i;
  }), e.Api.register("buttons().container()", function () {
    return this.containers().eq(0);
  }), e.Api.register("button().add()", function (t, n, e) {
    var o = this.context;
    return o.length && (o = _.instanceSelector(this._groupSelector, o[0]._buttons)).length && o[0].add(n, t, e), this.button(this._groupSelector, t);
  }), e.Api.register("buttons().destroy()", function () {
    return this.pluck("inst").unique().each(function (t) {
      t.destroy();
    }), this;
  }), e.Api.registerPlural("buttons().remove()", "buttons().remove()", function () {
    return this.each(function (t) {
      t.inst.remove(t.node);
    }), this;
  }), e.Api.register("buttons.info()", function (t, n, e) {
    var o = this;
    return !1 === t ? (this.off("destroy.btn-info"), y(x("#datatables_buttons_info"), 400, function () {
      x(this).remove();
    }), clearTimeout(s), s = null) : (s && clearTimeout(s), x("#datatables_buttons_info").length && x("#datatables_buttons_info").remove(), t = t ? "<h2>" + t + "</h2>" : "", v(x('<div id="datatables_buttons_info" class="dt-button-info"/>').html(t).append(x("<div/>")["string" == typeof n ? "html" : "append"](n)).css("display", "none").appendTo("body")), void 0 !== e && 0 !== e && (s = setTimeout(function () {
      o.buttons.info(!1);
    }, e)), this.on("destroy.btn-info", function () {
      o.buttons.info(!1);
    })), this;
  }), e.Api.register("buttons.exportData()", function (t) {
    if (this.context.length) return u(new e.Api(this.context[0]), t);
  }), e.Api.register("buttons.exportInfo()", function (t) {
    return {
      filename: n(t = t || {}, this),
      title: a(t, this),
      messageTop: l(this, t, t.message || t.messageTop, "top"),
      messageBottom: l(this, t, t.messageBottom, "bottom")
    };
  });
  var s,
    n = function n(t, _n) {
      var e;
      return null == (e = "function" == typeof (e = "*" === t.filename && "*" !== t.title && void 0 !== t.title && null !== t.title && "" !== t.title ? t.title : t.filename) ? e(t, _n) : e) ? null : (e = (e = -1 !== e.indexOf("*") ? e.replace("*", x("head > title").text()).trim() : e).replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g, "")) + (r(t.extension, t, _n) || "");
    },
    r = function r(t, n, e) {
      return null == t ? null : "function" == typeof t ? t(n, e) : t;
    },
    a = function a(t, n) {
      t = r(t.title, t, n);
      return null === t ? null : -1 !== t.indexOf("*") ? t.replace("*", x("head > title").text() || "Exported data") : t;
    },
    l = function l(t, n, e, o) {
      e = r(e, n, t);
      return null === e ? null : (n = x("caption", t.table().container()).eq(0), "*" === e ? n.css("caption-side") !== o ? null : n.length ? n.text() : "" : e);
    },
    c = x("<textarea/>")[0],
    u = function u(i, t) {
      for (var s = x.extend(!0, {}, {
          rows: null,
          columns: "",
          modifier: {
            search: "applied",
            order: "applied"
          },
          orthogonal: "display",
          stripHtml: !0,
          stripNewlines: !0,
          decodeEntities: !0,
          trim: !0,
          format: {
            header: function header(t) {
              return _.stripData(t, s);
            },
            footer: function footer(t) {
              return _.stripData(t, s);
            },
            body: function body(t) {
              return _.stripData(t, s);
            }
          },
          customizeData: null
        }, t), t = i.columns(s.columns).indexes().map(function (t) {
          var n = i.column(t);
          return s.format.header(n.title(), t, n.header());
        }).toArray(), n = i.table().footer() ? i.columns(s.columns).indexes().map(function (t) {
          var n,
            e = i.column(t).footer(),
            o = "";
          return e && (o = ((n = x(".dt-column-title", e)).length ? n : x(e)).html()), s.format.footer(o, t, e);
        }).toArray() : null, e = x.extend({}, s.modifier), o = (i.select && "function" == typeof i.select.info && void 0 === e.selected && i.rows(s.rows, x.extend({
          selected: !0
        }, e)).any() && x.extend(e, {
          selected: !0
        }), i.rows(s.rows, e).indexes().toArray()), o = i.cells(o, s.columns, {
          order: e.order
        }), r = o.render(s.orthogonal).toArray(), a = o.nodes().toArray(), l = o.indexes().toArray(), c = i.columns(s.columns).count(), u = [], d = 0, f = 0, p = 0 < c ? r.length / c : 0; f < p; f++) {
        for (var h = [c], b = 0; b < c; b++) h[b] = s.format.body(r[d], l[d].row, l[d].column, a[d]), d++;
        u[f] = h;
      }
      e = {
        header: t,
        headerStructure: A(s.format.header, i.table().header.structure(s.columns)),
        footer: n,
        footerStructure: A(s.format.footer, i.table().footer.structure(s.columns)),
        body: u
      };
      return s.customizeData && s.customizeData(e), e;
    };
  function A(t, n) {
    for (var e = 0; e < n.length; e++) for (var o = 0; o < n[e].length; o++) {
      var i = n[e][o];
      i && (i.title = t(i.title, o, i.cell));
    }
    return n;
  }
  function t(t, n) {
    t = new e.Api(t), n = n || t.init().buttons || e.defaults.buttons;
    return new _(t, n).container();
  }
  return x.fn.dataTable.Buttons = _, x.fn.DataTable.Buttons = _, x(m).on("init.dt plugin-init.dt", function (t, n) {
    "dt" === t.namespace && (t = n.oInit.buttons || e.defaults.buttons) && !n._buttons && new _(n, t).container();
  }), e.ext.feature.push({
    fnInit: t,
    cFeature: "B"
  }), e.feature && e.feature.register("buttons", t), e;
});

/*! jQuery UI integration for DataTables' Buttons
 * © SpryMedia Ltd - datatables.net/license
 */
!function (e) {
  var o, i;
  "function" == typeof define && define.amd ? define(["jquery", "datatables.net-jqui", "datatables.net-buttons"], function (t) {
    return e(t, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (o = require("jquery"), i = function i(t, n) {
    n.fn.dataTable || require("datatables.net-jqui")(t, n), n.fn.dataTable.Buttons || require("datatables.net-buttons")(t, n);
  }, "undefined" == typeof window ? module.exports = function (t, n) {
    return t = t || window, n = n || o(t), i(t, n), e(n, 0, t.document);
  } : (i(window, o), module.exports = e(o, window, window.document))) : e(jQuery, window, document);
}(function (t, n, e) {
  "use strict";

  var o = t.fn.dataTable;
  return t.extend(!0, o.Buttons.defaults, {
    dom: {
      collection: {
        action: {
          dropHtml: '<span class="ui-button-icon-primary ui-icon ui-icon-triangle-1-s"/>'
        },
        button: {
          active: "dt-button-active"
        }
      },
      container: {
        className: "dt-buttons ui-buttonset"
      },
      button: {
        className: "dt-button ui-button ui-corner-all",
        disabled: "ui-state-disabled",
        active: "ui-state-active",
        liner: {
          tag: "span",
          className: ""
        }
      },
      split: {
        action: {
          tag: "button",
          className: "dt-button-split-drop-button ui-button ui-corner-left"
        },
        dropdown: {
          tag: "button",
          dropHtml: '<span class="ui-button-icon-primary ui-icon ui-icon-triangle-1-s"/>',
          className: "dt-button-split-drop ui-button ui-corner-right"
        },
        wrapper: {
          tag: "div",
          className: "dt-button-split"
        }
      }
    }
  }), o;
});

/*!
 * Column visibility buttons for Buttons and DataTables.
 * © SpryMedia Ltd - datatables.net/license
 */
!function (e) {
  var o, i;
  "function" == typeof define && define.amd ? define(["jquery", "datatables.net", "datatables.net-buttons"], function (n) {
    return e(n, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (o = require("jquery"), i = function i(n, t) {
    t.fn.dataTable || require("datatables.net")(n, t), t.fn.dataTable.Buttons || require("datatables.net-buttons")(n, t);
  }, "undefined" == typeof window ? module.exports = function (n, t) {
    return n = n || window, t = t || o(n), i(n, t), e(t, 0, n.document);
  } : (i(window, o), module.exports = e(o, window, window.document))) : e(jQuery, window, document);
}(function (n, t, e) {
  "use strict";

  var o = n.fn.dataTable;
  return n.extend(o.ext.buttons, {
    colvis: function colvis(n, t) {
      var e = null,
        o = {
          extend: "collection",
          init: function init(n, t) {
            e = t;
          },
          text: function text(n) {
            return n.i18n("buttons.colvis", "Column visibility");
          },
          className: "buttons-colvis",
          closeButton: !1,
          buttons: [{
            extend: "columnsToggle",
            columns: t.columns,
            columnText: t.columnText
          }]
        };
      return n.on("column-reorder.dt" + t.namespace, function () {
        n.button(null, n.button(null, e).node()).collectionRebuild([{
          extend: "columnsToggle",
          columns: t.columns,
          columnText: t.columnText
        }]);
      }), o;
    },
    columnsToggle: function columnsToggle(n, t) {
      return n.columns(t.columns).indexes().map(function (n) {
        return {
          extend: "columnToggle",
          columns: n,
          columnText: t.columnText
        };
      }).toArray();
    },
    columnToggle: function columnToggle(n, t) {
      return {
        extend: "columnVisibility",
        columns: t.columns,
        columnText: t.columnText
      };
    },
    columnsVisibility: function columnsVisibility(n, t) {
      return n.columns(t.columns).indexes().map(function (n) {
        return {
          extend: "columnVisibility",
          columns: n,
          visibility: t.visibility,
          columnText: t.columnText
        };
      }).toArray();
    },
    columnVisibility: {
      columns: void 0,
      text: function text(n, t, e) {
        return e._columnText(n, e);
      },
      className: "buttons-columnVisibility",
      action: function action(n, t, e, o) {
        var t = t.columns(o.columns),
          i = t.visible();
        t.visible(void 0 !== o.visibility ? o.visibility : !(i.length && i[0]));
      },
      init: function init(e, n, o) {
        var i = this;
        n.attr("data-cv-idx", o.columns), e.on("column-visibility.dt" + o.namespace, function (n, t) {
          t.bDestroying || t.nTable != e.settings()[0].nTable || i.active(e.column(o.columns).visible());
        }).on("column-reorder.dt" + o.namespace, function () {
          o.destroying || 1 === e.columns(o.columns).count() && (i.text(o._columnText(e, o)), i.active(e.column(o.columns).visible()));
        }), this.active(e.column(o.columns).visible());
      },
      destroy: function destroy(n, t, e) {
        n.off("column-visibility.dt" + e.namespace).off("column-reorder.dt" + e.namespace);
      },
      _columnText: function _columnText(n, t) {
        var e, o;
        return "string" == typeof t.text ? t.text : (e = n.column(t.columns).index(), o = (o = (o = n.settings()[0].aoColumns[e].sTitle) || n.column(e).header().innerHTML).replace(/\n/g, " ").replace(/<br\s*\/?>/gi, " ").replace(/<select(.*?)<\/select>/g, "").replace(/<!\-\-.*?\-\->/g, "").replace(/<.*?>/g, "").replace(/^\s+|\s+$/g, ""), t.columnText ? t.columnText(n, e, o) : o);
      }
    },
    colvisRestore: {
      className: "buttons-colvisRestore",
      text: function text(n) {
        return n.i18n("buttons.colvisRestore", "Restore visibility");
      },
      init: function init(n, t, e) {
        n.columns().every(function () {
          var n = this.init();
          void 0 === n.__visOriginal && (n.__visOriginal = this.visible());
        });
      },
      action: function action(n, t, e, o) {
        t.columns().every(function (n) {
          var t = this.init();
          this.visible(t.__visOriginal);
        });
      }
    },
    colvisGroup: {
      className: "buttons-colvisGroup",
      action: function action(n, t, e, o) {
        t.columns(o.show).visible(!0, !1), t.columns(o.hide).visible(!1, !1), t.columns.adjust();
      },
      show: [],
      hide: []
    }
  }), o;
});

/*! Responsive 3.0.1
 * © SpryMedia Ltd - datatables.net/license
 */
!function (n) {
  var i, r;
  "function" == typeof define && define.amd ? define(["jquery", "datatables.net"], function (e) {
    return n(e, window, document);
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? (i = require("jquery"), r = function r(e, t) {
    t.fn.dataTable || require("datatables.net")(e, t);
  }, "undefined" == typeof window ? module.exports = function (e, t) {
    return e = e || window, t = t || i(e), r(e, t), n(t, e, e.document);
  } : (r(window, i), module.exports = n(i, window, window.document))) : n(jQuery, window, document);
}(function (m, v, d) {
  "use strict";

  function a(e, t) {
    if (!i.versionCheck || !i.versionCheck("2")) throw "DataTables Responsive requires DataTables 2 or newer";
    this.s = {
      childNodeStore: {},
      columns: [],
      current: [],
      dt: new i.Api(e)
    }, this.s.dt.settings()[0].responsive || (t && "string" == typeof t.details ? t.details = {
      type: t.details
    } : t && !1 === t.details ? t.details = {
      type: !1
    } : t && !0 === t.details && (t.details = {
      type: "inline"
    }), this.c = m.extend(!0, {}, a.defaults, i.defaults.responsive, t), (e.responsive = this)._constructor());
  }
  var i = m.fn.dataTable,
    e = (m.extend(a.prototype, {
      _constructor: function _constructor() {
        var s = this,
          r = this.s.dt,
          t = m(v).innerWidth(),
          e = (r.settings()[0]._responsive = this, m(v).on("orientationchange.dtr", i.util.throttle(function () {
            var e = m(v).innerWidth();
            e !== t && (s._resize(), t = e);
          })), r.on("row-created.dtr", function (e, t, n, i) {
            -1 !== m.inArray(!1, s.s.current) && m(">td, >th", t).each(function (e) {
              e = r.column.index("toData", e);
              !1 === s.s.current[e] && m(this).css("display", "none");
            });
          }), r.on("destroy.dtr", function () {
            r.off(".dtr"), m(r.table().body()).off(".dtr"), m(v).off("resize.dtr orientationchange.dtr"), r.cells(".dtr-control").nodes().to$().removeClass("dtr-control"), m(r.table().node()).removeClass("dtr-inline collapsed"), m.each(s.s.current, function (e, t) {
              !1 === t && s._setColumnVis(e, !0);
            });
          }), this.c.breakpoints.sort(function (e, t) {
            return e.width < t.width ? 1 : e.width > t.width ? -1 : 0;
          }), this._classLogic(), this._resizeAuto(), this.c.details);
        !1 !== e.type && (s._detailsInit(), r.on("column-visibility.dtr", function () {
          s._timer && clearTimeout(s._timer), s._timer = setTimeout(function () {
            s._timer = null, s._classLogic(), s._resizeAuto(), s._resize(!0), s._redrawChildren();
          }, 100);
        }), r.on("draw.dtr", function () {
          s._redrawChildren();
        }), m(r.table().node()).addClass("dtr-" + e.type)), r.on("column-reorder.dtr", function (e, t, n) {
          s._classLogic(), s._resizeAuto(), s._resize(!0);
        }), r.on("column-sizing.dtr", function () {
          s._resizeAuto(), s._resize();
        }), r.on("column-calc.dt", function (e, t) {
          for (var n = s.s.current, i = 0; i < n.length; i++) {
            var r = t.visible.indexOf(i);
            !1 === n[i] && 0 <= r && t.visible.splice(r, 1);
          }
        }), r.on("preXhr.dtr", function () {
          var e = [];
          r.rows().every(function () {
            this.child.isShown() && e.push(this.id(!0));
          }), r.one("draw.dtr", function () {
            s._resizeAuto(), s._resize(), r.rows(e).every(function () {
              s._detailsDisplay(this, !1);
            });
          });
        }), r.on("draw.dtr", function () {
          s._controlClass();
        }).on("init.dtr", function (e, t, n) {
          "dt" === e.namespace && (s._resizeAuto(), s._resize(), m.inArray(!1, s.s.current)) && r.columns.adjust();
        }), this._resize();
      },
      _childNodes: function _childNodes(e, t, n) {
        var i = t + "-" + n;
        if (this.s.childNodeStore[i]) return this.s.childNodeStore[i];
        for (var r = [], s = e.cell(t, n).node().childNodes, o = 0, d = s.length; o < d; o++) r.push(s[o]);
        return this.s.childNodeStore[i] = r;
      },
      _childNodesRestore: function _childNodesRestore(e, t, n) {
        var i = t + "-" + n;
        if (this.s.childNodeStore[i]) {
          var r = e.cell(t, n).node(),
            e = this.s.childNodeStore[i];
          if (0 < e.length) {
            for (var s = e[0].parentNode.childNodes, o = [], d = 0, a = s.length; d < a; d++) o.push(s[d]);
            for (var l = 0, c = o.length; l < c; l++) r.appendChild(o[l]);
          }
          this.s.childNodeStore[i] = void 0;
        }
      },
      _columnsVisiblity: function _columnsVisiblity(n) {
        for (var i = this.s.dt, e = this.s.columns, t = e.map(function (e, t) {
            return {
              columnIdx: t,
              priority: e.priority
            };
          }).sort(function (e, t) {
            return e.priority !== t.priority ? e.priority - t.priority : e.columnIdx - t.columnIdx;
          }), r = m.map(e, function (e, t) {
            return !1 === i.column(t).visible() ? "not-visible" : (!e.auto || null !== e.minWidth) && (!0 === e.auto ? "-" : -1 !== m.inArray(n, e.includeIn));
          }), s = 0, o = 0, d = r.length; o < d; o++) !0 === r[o] && (s += e[o].minWidth);
        var a = i.settings()[0].oScroll,
          a = a.sY || a.sX ? a.iBarWidth : 0,
          l = i.table().container().offsetWidth - a - s;
        for (o = 0, d = r.length; o < d; o++) e[o].control && (l -= e[o].minWidth);
        var c = !1;
        for (o = 0, d = t.length; o < d; o++) {
          var u = t[o].columnIdx;
          "-" === r[u] && !e[u].control && e[u].minWidth && (c || l - e[u].minWidth < 0 ? r[u] = !(c = !0) : r[u] = !0, l -= e[u].minWidth);
        }
        var h = !1;
        for (o = 0, d = e.length; o < d; o++) if (!e[o].control && !e[o].never && !1 === r[o]) {
          h = !0;
          break;
        }
        for (o = 0, d = e.length; o < d; o++) e[o].control && (r[o] = h), "not-visible" === r[o] && (r[o] = !1);
        return -1 === m.inArray(!0, r) && (r[0] = !0), r;
      },
      _classLogic: function _classLogic() {
        function d(e, t, n, i) {
          var r, s, o;
          if (n) {
            if ("max-" === n) for (r = a._find(t).width, s = 0, o = l.length; s < o; s++) l[s].width <= r && u(e, l[s].name);else if ("min-" === n) for (r = a._find(t).width, s = 0, o = l.length; s < o; s++) l[s].width >= r && u(e, l[s].name);else if ("not-" === n) for (s = 0, o = l.length; s < o; s++) -1 === l[s].name.indexOf(i) && u(e, l[s].name);
          } else c[e].includeIn.push(t);
        }
        var a = this,
          l = this.c.breakpoints,
          c = this.s.dt.columns().eq(0).map(function (e) {
            var e = this.column(e),
              t = e.header().className,
              n = e.init().responsivePriority,
              e = e.header().getAttribute("data-priority");
            return void 0 === n && (n = null == e ? 1e4 : +e), {
              className: t,
              includeIn: [],
              auto: !1,
              control: !1,
              never: !!t.match(/\b(dtr\-)?never\b/),
              priority: n
            };
          }),
          u = function u(e, t) {
            e = c[e].includeIn;
            -1 === m.inArray(t, e) && e.push(t);
          };
        c.each(function (e, r) {
          for (var t = e.className.split(" "), s = !1, n = 0, i = t.length; n < i; n++) {
            var o = t[n].trim();
            if ("all" === o || "dtr-all" === o) return s = !0, void (e.includeIn = m.map(l, function (e) {
              return e.name;
            }));
            if ("none" === o || "dtr-none" === o || e.never) return void (s = !0);
            if ("control" === o || "dtr-control" === o) return s = !0, void (e.control = !0);
            m.each(l, function (e, t) {
              var n = t.name.split("-"),
                i = new RegExp("(min\\-|max\\-|not\\-)?(" + n[0] + ")(\\-[_a-zA-Z0-9])?"),
                i = o.match(i);
              i && (s = !0, i[2] === n[0] && i[3] === "-" + n[1] ? d(r, t.name, i[1], i[2] + i[3]) : i[2] !== n[0] || i[3] || d(r, t.name, i[1], i[2]));
            });
          }
          s || (e.auto = !0);
        }), this.s.columns = c;
      },
      _controlClass: function _controlClass() {
        var e, t, n;
        "inline" === this.c.details.type && (e = this.s.dt, t = this.s.current, n = m.inArray(!0, t), e.cells(null, function (e) {
          return e !== n;
        }, {
          page: "current"
        }).nodes().to$().filter(".dtr-control").removeClass("dtr-control"), e.cells(null, n, {
          page: "current"
        }).nodes().to$().addClass("dtr-control"));
      },
      _detailsDisplay: function _detailsDisplay(t, n) {
        function e(e) {
          m(t.node()).toggleClass("dtr-expanded", !1 !== e), m(s.table().node()).triggerHandler("responsive-display.dt", [s, t, e, n]);
        }
        var i,
          r = this,
          s = this.s.dt,
          o = this.c.details;
        o && !1 !== o.type && (i = "string" == typeof o.renderer ? a.renderer[o.renderer]() : o.renderer, "boolean" == typeof (o = o.display(t, n, function () {
          return i.call(r, s, t[0][0], r._detailsObj(t[0]));
        }, function () {
          e(!1);
        }))) && e(o);
      },
      _detailsInit: function _detailsInit() {
        var n = this,
          i = this.s.dt,
          e = this.c.details,
          r = ("inline" === e.type && (e.target = "td.dtr-control, th.dtr-control"), i.on("draw.dtr", function () {
            n._tabIndexes();
          }), n._tabIndexes(), m(i.table().body()).on("keyup.dtr", "td, th", function (e) {
            13 === e.keyCode && m(this).data("dtr-keyboard") && m(this).click();
          }), e.target),
          e = "string" == typeof r ? r : "td, th";
        void 0 === r && null === r || m(i.table().body()).on("click.dtr mousedown.dtr mouseup.dtr", e, function (e) {
          if (m(i.table().node()).hasClass("collapsed") && -1 !== m.inArray(m(this).closest("tr").get(0), i.rows().nodes().toArray())) {
            if ("number" == typeof r) {
              var t = r < 0 ? i.columns().eq(0).length + r : r;
              if (i.cell(this).index().column !== t) return;
            }
            t = i.row(m(this).closest("tr"));
            "click" === e.type ? n._detailsDisplay(t, !1) : "mousedown" === e.type ? m(this).css("outline", "none") : "mouseup" === e.type && m(this).trigger("blur").css("outline", "");
          }
        });
      },
      _detailsObj: function _detailsObj(n) {
        var i = this,
          r = this.s.dt;
        return m.map(this.s.columns, function (e, t) {
          if (!e.never && !e.control) return {
            className: r.settings()[0].aoColumns[t].sClass,
            columnIndex: t,
            data: r.cell(n, t).render(i.c.orthogonal),
            hidden: r.column(t).visible() && !i.s.current[t],
            rowIndex: n,
            title: r.column(t).title()
          };
        });
      },
      _find: function _find(e) {
        for (var t = this.c.breakpoints, n = 0, i = t.length; n < i; n++) if (t[n].name === e) return t[n];
      },
      _redrawChildren: function _redrawChildren() {
        var n = this,
          i = this.s.dt;
        i.rows({
          page: "current"
        }).iterator("row", function (e, t) {
          n._detailsDisplay(i.row(t), !0);
        });
      },
      _resize: function _resize(n) {
        for (var e, i = this, r = this.s.dt, t = m(v).innerWidth(), s = this.c.breakpoints, o = s[0].name, d = this.s.columns, a = this.s.current.slice(), l = s.length - 1; 0 <= l; l--) if (t <= s[l].width) {
          o = s[l].name;
          break;
        }
        var c = this._columnsVisiblity(o),
          u = (this.s.current = c, !1);
        for (l = 0, e = d.length; l < e; l++) if (!1 === c[l] && !d[l].never && !d[l].control && !1 == !r.column(l).visible()) {
          u = !0;
          break;
        }
        m(r.table().node()).toggleClass("collapsed", u);
        var h = !1,
          p = 0,
          f = r.settings()[0];
        r.columns().eq(0).each(function (e, t) {
          r.column(e).visible() && (!0 === c[t] && p++, !n && c[t] === a[t] || (h = !0, i._setColumnVis(e, c[t])), c[t] || m(f.aoColumns[e].colEl).detach());
        }), h && (this._redrawChildren(), m(r.table().node()).trigger("responsive-resize.dt", [r, this._responsiveOnlyHidden()]), 0 === r.page.info().recordsDisplay) && m("td", r.table().body()).eq(0).attr("colspan", p), i._controlClass();
      },
      _resizeAuto: function _resizeAuto() {
        var t = this.s.dt,
          n = this.s.columns,
          r = this,
          e = t.columns().indexes().filter(function (e) {
            return t.column(e).visible();
          });
        if (this.c.auto && -1 !== m.inArray(!0, m.map(n, function (e) {
          return e.auto;
        }))) {
          for (var i = t.table().node().cloneNode(!1), s = m(t.table().header().cloneNode(!1)).appendTo(i), o = m(t.table().footer().cloneNode(!1)).appendTo(i), d = m(t.table().body()).clone(!1, !1).empty().appendTo(i), a = (i.style.width = "auto", t.table().header.structure(e).forEach(function (e) {
              e = e.filter(function (e) {
                return !!e;
              }).map(function (e) {
                return m(e.cell).clone(!1).css("display", "table-cell").css("width", "auto").css("min-width", 0);
              });
              m("<tr/>").append(e).appendTo(s);
            }), m("<tr/>").appendTo(d)), l = 0; l < e.count(); l++) a.append("<td/>");
          t.rows({
            page: "current"
          }).every(function (n) {
            var i,
              e = this.node();
            e && (i = e.cloneNode(!1), t.cells(n, "*").every(function (e, t) {
              t = r.s.childNodeStore[n + "-" + t];
              (t ? m(this.node().cloneNode(!1)).append(m(t).clone()) : m(this.node()).clone(!1)).appendTo(i);
            }), d.append(i));
          }), d.find("th, td").css("display", ""), t.table().footer.structure(e).forEach(function (e) {
            e = e.filter(function (e) {
              return !!e;
            }).map(function (e) {
              return m(e.cell).clone(!1).css("display", "table-cell").css("width", "auto").css("min-width", 0);
            });
            m("<tr/>").append(e).appendTo(o);
          }), "inline" === this.c.details.type && m(i).addClass("dtr-inline collapsed"), m(i).find("[name]").removeAttr("name"), m(i).css("position", "relative");
          i = m("<div/>").css({
            width: 1,
            height: 1,
            overflow: "hidden",
            clear: "both"
          }).append(i);
          i.insertBefore(t.table().node()), a.children().each(function (e) {
            e = t.column.index("fromVisible", e);
            n[e].minWidth = this.offsetWidth || 0;
          }), i.remove();
        }
      },
      _responsiveOnlyHidden: function _responsiveOnlyHidden() {
        var n = this.s.dt;
        return m.map(this.s.current, function (e, t) {
          return !1 === n.column(t).visible() || e;
        });
      },
      _setColumnVis: function _setColumnVis(e, t) {
        var n = this,
          i = this.s.dt,
          r = t ? "" : "none";
        this._setHeaderVis(e, t, i.table().header.structure()), this._setHeaderVis(e, t, i.table().footer.structure()), i.column(e).nodes().to$().css("display", r).toggleClass("dtr-hidden", !t), m.isEmptyObject(this.s.childNodeStore) || i.cells(null, e).indexes().each(function (e) {
          n._childNodesRestore(i, e.row, e.column);
        });
      },
      _setHeaderVis: function _setHeaderVis(n, i, e) {
        var r = this,
          s = i ? "" : "none";
        e.forEach(function (e) {
          if (e[n]) m(e[n].cell).css("display", s).toggleClass("dtr-hidden", !i);else for (var t = n; 0 <= t;) {
            if (e[t]) {
              e[t].cell.colSpan = r._colspan(e, t);
              break;
            }
            t--;
          }
        });
      },
      _colspan: function _colspan(e, t) {
        for (var n = 1, i = t + 1; i < e.length; i++) if (null === e[i] && this.s.current[i]) n++;else if (e[i]) break;
        return n;
      },
      _tabIndexes: function _tabIndexes() {
        var e = this.s.dt,
          t = e.cells({
            page: "current"
          }).nodes().to$(),
          n = e.settings()[0],
          i = this.c.details.target;
        t.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]"), ("number" == typeof i ? e.cells(null, i, {
          page: "current"
        }).nodes().to$() : m(i = "td:first-child, th:first-child" === i ? ">td:first-child, >th:first-child" : i, e.rows({
          page: "current"
        }).nodes())).attr("tabIndex", n.iTabIndex).data("dtr-keyboard", 1);
      }
    }), a.defaults = {
      breakpoints: a.breakpoints = [{
        name: "desktop",
        width: 1 / 0
      }, {
        name: "tablet-l",
        width: 1024
      }, {
        name: "tablet-p",
        width: 768
      }, {
        name: "mobile-l",
        width: 480
      }, {
        name: "mobile-p",
        width: 320
      }],
      auto: !0,
      details: {
        display: (a.display = {
          childRow: function childRow(e, t, n) {
            var i = m(e.node());
            return t ? i.hasClass("dtr-expanded") ? (e.child(n(), "child").show(), !0) : void 0 : i.hasClass("dtr-expanded") ? (e.child(!1), !1) : !1 !== (t = n()) && (e.child(t, "child").show(), !0);
          },
          childRowImmediate: function childRowImmediate(e, t, n) {
            var i = m(e.node());
            return !t && i.hasClass("dtr-expanded") || !e.responsive.hasHidden() ? (e.child(!1), !1) : !1 !== (t = n()) && (e.child(t, "child").show(), !0);
          },
          modal: function modal(o) {
            return function (e, t, n, i) {
              n = n();
              if (!1 === n) return !1;
              if (t) {
                if (!(s = m("div.dtr-modal-content")).length || e.index() !== s.data("dtr-row-idx")) return null;
                s.empty().append(n);
              } else {
                var r = function r() {
                    s.remove(), m(d).off("keypress.dtr"), m(e.node()).removeClass("dtr-expanded"), i();
                  },
                  s = m('<div class="dtr-modal"/>').append(m('<div class="dtr-modal-display"/>').append(m('<div class="dtr-modal-content"/>').data("dtr-row-idx", e.index()).append(n)).append(m('<div class="dtr-modal-close">&times;</div>').click(function () {
                    r();
                  }))).append(m('<div class="dtr-modal-background"/>').click(function () {
                    r();
                  })).appendTo("body");
                m(e.node()).addClass("dtr-expanded"), m(d).on("keyup.dtr", function (e) {
                  27 === e.keyCode && (e.stopPropagation(), r());
                });
              }
              return o && o.header && m("div.dtr-modal-content").prepend("<h2>" + o.header(e) + "</h2>"), !0;
            };
          }
        }).childRow,
        renderer: (a.renderer = {
          listHiddenNodes: function listHiddenNodes() {
            return function (i, e, t) {
              var r = this,
                s = m('<ul data-dtr-index="' + e + '" class="dtr-details"/>'),
                o = !1;
              return m.each(t, function (e, t) {
                var n;
                t.hidden && (n = t.className ? 'class="' + t.className + '"' : "", m("<li " + n + ' data-dtr-index="' + t.columnIndex + '" data-dt-row="' + t.rowIndex + '" data-dt-column="' + t.columnIndex + '"><span class="dtr-title">' + t.title + "</span> </li>").append(m('<span class="dtr-data"/>').append(r._childNodes(i, t.rowIndex, t.columnIndex))).appendTo(s), o = !0);
              }), !!o && s;
            };
          },
          listHidden: function listHidden() {
            return function (e, t, n) {
              n = m.map(n, function (e) {
                var t = e.className ? 'class="' + e.className + '"' : "";
                return e.hidden ? "<li " + t + ' data-dtr-index="' + e.columnIndex + '" data-dt-row="' + e.rowIndex + '" data-dt-column="' + e.columnIndex + '"><span class="dtr-title">' + e.title + '</span> <span class="dtr-data">' + e.data + "</span></li>" : "";
              }).join("");
              return !!n && m('<ul data-dtr-index="' + t + '" class="dtr-details"/>').append(n);
            };
          },
          tableAll: function tableAll(i) {
            return i = m.extend({
              tableClass: ""
            }, i), function (e, t, n) {
              n = m.map(n, function (e) {
                return "<tr " + (e.className ? 'class="' + e.className + '"' : "") + ' data-dt-row="' + e.rowIndex + '" data-dt-column="' + e.columnIndex + '"><td>' + e.title + ":</td> <td>" + e.data + "</td></tr>";
              }).join("");
              return m('<table class="' + i.tableClass + ' dtr-details" width="100%"/>').append(n);
            };
          }
        }).listHidden(),
        target: 0,
        type: "inline"
      },
      orthogonal: "display"
    }, m.fn.dataTable.Api);
  return e.register("responsive()", function () {
    return this;
  }), e.register("responsive.index()", function (e) {
    return {
      column: (e = m(e)).data("dtr-index"),
      row: e.parent().data("dtr-index")
    };
  }), e.register("responsive.rebuild()", function () {
    return this.iterator("table", function (e) {
      e._responsive && e._responsive._classLogic();
    });
  }), e.register("responsive.recalc()", function () {
    return this.iterator("table", function (e) {
      e._responsive && (e._responsive._resizeAuto(), e._responsive._resize());
    });
  }), e.register("responsive.hasHidden()", function () {
    var e = this.context[0];
    return !!e._responsive && -1 !== m.inArray(!1, e._responsive._responsiveOnlyHidden());
  }), e.registerPlural("columns().responsiveHidden()", "column().responsiveHidden()", function () {
    return this.iterator("column", function (e, t) {
      return !!e._responsive && e._responsive._responsiveOnlyHidden()[t];
    }, 1);
  }), a.version = "3.0.1", m.fn.dataTable.Responsive = a, m.fn.DataTable.Responsive = a, m(d).on("preInit.dt.dtr", function (e, t, n) {
    "dt" === e.namespace && (m(t.nTable).hasClass("responsive") || m(t.nTable).hasClass("dt-responsive") || t.oInit.responsive || i.defaults.responsive) && !1 !== (e = t.oInit.responsive) && new a(t, m.isPlainObject(e) ? e : {});
  }), i;
});

/*! jQuery UI integration for DataTables' Responsive
 * © SpryMedia Ltd - datatables.net/license
 */

(function (factory) {
  if (typeof define === 'function' && define.amd) {
    // AMD
    define(['jquery', 'datatables.net-jqui', 'datatables.net-responsive'], function ($) {
      return factory($, window, document);
    });
  } else if ((typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object') {
    // CommonJS
    var jq = require('jquery');
    var cjsRequires = function cjsRequires(root, $) {
      if (!$.fn.dataTable) {
        require('datatables.net-jqui')(root, $);
      }
      if (!$.fn.dataTable.Responsive) {
        require('datatables.net-responsive')(root, $);
      }
    };
    if (typeof window === 'undefined') {
      module.exports = function (root, $) {
        if (!root) {
          // CommonJS environments without a window global must pass a
          // root. This will give an error otherwise
          root = window;
        }
        if (!$) {
          $ = jq(root);
        }
        cjsRequires(root, $);
        return factory($, root, root.document);
      };
    } else {
      cjsRequires(window, jq);
      module.exports = factory(jq, window, window.document);
    }
  } else {
    // Browser
    factory(jQuery, window, document);
  }
})(function ($, window, document) {
  'use strict';

  var DataTable = $.fn.dataTable;
  var _display = DataTable.Responsive.display;
  var _original = _display.modal;
  _display.modal = function (options) {
    return function (row, update, render, closeCallback) {
      if (!$.fn.dialog) {
        return _original(row, update, render, closeCallback);
      } else {
        var rendered = render();
        if (rendered === false) {
          return false;
        }
        if (!update) {
          $('<div/>').append(rendered).appendTo('body').dialog($.extend(true, {
            close: closeCallback,
            title: options && options.header ? options.header(row) : '',
            width: 500
          }, options.dialog));
        } else {
          return false;
        }
        return true;
      }
    };
  };
  return DataTable;
});
'use strict';

function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
jQuery(document).ready(function ($) {
  //Mechanics Table
  var staffTable = $('#staff-table').DataTable({
    ajax: {
      url: dashboard_obj.ajaxurl + '?action=get_user_mechanics'
    },
    pagingType: 'simple_numbers',
    columns: [{
      data: 'mechanic_name'
    }, {
      data: 'mechanic_contact_number'
    }, {
      data: 'mechanic_role'
    }, {
      data: 'delete'
    }],
    layout: {
      ordering: true,
      select: true,
      topStart: null,
      topEnd: null,
      bottomEnd: {
        paging: {
          numbers: 3
        }
      }
    },
    language: {
      paginate: {
        first: '',
        last: '',
        next: 'Next',
        previous: 'Prev'
      }
    },
    order: [1, 'asc'],
    responsive: true,
    columnDefs: [{
      responsivePriority: 2,
      targets: 0
    }, {
      responsivePriority: 3,
      targets: 1
    }, {
      responsivePriority: 4,
      targets: 2
    }, {
      responsivePriority: 1,
      targets: 3,
      className: 'actions text-right',
      "render": function render(data, type, row) {
        var actions = '<a href="#" class="delete-staff-member"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.30769 6.36667C4.60508 6.36667 4.84615 6.60545 4.84615 6.9V13.3C4.84615 13.5946 4.60508 13.8333 4.30769 13.8333C4.01031 13.8333 3.76923 13.5946 3.76923 13.3V6.9C3.76923 6.60545 4.01031 6.36667 4.30769 6.36667Z" fill="#7A7A9D"></path><path d="M7 6.36667C7.29738 6.36667 7.53846 6.60545 7.53846 6.9V13.3C7.53846 13.5946 7.29738 13.8333 7 13.8333C6.70262 13.8333 6.46154 13.5946 6.46154 13.3V6.9C6.46154 6.60545 6.70262 6.36667 7 6.36667Z" fill="#7A7A9D"></path><path d="M10.2308 6.9C10.2308 6.60545 9.98969 6.36667 9.69231 6.36667C9.39492 6.36667 9.15385 6.60545 9.15385 6.9V13.3C9.15385 13.5946 9.39492 13.8333 9.69231 13.8333C9.98969 13.8333 10.2308 13.5946 10.2308 13.3V6.9Z" fill="#7A7A9D"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14 3.7C14 4.2891 13.5178 4.76667 12.9231 4.76667H12.3846V14.3667C12.3846 15.5449 11.4203 16.5 10.2308 16.5H3.76923C2.57969 16.5 1.61538 15.5449 1.61538 14.3667V4.76667H1.07692C0.482155 4.76667 0 4.2891 0 3.7V2.63333C0 2.04423 0.482155 1.56667 1.07692 1.56667H4.84615C4.84615 0.977563 5.32831 0.5 5.92308 0.5H8.07692C8.67169 0.5 9.15385 0.977563 9.15385 1.56667H12.9231C13.5178 1.56667 14 2.04423 14 2.63333V3.7ZM2.81942 4.76667L2.69231 4.82962V14.3667C2.69231 14.9558 3.17446 15.4333 3.76923 15.4333H10.2308C10.8255 15.4333 11.3077 14.9558 11.3077 14.3667V4.82962L11.1806 4.76667H2.81942ZM1.07692 3.7V2.63333H12.9231V3.7H1.07692Z" fill="#7A7A9D"></path></svg></a>';
        return actions;
      }
    }],
    createdRow: function createdRow(row, data, index) {},
    drawCallback: function drawCallback(settings) {
      setTimeout(function () {
        if (settings.aoData.length <= settings._iDisplayLength) {
          $('.dt-paging').hide();
        }
      }, 1000);
    }
  });

  // Jobs Table 
  if ($('#jobs-table').length > 0) {
    // Custom filtering function
    var parseDate = function parseDate(dateStr) {
      // Parse date in "d/m/Y" format
      var dateParts = dateStr.split('/');
      if (dateParts.length === 3) {
        // Create a new Date object with (year, month (0-based), day)
        return new Date(dateParts[2], dateParts[1] - 1, dateParts[0]);
      }
      // If the date is invalid, return an Invalid Date object
      return new Date(dateStr);
    };
    var filterByDateRange = function filterByDateRange(days) {
      $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
        var dateStr = data[1]; // Assuming the date is in the second column
        // console.log('Row Date:', dateStr); // Log the date string
        var date = parseDate(dateStr);
        // console.log('Parsed Date:', date); // Log the parsed date
        if (isNaN(date.getTime())) {
          // console.error('Invalid Date:', dateStr);
          return false; // Skip invalid dates
        }
        var now = new Date();
        var diff = (now - date) / (1000 * 60 * 60 * 24); // Difference in days
        // console.log('Date Difference:', diff); // Log the date difference

        if (days == 0) {
          return true;
        } else {
          return diff <= days;
        }
      });
      jobsTable.draw();
      $.fn.dataTable.ext.search.pop();
    }; //Hide/Show Columns
    //Get Job Content Ajax
    var get_job_content = function get_job_content(jobID, row) {
      $.ajax({
        type: "POST",
        url: dashboard_obj.ajaxurl,
        data: {
          'action': 'get_job_content',
          'job_id': jobID
        },
        success: function success(response) {
          row.child(response);
        }
      });
    }; //Get visible row count
    var _countVisibleRows = function _countVisibleRows() {
      var rowCount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;
      console.log(rowCount);
      var tableRows = $('#jobs-table tbody tr td').length && rowCount === undefined ? $('#jobs-table tbody tr').length : rowCount;
      $('#jobs-table_wrapper > .dt-layout-row:last-child .row-count .showing').text(tableRows);
    };
    var isHomeDashboard = $('body').hasClass('home') ? true : false;
    var pageLength = isHomeDashboard ? 5 : 20;
    var jobsTable = $('#jobs-table').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_all_jobs'
      },
      pageLength: pageLength,
      pagingType: 'simple_numbers',
      columns: [{
        data: 'name'
      }, {
        data: 'date'
      }, {
        data: 'job_no'
      }, {
        data: 'vehicle'
      }, {
        data: 'registration'
      }, {
        data: 'status'
      }, {
        data: 'notes'
      }, {
        data: 'total'
      }, {
        data: 'actions'
      }],
      order: [1, 'desc'],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: isHomeDashboard ? null : {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        info: isHomeDashboard ? '<div class="text-right"><a class="view-btn" href="jobs/">View all</a></div>' : "Showing _START_ to _END_ of _TOTAL_ results found",
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      columnDefs: [{
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 3,
        targets: 1
      }, {
        responsivePriority: 4,
        targets: 2
      }, {
        responsivePriority: 5,
        targets: 3
      }, {
        responsivePriority: 6,
        targets: 4
      }, {
        responsivePriority: 7,
        targets: 5
      }, {
        responsivePriority: 8,
        targets: 6
      }, {
        responsivePriority: 9,
        targets: 7
      }, {
        responsivePriority: 1,
        targets: 8,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a href="/workshoppro/jobs/add-job?edit=' + row['job_post_id'] + '" class="edit-customer-action mt-1 mr-2">Edit</a>';
          actions += '<div class="action-wrap">';
          actions += '<div class="action-btn" data-id="' + row['job_post_id'] + '"><span></span><span></span><span></span></div>';
          actions += '<ul style="display:none;">';
          actions += '<li><a href="#" data-delete-post="' + row['job_post_id'] + '">Delete</a></li>';
          // actions += '<li><a href="#">Send Quote</a></li>'; 
          // actions += '<li><a href="#">Send Invoice</a></li>'; 
          actions += '</ul>';
          actions += '</div>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        $(row).addClass('post-id-' + data.job_post_id);
      },
      drawCallback: function drawCallback(settings) {
        setTimeout(function () {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }, 1000);
      }
    });

    // Filter Status
    $(document).on('click', '.table-filters .job-status span', function () {
      //Selected option
      $('.select-wrapper.job-status > .value').text($(this).text());

      //Selected value
      var filterValue = $(this).data('value') !== "all" ? $(this).data('value') : "";
      // console.log(filterValue);
      jobsTable.columns(5).search(filterValue).draw();
      // $(this).closest('.select-wrapper').removeClass('active')

      //Count Rows
      var allRows = $('#jobs-table tbody > tr:not([style="display: none;"])');
      var rowCount = 0;
      for (var i = 0; i < allRows.length; i++) {
        $(allRows[i]).find('.dt-empty').length == 0 && rowCount++;
      }
      _countVisibleRows(rowCount);
    });
    $('.select-wrapper.date-range .options > span').on('click', function () {
      //Selected option
      $('.select-wrapper.date-range .selected > .value').text($(this).text()).addClass('selected-active');
      var value = $(this).data('value');
      filterByDateRange(value);
    });
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = jobsTable.column(columnNo);

      // Toggle the visibility
      column.visible(!column.visible());
    });

    //Search Tables
    $(document).on('keyup', '.table-filters input.search', function () {
      var searchValue = $(this).val();
      jobsTable.search(searchValue).draw();
      //Count Rows
      // let allRows = $('#jobs-table tbody > tr:not([style="display: none;"])')
      // let rowCount = 0
      // for (let i = 0; i < allRows.length; i++) {
      //     $(allRows[i]).find('.dt-empty').length == 0 && rowCount++
      // }

      // countVisibleRows(rowCount)
    });

    //Expand/Collapse Job Extra Info
    $(document).on('click', '#jobs-table tbody tr td:not(.actions):not([colspan="9"])', function () {
      var jobID = $(this).closest('tr').find('.action-btn').data('id');
      var tr = $(this);
      var row = jobsTable.row(tr);
      $(this).closest('tr').css('background-color', "#f7fafc");
      if (row.child.isShown()) {
        row.child.hide();
        tr.removeClass('shown');
        $(this).closest('tr').css('background-color', "#ffffff");
      } else {
        // Open row.
        get_job_content(jobID, row);
        row.child('<span class="loading" >Loading...</span>').show();
      }
    });
  }

  // Jobs Table 
  if ($('#customer-jobs-table').length > 0) {
    var customerID = $('input#customer-post-id').val().length > 0 ? $('input#customer-post-id').val() : "";
    var jobsTable = $('#customer-jobs-table').DataTable(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_customer_jobs',
        data: {
          'customer-id': customerID
        }
      },
      pageLength: 7,
      pagingType: 'simple_numbers',
      columns: [{
        data: 'name'
      }, {
        data: 'date'
      }, {
        data: 'job_no'
      }, {
        data: 'vehicle'
      }, {
        data: 'registration'
      }, {
        data: 'status'
      }, {
        data: 'notes'
      }, {
        data: 'total'
      }, {
        data: 'actions'
      }],
      order: [0, 'desc'],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      }
    }, "order", [1, 'desc']), "responsive", true), "columnDefs", [{
      responsivePriority: 2,
      targets: 0
    }, {
      responsivePriority: 3,
      targets: 1
    }, {
      responsivePriority: 4,
      targets: 2
    }, {
      responsivePriority: 5,
      targets: 3
    }, {
      responsivePriority: 6,
      targets: 4
    }, {
      responsivePriority: 7,
      targets: 5
    }, {
      responsivePriority: 8,
      targets: 6
    }, {
      responsivePriority: 9,
      targets: 7
    }, {
      responsivePriority: 1,
      targets: 8,
      className: 'actions',
      "render": function render(data, type, row) {
        var actions = '';
        actions += '<div class="d-flex flex-align-center justified-end">';
        actions += '<a href="/workshoppro/jobs/add-job?edit=' + row['job_post_id'] + '" class="edit-customer-action mr-2">Edit</a>';
        actions += '<a href="#" data-delete-post="' + row['job_post_id'] + '">Delete</a>';
        actions += '</div>';
        return actions;
      }
    }]), "createdRow", function createdRow(row, data, index) {
      console.log(data);
      $(row).addClass('post-id-' + data.job_post_id);
    }), "drawCallback", function drawCallback(settings) {
      setTimeout(function () {
        if (settings.aoData.length <= 20) {
          $('.dt-paging').hide();
        }
      }, 1000);
    }));
  }
  ;

  // Vehicle Table 
  if ($('#vehicleTable').length > 0) {
    var vehicleTable = $('#vehicleTable').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_user_vehicles'
      },
      pagingType: 'simple_numbers',
      columns: [{
        data: 'customer'
      }, {
        data: 'make'
      }, {
        data: 'model'
      }, {
        data: 'registration'
      }, {
        data: 'vin'
      }, {
        data: 'actions'
      }],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      order: [0, 'asc'],
      responsive: true,
      columnDefs: [{
        targets: '_all',
        width: "16.666%"
      }, {
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 2,
        targets: 1
      }, {
        responsivePriority: 3,
        targets: 2
      }, {
        responsivePriority: 4,
        targets: 3
      }, {
        responsivePriority: 5,
        targets: 4
      }, {
        responsivePriority: 1,
        targets: 5,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a href="#" data-popup="add-vehicle-popup" class="popup-btn edit-vehicle-action mt-1 mr-2">Edit</a>';
          actions += '<div class="action-wrap">';
          actions += '<div class="action-btn" data-id="' + row['vehicle_post_id'] + '"><span></span><span></span><span></span></div>';
          actions += '<ul style="display:none;">';
          actions += '<li><a href="#" data-delete-post="' + row['vehicle_post_id'] + '" data-delete-vehicle="' + row['vehicle_post_id'] + '">Delete</a></li>';
          actions += '</ul>';
          actions += '</div>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        console.log(data, row);
        $(row).addClass('post-id-' + data['vehicle_post_id']);
      },
      drawCallback: function drawCallback(settings) {
        setTimeout(function () {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }, 1000);
      }
    });

    //Hide/Show Columns
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = vehicleTable.column(columnNo);

      // Toggle the visibility
      column.visible(!column.visible());
    });

    // Customer Search Tables
    $(document).on('keyup', '.table-filters input.search', function () {
      var searchValue = $(this).val();
      vehicleTable.search(searchValue).draw();
      //Count Rows
      var allRows = $('#jobs-table tbody > tr:not([style="display: none;"])');
      var rowCount = 0;
      for (var i = 0; i < allRows.length; i++) {
        $(allRows[i]).find('.dt-empty').length == 0 && rowCount++;
      }
      countVisibleRows(rowCount);
    });
  }

  // Customer Table 
  if ($('#customerTable').length > 0) {
    var customerTable = $('#customerTable').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_user_customers'
      },
      pagingType: 'simple_numbers',
      columns: [{
        data: 'customer_name'
      }, {
        data: 'customer_contact'
      }, {
        data: 'customer_email'
      }, {
        data: 'customer_vehicle'
      }, {
        data: 'customer_address'
      }, {
        data: 'actions'
      }],
      layout: {
        ordering: false,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      responsive: true,
      order: [0, 'asc'],
      columnDefs: [{
        targets: '_all',
        width: "16.666%"
      }, {
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 2,
        targets: 1
      }, {
        responsivePriority: 3,
        targets: 2
      }, {
        responsivePriority: 4,
        targets: 3
      }, {
        responsivePriority: 5,
        targets: 4
      }, {
        responsivePriority: 1,
        targets: 5,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a href=/workshoppro/customers/add-customer/?edit=' + row['customer_post_id'] + ' class="edit-customer-action mt-1 mr-2">Edit</a>';
          actions += '<div class="action-wrap">';
          actions += '<div class="action-btn" data-id="' + row['customer_post_id'] + '"><span></span><span></span><span></span></div>';
          actions += '<ul style="display:none;">';
          actions += '<li><a href="#" data-delete-post="' + row['customer_post_id'] + '">Delete</a></li>';
          actions += '</ul>';
          actions += '</div>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        console.log(data);
        $(row).addClass('post-id-' + data.customer_post_id);
      },
      drawCallback: function drawCallback(settings) {
        if (settings.aoData.length) {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }
      }
    });
    //Hide/Show Columns 
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = customerTable.column(columnNo);
      // Toggle the visibility 
      column.visible(!column.visible());
    });

    // Customer Search Tables
    $(document).on('keyup', '.table-filters input.search', function () {
      var searchValue = $(this).val();
      customerTable.search(searchValue).draw();
      //Count Rows
      var allRows = $('#jobs-table tbody > tr:not([style="display: none;"])');
      var rowCount = 0;
      for (var i = 0; i < allRows.length; i++) {
        $(allRows[i]).find('.dt-empty').length == 0 && rowCount++;
      }
      countVisibleRows(rowCount);
    });
  }

  // Customer Vehicle Table 
  if ($('#customerVehicleTable').length > 0) {
    var _customerID = $('input#customer-post-id').val();
    var customerTable = $('#customerVehicleTable').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_customer_vehicles',
        data: {
          'customer-id': _customerID
        }
      },
      pagingType: 'simple_numbers',
      columns: [{
        data: 'make'
      }, {
        data: 'model'
      }, {
        data: 'registration'
      }, {
        data: 'vin'
      }, {
        data: 'actions'
      }],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      order: [1, 'asc'],
      responsive: true,
      columnDefs: [{
        targets: '_all',
        width: "16.666%"
      }, {
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 2,
        targets: 1
      }, {
        responsivePriority: 3,
        targets: 2
      }, {
        responsivePriority: 4,
        targets: 3
      }, {
        responsivePriority: 5,
        targets: 4
      }, {
        responsivePriority: 1,
        targets: 4,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a href="#" data-popup="add-vehicle-popup" class="popup-btn edit-vehicle-action mr-2">Edit</a>';
          actions += '<a href="#" data-delete-post="' + row['vehicle_post_id'] + '">Delete</a>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        // console.log("Custoemr",data,row);
        $(row).addClass('post-id-' + data.vehicle_post_id);
      },
      initComplete: function initComplete(settings, json) {
        // Extract data from the received JSON
        // $(row).addClass('post-id-'+row.vehicle_post_id);
        var rowData = [];
        for (var vehicleID in json.data) {
          if (json.data.hasOwnProperty(vehicleID)) {
            var vehicleData = json.data[vehicleID];
            rowData.push({
              'vehicle_post_id': vehicleData.customer_vehicle_id,
              'make': vehicleData.make,
              'model': vehicleData.model,
              'registration': vehicleData.registration,
              'vin': vehicleData.vin,
              'actions': vehicleData.actions
            });
          }
        }
        // Set the data for the DataTable
        this.api().clear().rows.add(rowData).draw();
      },
      drawCallback: function drawCallback(settings) {
        if (settings.aoData.length) {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }
      }
    });

    //Hide/Show Columns 
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = customerTable.column(columnNo);
      // Toggle the visibility 
      column.visible(!column.visible());
    });
  }

  // Invoices Table 
  if ($('#invoicesTable').length > 0) {
    var invoiceTable = $('#invoicesTable').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_user_invoices'
      },
      pagingType: 'simple_numbers',
      columns: [{
        data: 'invoice_no'
      }, {
        data: 'customer'
      }, {
        data: 'date'
      }, {
        data: 'amount'
      }, {
        data: 'status'
      }, {
        data: 'actions'
      }, {
        data: 'invoice_url'
      }],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      order: [2, 'asc'],
      responsive: true,
      columnDefs: [{
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 2,
        targets: 1
      }, {
        responsivePriority: 3,
        targets: 2
      }, {
        responsivePriority: 4,
        targets: 3
      }, {
        responsivePriority: 5,
        targets: 4
      }, {
        responsivePriority: 1,
        targets: 5,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a class="mt-1 mr-2" href="' + row['invoice_url'] + '" target="_blank" >Print</a>';
          actions += '<div class="action-wrap">';
          actions += '<div class="action-btn" data-id="' + row['invoice_post_id'] + '"><span></span><span></span><span></span></div>';
          actions += '<ul style="display:none;">';
          actions += '';
          actions += '<li><a href="/workshoppro/jobs/add-job?edit=' + row['invoice_post_id'] + '" >Edit</a></li>';
          actions += '</ul>';
          actions += '</div>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        $(row).addClass('post-id-' + data.invoice_post_id);
      },
      drawCallback: function drawCallback(settings) {
        setTimeout(function () {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }, 1000);
      }
    });

    //Hide/Show Columns
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = invoiceTable.column(columnNo);

      // Toggle the visibility
      column.visible(!column.visible());
    });
  }

  // Quotes Table  
  if ($('#quotesTable').length > 0) {
    var quotesTable = $('#quotesTable').DataTable({
      ajax: {
        url: dashboard_obj.ajaxurl + '?action=get_user_quotes'
      },
      pagingType: 'simple_numbers',
      columns: [{
        data: 'quote_no'
      }, {
        data: 'customer'
      }, {
        data: 'date'
      }, {
        data: 'amount'
      }, {
        data: 'status'
      }, {
        data: 'actions'
      }, {
        data: 'quote_url'
      }],
      layout: {
        ordering: true,
        select: true,
        topStart: null,
        topEnd: null,
        bottomEnd: {
          paging: {
            numbers: 3
          }
        }
      },
      language: {
        paginate: {
          first: '',
          last: '',
          next: 'Next',
          previous: 'Prev'
        }
      },
      order: [2, 'asc'],
      responsive: true,
      columnDefs: [{
        responsivePriority: 2,
        targets: 0
      }, {
        responsivePriority: 2,
        targets: 1
      }, {
        responsivePriority: 3,
        targets: 2
      }, {
        responsivePriority: 4,
        targets: 3
      }, {
        responsivePriority: 5,
        targets: 4
      }, {
        responsivePriority: 1,
        targets: 5,
        className: 'actions',
        "render": function render(data, type, row) {
          var actions = '';
          actions += '<div class="d-flex flex-align-center justified-end">';
          actions += '<a class="mt-1 mr-2" href="' + row['quote_url'] + '" target="_blank" >Print</a>';
          actions += '<div class="action-wrap">';
          actions += '<div class="action-btn" data-id="' + row['quote_post_id'] + '"><span></span><span></span><span></span></div>';
          actions += '<ul style="display:none;">';
          actions += '';
          actions += '<li><a href="/workshoppro/jobs/add-job?edit=' + row['quote_post_id'] + '" >Edit</a></li>';
          actions += '</ul>';
          actions += '</div>';
          actions += '</div>';
          return actions;
        }
      }],
      createdRow: function createdRow(row, data, index) {
        $(row).addClass('post-id-' + data.quote_post_id);
        console.log('row: ', row);
        console.log('data: ', data);
      },
      drawCallback: function drawCallback(settings) {
        setTimeout(function () {
          if (settings.aoData.length <= settings._iDisplayLength) {
            $('.dt-paging').hide();
          }
        }, 1000);
      }
    });

    //Hide/Show Columns
    $(document).on('click', '.table-filters .column-states input', function () {
      var columnNo = $(this).attr('value');
      var column = quotesTable.column(columnNo);

      // Toggle the visibility
      column.visible(!column.visible());
    });
  }

  //Hide datatable columns
  if ($('.column-states').length > 0) {
    var colStateVis = true;
    $(document).on('click', '.hide-columns', function () {
      if (colStateVis) {
        $(this).closest('.table-filters').find('.column-states').fadeOut();
        colStateVis = false;
      } else {
        $(this).closest('.table-filters').find('.column-states').fadeIn();
        colStateVis = true;
      }
    });
  }

  //Drop down open
  $(document).on('click', '.select-wrapper:not(.active)', function (e) {
    $(this).closest('.select-wrapper').addClass('active');
  });
  $(document).on('click', '.select-wrapper.active', function (e) {
    $(this).closest('.select-wrapper').removeClass('active');
  });
  // click anywhere then remove active from select-wrapper 
  $(document).on('click', function (e) {
    if (!$(e.target).closest('.select-wrapper').length) {
      $('.select-wrapper').removeClass('active');
    }
  });

  //Actions popup 
  var actionOpen = false;
  $(document).on('click', 'table tbody td.actions .action-btn', function () {
    if (!actionOpen) {
      $(this).addClass('active').closest('.actions').find('ul').fadeIn();
      actionOpen = true;
    } else {
      $('table tbody td.actions').find('ul').fadeOut();
      $(this).removeClass('active');
      actionOpen = false;
    }
  });

  // click anywhere except action-btn then remove active from action-btn
  $(document).on('click', function (e) {
    if (!$(e.target).closest('.action-btn').length) {
      $('table tbody td.actions').find('ul').fadeOut();
      $('table tbody td.actions .action-btn').removeClass('active');
      actionOpen = false;
    }
  });
  if ($('td.dt-empty').length > 0) {
    $('td.dt-empty').attr('colspan', '100%');
  }
});
"use strict";

function validateFormSubmit(excludedForm) {
  var valid = true;
  var requiredInputs = Array.from(document.querySelectorAll('form:not(' + excludedForm + ') input.required'));

  // document.querySelector('input[type="hidden"][name="vehicle-data"]') && requiredInputs.push(document.querySelector('input[type="hidden"][name="vehicle-data"]'))
  // document.querySelector('input[type="hidden"][name="customer-data"]') && requiredInputs.push(document.querySelector('input[type="hidden"][name="customer-data"]'))

  var i = 0;
  requiredInputs.forEach(function (input) {
    if (input.value.length === 0) {
      removeErrorMessage(input);
      addErrorMessage(input, 'This field is required');
      if (i === 0) {
        input.focus();
        i++;
      }
      valid = false;
    } else {
      removeErrorMessage(input);
    }
  });
  return valid;
}

// Validate required input
function validateInput(ele) {
  var self = ele.length > 0 ? ele[0] : this;
  if (self.value.length === 0) {
    removeErrorMessage(self);
    addErrorMessage(self, 'This field is required');
  } else {
    removeErrorMessage(self);
  }
}

// Validate number input 
function validateNumberInput() {
  if (isNaN(this.valueAsNumber)) {
    removeErrorMessage(this);
    addErrorMessage(this, 'Please enter a valid number');
  } else {
    removeErrorMessage(this);
  }
}

// Validate email input
function validateEmailInput() {
  var email = this.value;
  var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
  if (!email.match(emailPattern) && email.length > 0) {
    removeErrorMessage(this);
    addErrorMessage(this, 'Please enter a valid email address');
  } else {
    removeErrorMessage(this);
  }
}

// Validate phone input 
function validatePhoneInput() {
  var phone = this.value;
  var phonePattern = /^\d{10}$/;
  if (!phone.match(phonePattern) && phone.length > 0) {
    removeErrorMessage(this);
    addErrorMessage(this, 'Please enter a valid phone number');
  } else {
    removeErrorMessage(this);
  }
}

// Validate Whatsapp input  
function validateWhatsappInput() {
  var whatsapp = this.value;
  var whatsappPattern = /\+\d{3}[ ]?(\d+(-| )?)+/;
  if (!whatsapp.match(whatsappPattern) && whatsapp.length > 0) {
    removeErrorMessage(this);
    addErrorMessage(this, 'Please enter a valid whatsapp number');
  } else {
    removeErrorMessage(this);
  }
}

// Validate VIN 
function validateVIN() {
  var vin = this.value;
  var vinPattern = new RegExp("^[A-HJ-NPR-Z\\d]{8}[\\dX][A-HJ-NPR-Z\\d]{2}\\d{6}$");
  if (!vin.match(vinPattern) && vin.length > 0) {
    removeErrorMessage(this);
    addErrorMessage(this, 'Please enter a valid VIN');
  } else {
    removeErrorMessage(this);
  }
}

// Add error message to input field 
function addErrorMessage(input, message) {
  message = message || 'This field is required';
  input.classList.add('error');
  var inputWrapper = input.closest('.input-label-wrapper');
  inputWrapper.insertAdjacentHTML('beforeend', '<span class="error-message">' + message + '</span>');
}

// Remove error message from input field 
function removeErrorMessage(input) {
  input.classList.remove('error');
  var inputWrapper = input.closest('.input-label-wrapper');
  var errorMessage = inputWrapper.querySelector('.error-message');
  if (errorMessage) {
    inputWrapper.removeChild(errorMessage);
  }
}

// Validate input on change and keyup 
document.addEventListener('DOMContentLoaded', function () {
  // Validate form required inputs
  var requiredInputs = document.querySelectorAll('input.required');
  requiredInputs.forEach(function (input) {
    input.addEventListener('change', validateInput);
  });

  // Validate number input
  var numberInputs = document.querySelectorAll('input[type="number"]');
  numberInputs.forEach(function (input) {
    input.addEventListener('change', validateNumberInput);
  });

  // Validate Email input
  var emailInputs = document.querySelectorAll('input[type="email"]');
  emailInputs.forEach(function (input) {
    input.addEventListener('change', validateEmailInput);
  });

  // Validate Phone input 
  var phoneInputs = document.querySelectorAll('input[type="tel"]');
  phoneInputs.forEach(function (input) {
    input.addEventListener('change', validatePhoneInput);
  });

  // Validate Whatsapp input
  var whatsappInputs = document.querySelectorAll('input.whatsapp');
  whatsappInputs.forEach(function (input) {
    input.addEventListener('change', validateWhatsappInput);
  });

  // Validate VIN input
  var vinInputs = document.querySelectorAll('input[name="vin"]');
  vinInputs.forEach(function (input) {
    input.addEventListener('change', validateVIN);
  });
});

// function validateFormSubmit(excludedSelectors = []) {
//     let valid = true;

//     // Construct the excluded selectors string
//     let excludedSelectorString = '';
//     if (excludedSelectors.length > 0) {
//         excludedSelectorString = excludedSelectors.map(selector => `:not(${selector})`).join('');
//     }

//     // Get all required input fields excluding the specified parent classes and IDs
//     let requiredInputs = document.querySelectorAll(`${excludedSelectorString} input.required`);
//     // input:not(#add-vehicle-form input.required) 

//     console.log(requiredInputs)

//     requiredInputs.forEach(function(input) {
//         if (input.value.trim() === '') {
//             removeErrorMessage(input);
//             addErrorMessage(input, 'This field is required');
//             valid = false;
//         } else {
//             removeErrorMessage(input);
//         }
//     });

//     return valid;
// }
'use strict';

jQuery(document).ready(function ($) {
  //Make sidebar collapsed by default on tablet/mobile
  if (window.innerWidth < 992) {
    $('body').addClass('menu-closed');
  }

  //Change date format to dd-mm-yy when selecting date
  if ($("input[type=\"date\"]").length > 0) {
    $(document).on('change', ".wm-date-picker", function () {
      var mmddyyVal = new Date($(this).val());
      var newDateFormat = mmddyyVal.toLocaleDateString('en-GB', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
      });

      // $(this).closest('.input-label-wrapper').find('input[type="text"]').focus()
      $(this).closest('.input-label-wrapper').find('input[type="text"]').val(newDateFormat);
      validateInput($(this).closest('.input-label-wrapper').find('input[type="text"]'));
    });
  }

  //Unsaved changes warning
  if ($('input[name="content-changed"]').length > 0) {
    var pageChanged = function pageChanged() {
      $("#job-status").val("draft");
      $(".controls .select-wrapper.job-status .selected .control-status").text("Draft");
      $(".controls .job-send").attr("data-state", "quote-sent");
      $(".controls .select-wrapper.job-status .selected .control-status").closest(".control-fields").find(".job-send").text("Send Quote");
      $('input[name="content-changed"]').prop('checked', true);
    };
    //Check if page has changed before navigating away
    var navURL;
    $(document).on('click', 'a:not([target="_blank"]):not(.save-changes-button, [data-popup="add-vehicle-popup"])', function (e) {
      navURL = $(e.target).closest('a:not([target="_blank"])').attr('href');
      if ($('input[name="content-changed"]').prop('checked')) {
        e.preventDefault();
        $('.alert-popup-outer.unsaved').fadeIn();
      }
    });

    //Accept/Reject event leave page popup
    $(document).on('click', '.alert-popup-outer.unsaved button', function (e) {
      if ($(this).attr('value') !== 'false' && navURL.length > 0) {
        $('.alert-popup-outer.unsaved').fadeOut(function () {
          window.location.href = navURL;
        });
      } else {
        $('.alert-popup-outer.unsaved').fadeOut();
      }
    });

    //Close error popup
    $(document).on('click', '.alert-popup-outer.error button', function (e) {
      $('.alert-popup-outer.error').fadeOut();
    });
    $(document).on('keyup', 'input', pageChanged);
    $(document).on('change', '#attachment', pageChanged);
    $(document).on('click', '.delete', pageChanged);
  }

  //Toggle Sidebar View
  $(document).on('click', '#burger-menu svg, .mobile-close, .mobile-overlay', function () {
    $('body').toggleClass('menu-closed');
  });

  // Mobi search 
  $(document).on('click', '.mobi-search-icon', function () {
    $('.mobi-search').toggleClass('show');
    if ($('.mobi-search').hasClass('show')) {
      $('.mobi-search-input').slideDown('slow');
    } else {
      $('.mobi-search-input').slideUp('slow');
    }
  });

  // Check if system is dark mode (currently set colors to light if it is)
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    // Dark mode is preferred
    document.documentElement.style.setProperty('--accent', '#009026');
    document.documentElement.style.setProperty('--heading', '#27272E');
    document.documentElement.style.setProperty('--body', '#425466');
    document.documentElement.style.setProperty('--muted', '#7A7A9D');
    document.documentElement.style.setProperty('--background-secondary', '#ffffff');
    document.documentElement.style.setProperty('--background-primary', '#F7FAFC');
  }

  //Add Labour Form Row
  $(document).on('click', '.labour-container .add-row-button', function (e) {
    var rowCount = $('#job-fields').children().length;
    var jobRow = "<div class=\"form-row\" >\n                            <div class=\"input-label-wrapper labour-name-wrapper\" >\n                                <label for=\"labour-name\" >Labour Name</label>\n                                <input type=\"text\" class=\"labour-name\" name=\"labour-name\" >\n                            </div>\n                                <div class=\"input-label-wrapper description-wrapper\" >\n                                <label for=\"description\" >Description</label>\n                                <input type=\"text\" class=\"description\" name=\"description\" >\n                            </div>\n                                <div class=\"input-label-wrapper unit-price-wrapper\" >\n                                <label for=\"unit-price\" >Unit price </label>\n                                <input type=\"number\" class=\"unit-price\" name=\"unit-price\" value=\"".concat($('#hourly-labour-rate').val(), "\" >\n                            </div>\n                                <div class=\"input-label-wrapper quantity-wrapper\" >\n                                <label for=\"qty\" >Quantity</label>\n                                <input type=\"number\" class=\"qty\" name=\"qty\" value=\"1\" >\n                            </div>\n                                <div class=\"input-label-wrapper vat-wrapper\" >\n                                <label for=\"vat\" >Vat </label>\n                                <input type=\"number\" class=\"vat\" name=\"vat\" value=\"").concat($('#hourly-labour-rate').val() / 100 * $('#vat-rate').val(), "\" >\n                            </div>\n                                <div class=\"input-label-wrapper line-total-wrapper\" >\n                                <label for=\"line-total\" >Line Total </label>\n                                <input type=\"number\" class=\"line-total\" name=\"line-total\" >\n                            </div>\n                            <div class=\"input-label-wrapper delete-row\" >\n                                <svg width=\"14\" height=\"17\" viewBox=\"0 0 14 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M4.30769 6.36667C4.60508 6.36667 4.84615 6.60545 4.84615 6.9V13.3C4.84615 13.5946 4.60508 13.8333 4.30769 13.8333C4.01031 13.8333 3.76923 13.5946 3.76923 13.3V6.9C3.76923 6.60545 4.01031 6.36667 4.30769 6.36667Z\" fill=\"#7A7A9D\"/>\n                                    <path d=\"M7 6.36667C7.29738 6.36667 7.53846 6.60545 7.53846 6.9V13.3C7.53846 13.5946 7.29738 13.8333 7 13.8333C6.70262 13.8333 6.46154 13.5946 6.46154 13.3V6.9C6.46154 6.60545 6.70262 6.36667 7 6.36667Z\" fill=\"#7A7A9D\"/>\n                                    <path d=\"M10.2308 6.9C10.2308 6.60545 9.98969 6.36667 9.69231 6.36667C9.39492 6.36667 9.15385 6.60545 9.15385 6.9V13.3C9.15385 13.5946 9.39492 13.8333 9.69231 13.8333C9.98969 13.8333 10.2308 13.5946 10.2308 13.3V6.9Z\" fill=\"#7A7A9D\"/>\n                                    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 3.7C14 4.2891 13.5178 4.76667 12.9231 4.76667H12.3846V14.3667C12.3846 15.5449 11.4203 16.5 10.2308 16.5H3.76923C2.57969 16.5 1.61538 15.5449 1.61538 14.3667V4.76667H1.07692C0.482155 4.76667 0 4.2891 0 3.7V2.63333C0 2.04423 0.482155 1.56667 1.07692 1.56667H4.84615C4.84615 0.977563 5.32831 0.5 5.92308 0.5H8.07692C8.67169 0.5 9.15385 0.977563 9.15385 1.56667H12.9231C13.5178 1.56667 14 2.04423 14 2.63333V3.7ZM2.81942 4.76667L2.69231 4.82962V14.3667C2.69231 14.9558 3.17446 15.4333 3.76923 15.4333H10.2308C10.8255 15.4333 11.3077 14.9558 11.3077 14.3667V4.82962L11.1806 4.76667H2.81942ZM1.07692 3.7V2.63333H12.9231V3.7H1.07692Z\" fill=\"#7A7A9D\"/>\n                                </svg>\n                            </div>\n                        </div>");
    var appendedRow = $('#job-fields').append(jobRow);
    appendedRow.find(".unit-price").trigger("change");
    $(document).on('change', '#job-fields .quantity-wrapper input, #job-fields .unit-price-wrapper input, #job-fields .vat-wrapper input', calculateLineTotal);
  });

  //Add Parts Form Row
  $(document).on('click', '.parts-container .add-row-button', function (e) {
    var rowCount = $('#parts-fields').children().length;
    var jobRow = "<div class=\"form-row\" >\n                            <div class=\"input-label-wrapper part-name-wrapper\" >\n                                <label for=\"part-name\" >Part Name</label>\n                                <input type=\"text\" class=\"part-name\" name=\"part-name\" >\n                            </div>\n                            <div class=\"input-label-wrapper warranty-wrapper\" >\n                                <label for=\"warranty\" >Warranty</label>\n                                <input type=\"text\" class=\"warranty\" name=\"warranty\" >\n                            </div>\n                            <div class=\"input-label-wrapper cost-price-wrapper\" >\n                                <label for=\"cost-price\" >Cost Price</label>\n                                <input type=\"number\" class=\"cost-price\" name=\"cost-price\" >\n                            </div>\n                            <div class=\"input-label-wrapper markup-wrapper\" >\n                                <label for=\"markup\" >Markup (%)</label>\n                                <input type=\"number\" class=\"markup\" name=\"markup\" value=\"".concat($('#markup-percentage').val(), "\" >\n                            </div>\n                            <div class=\"input-label-wrapper unit-price-wrapper\" >\n                                <label for=\"unit-price\" >Unit price</label>\n                                <input type=\"number\" class=\"unit-price\" name=\"unit-price\" >\n                            </div>\n                            <div class=\"input-label-wrapper quantity-wrapper\" >\n                                <label for=\"qty\" >Qty</label>\n                                <input type=\"number\" class=\"qty\" name=\"qty\" value=\"1\" >\n                            </div>\n                            <div class=\"input-label-wrapper vat-wrapper\" >\n                                <label for=\"vat\" >Vat</label>\n                                <input type=\"number\" class=\"vat\" name=\"vat\" >\n                            </div>\n                            <div class=\"input-label-wrapper line-total-wrapper\" >\n                                <label for=\"line-total\" >Line Total</label>\n                                <input type=\"number\" class=\"line-total\" name=\"line-total\" >\n                            </div>\n                            <div class=\"input-label-wrapper delete-row\" >\n                                <svg width=\"14\" height=\"17\" viewBox=\"0 0 14 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                <path d=\"M4.30769 6.36667C4.60508 6.36667 4.84615 6.60545 4.84615 6.9V13.3C4.84615 13.5946 4.60508 13.8333 4.30769 13.8333C4.01031 13.8333 3.76923 13.5946 3.76923 13.3V6.9C3.76923 6.60545 4.01031 6.36667 4.30769 6.36667Z\" fill=\"#7A7A9D\"/>\n                                <path d=\"M7 6.36667C7.29738 6.36667 7.53846 6.60545 7.53846 6.9V13.3C7.53846 13.5946 7.29738 13.8333 7 13.8333C6.70262 13.8333 6.46154 13.5946 6.46154 13.3V6.9C6.46154 6.60545 6.70262 6.36667 7 6.36667Z\" fill=\"#7A7A9D\"/>\n                                <path d=\"M10.2308 6.9C10.2308 6.60545 9.98969 6.36667 9.69231 6.36667C9.39492 6.36667 9.15385 6.60545 9.15385 6.9V13.3C9.15385 13.5946 9.39492 13.8333 9.69231 13.8333C9.98969 13.8333 10.2308 13.5946 10.2308 13.3V6.9Z\" fill=\"#7A7A9D\"/>\n                                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 3.7C14 4.2891 13.5178 4.76667 12.9231 4.76667H12.3846V14.3667C12.3846 15.5449 11.4203 16.5 10.2308 16.5H3.76923C2.57969 16.5 1.61538 15.5449 1.61538 14.3667V4.76667H1.07692C0.482155 4.76667 0 4.2891 0 3.7V2.63333C0 2.04423 0.482155 1.56667 1.07692 1.56667H4.84615C4.84615 0.977563 5.32831 0.5 5.92308 0.5H8.07692C8.67169 0.5 9.15385 0.977563 9.15385 1.56667H12.9231C13.5178 1.56667 14 2.04423 14 2.63333V3.7ZM2.81942 4.76667L2.69231 4.82962V14.3667C2.69231 14.9558 3.17446 15.4333 3.76923 15.4333H10.2308C10.8255 15.4333 11.3077 14.9558 11.3077 14.3667V4.82962L11.1806 4.76667H2.81942ZM1.07692 3.7V2.63333H12.9231V3.7H1.07692Z\" fill=\"#7A7A9D\"/>\n                                </svg>\n                            </div>\n                        </div>");
    var appendedRow = $('#parts-fields').append(jobRow);
    appendedRow.find(".unit-price").trigger("change");
    $(document).on('change', '#parts-fields .quantity-wrapper input, #parts-fields .vat-wrapper input', calculateLineTotal);
  });

  //Update part unit price based on cost & markup
  if ($(".parts-container .cost-price-wrapper .cost-price").length > 0) {
    $(document).on("change", ".parts-container .cost-price-wrapper .cost-price, .parts-container .markup-wrapper .markup", function () {
      var costPrice = Number($(this).closest(".form-row").find(".cost-price").val());
      var markup = Number($(this).closest(".form-row").find(".markup").val());
      var unitPrice = costPrice / 100 * markup + costPrice;
      console.log(unitPrice);
      $(this).closest(".form-row").find(".unit-price").val(unitPrice.toFixed(2));
      $(this).closest(".form-row").find(".unit-price").trigger("change");
    });
  }

  //Delete form row & trigger input change to update calculations
  $(document).on('click', '.delete-row', function (e) {
    var form = $(this).closest('form');
    $(this).closest('.form-row').remove();
    form.find('.form-row:first-child .quantity-wrapper input').change();
    if (form.children().length === 0) {
      form.closest('.section').find('.sub-total-outer > p > .value').text('R0.00');
      updateTotalCosts('.section.labour-container', '.section.parts-container');
    }
  });

  //Calculate Line Total
  $(document).on('change', '.quantity-wrapper input, .unit-price-wrapper input, .vat-wrapper input', calculateLineTotal);
  function calculateLineTotal() {
    var quantity = Number($(this).closest('.form-row').find('.quantity-wrapper input').val().replace(',', '.'));
    var unitPrice = Number($(this).closest('.form-row').find('.unit-price-wrapper input').val().replace(',', '.'));
    var vatRate = Number($("#vat-rate").val());

    //Line Vat
    var vat = Number((quantity * unitPrice / 100 * vatRate).toFixed(2));
    $(this).closest('.form-row').find('.vat-wrapper input').val(vat);

    //Line Total
    $(this).closest('.form-row').find('.line-total-wrapper input').val((quantity * unitPrice + vat).toFixed(2));

    //Update Subtotals & Totals
    var lineSubtotal = 0;
    var vatSubtotal = 0;
    $(this).closest('form').find('.form-row').each(function (index, ele) {
      var lineTotal = $(ele).find('.line-total-wrapper input').val();
      var vat = $(ele).find('.vat-wrapper input').val();
      vatSubtotal += Number(vat);
      lineSubtotal += Number(lineTotal);
    });
    $(this).closest('.section').find('.sub-total-outer .sub-total .value').text("R".concat((lineSubtotal - vatSubtotal).toFixed(2)));
    $(this).closest('.section').find('.sub-total-outer .vat .value').text("R".concat(vatSubtotal.toFixed(2)));
    $(this).closest('.section').find('.sub-total-outer .total .value').text("R".concat(lineSubtotal.toFixed(2)));
    updateTotalCosts('.section.labour-container', '.section.parts-container');
  }

  //Update Total
  function updateTotalCosts(subtotal1, subtotal2) {
    var total1 = Number($(subtotal1).find('.total .value').text().replace('R', ''));
    var vat1 = Number($(subtotal1).find('.vat .value').text().replace('R', ''));
    var total2 = Number($(subtotal2).find('.total .value').text().replace('R', ''));
    var vat2 = Number($(subtotal2).find('.vat .value').text().replace('R', ''));
    $('.total-outer input#grand-total-value').val("R".concat((total1 + total2).toFixed(2)));
    $('.total-outer .total-vat .value').text("R".concat((vat1 + vat2).toFixed(2)));
    $('.total-outer .grand-total .value').text("R".concat((total1 + total2).toFixed(2)));
  }

  // Onboard Slider
  if ($(".onboarding-aside-slider").length) {
    $(".onboarding-aside-slider .wp-block-group__inner-container").slick({
      infinite: true,
      slidesToShow: 1,
      slidesToScroll: 1,
      dots: true,
      arrows: false
    });
  }
  $(document).on('change', '#csvFile', function (e) {
    var file = e.target.files[0];
    if (!file) return;
    var reader = new FileReader();
    reader.onload = function (e) {
      var contents = e.target.result;
      var rows = contents.split('\n');
      var data = [];
      for (var i = 0; i < rows.length; i++) {
        var columns = rows[i].split(',');
        if (columns.length === 14) {
          for (var coli = 0; coli < columns.length; coli++) {
            columns[coli] = columns[coli].trim();
          }
          i != 0 && data.push(columns);
        } else {
          $('#csvData .csv-table').html('<h5>Your CSV format does not look right, please download the template</h5>');
          break;
        }
      }

      //Create window object
      window.customerCsv = data;
      var table = "<div class=\"table-wrapper\" >\n                            <table border=\"1\">\n                                <thead>\n                                    <tr>\n                                        <th>First Name</th>\n                                        <th>Last Name</th>\n                                        <th>Phone no.</th>\n                                        <th>Additional Phone no.</th>\n                                        <th>Email</th>\n                                        <th>Address</th>\n                                        <th>Suburb</th>\n                                        <th>City</th>\n                                        <th>Province</th>\n                                        <th>Postal Code</th>\n                                        <th>Company Name</th>\n                                        <th>VAT no.</th>\n                                        <th>Company Registration</th>\n                                        <th>Note</th>\n                                    </tr>\n                                </thead>";
      for (var _i = 0; _i < 10;) {
        if (_i < data.length) {
          table += '<tr>';
          for (var j = 0; j < 14; j++) {
            table += '<td>' + data[_i][j] + '</td>';
          }
          table += '</tr>';
          _i++;
        } else {
          break;
        }
      }
      data.length > 9 ? table += "<tr><td colspan=\"2\" >And ".concat(data.length - 10, " more rows... </td></tr></table></div") : "";
      $('#csvData .csv-table').html(table);

      //Create progress bar
      var progresSegments = [];
      for (var _i2 = 0; _i2 < rows.length / 20; _i2++) {
        progresSegments += "<span class=\"segment\" ></span>";
      }
      $('#csvData .csv-table').append("<p>Customers upload progress <span class=\"loading-elipses\" style=\"opacity:0;\" ><span>.</span><span>.</span><span>.</span><span>.</span><span>.</span><span>.</span></span> <span class=\"bar\" ><span class=\"segment\" ></span></span></p>");
      $('#csvData button').removeAttr('disabled').fadeIn();
      $('.csv-upload-popup').addClass('show');
    };
    reader.readAsText(file);
  });

  // CSV Popup Close 
  $(document).on('click', '.csv-upload-popup .close-popup, .csv-upload-popup .overlay', function () {
    $('.csv-upload-popup').removeClass('show');
  });

  //Ts&Cs Checkbox
  if ($(".um-field-type_terms_conditions").length) {
    $(".um-field-type_terms_conditions").find(".um-field-checkbox-option").each(function () {
      $(this).addClass("custom-checkbox");
      $(this).html('By creating an account means you agree to the <a href="/terms-and-conditions" target="_blank">Terms and Conditions</a>, and our <a href="/privacy-policy" target="_blank">Privacy Policy</a>');
    });
  }

  //Mechanics
  //Add Mechanics Form Row
  $(document).on('click', '.add-staff-outer .add-row-button', function (e) {
    var rowCount = $('#add-staff').children().length;
    var jobRow = "<div class=\"form-row\" >\n                            <div class=\"input-label-wrapper\" >\n                                <label for=\"name-".concat(rowCount, "\" >Staff member name</label>\n                                <input type=\"text\" id=\"name-").concat(rowCount, "\" name=\"name-").concat(rowCount, "\" >\n                            </div>\n                            <div class=\"input-label-wrapper\" >\n                                <label for=\"contact-number-").concat(rowCount, "\" >Contact number</label>\n                                <input type=\"text\" id=\"contact-number-").concat(rowCount, "\" name=\"contact-number-").concat(rowCount, "\" >\n                            </div>\n                            <div class=\"input-label-wrapper\" >\n                                <label for=\"role-").concat(rowCount, "\" >Role</label>\n                                <input type=\"text\" id=\"role-").concat(rowCount, "\" name=\"role-").concat(rowCount, "\" >\n                            </div>\n                        </div>");
    $('#add-staff').append(jobRow);
  });

  // Profile form updates
  if ($('#profile-form').length) {
    $(document).on('change keyup', '#profile-form input[name="customer_prefix"]', function () {
      $('.customer-prefix-box').text($(this).val());
    });
    $(document).on('change keyup', '#profile-form input[name="job_prefix"]', function () {
      $('.job-prefix-box').text($(this).val());
    });
  }

  //Get started guide 
  if ($('.get-started-guide').length) {
    $(document).on('click', '.add-business-info .add-business-btn', function () {
      $(this).toggleClass('active');
      $('.add-business-form').addClass('show');
      if ($('.add-business-form').hasClass('show')) {
        $('.add-business-form').slideToggle('slow');
        $('.add-business-form').removeClass('show');
      } else {
        $('.add-business-form').slideUp('slow');
      }
    });
    if ($('#profile-form').length) {
      var profileFormValid = true;
      $('#profile-form input').each(function () {
        if ($(this).val() === '' && $(this).attr('name') !== 'miwa_member' && $(this).attr('name') !== 'profile_picture' && $(this).attr('name') !== 'profile_form_nonce' && $(this).attr('name') !== 'vat_number' && $(this).attr('name') !== 'company_registration_number') {
          profileFormValid = false;
        }
      });
      if (profileFormValid) {
        $('#profile-form').closest('.add-business-info').addClass('completed');
        $('#profile-form').closest('.add-business-info').find('.icon-col').html('<svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.662109" width="60" height="60" rx="30" fill="#009026"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M37.6854 23.9755C38.0841 24.4299 38.0841 25.1666 37.6854 25.6209L29.5173 37.2555C29.1185 37.7099 28.4721 37.7099 28.0733 37.2555L22.6692 31.0975C22.2704 30.6431 22.2704 29.9064 22.6692 29.4521C23.0679 28.9977 23.7144 28.9977 24.1131 29.4521L28.7953 34.7875L36.2415 23.9755C36.6402 23.5212 37.2867 23.5212 37.6854 23.9755Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M35.7025 23.8726C36.2819 23.2209 37.2214 23.2209 37.8008 23.8726C38.3731 24.5163 38.3802 25.5551 37.8219 26.2086L29.924 37.3126C29.9126 37.3286 29.9004 37.3439 29.8875 37.3584C29.3081 38.0102 28.3687 38.0102 27.7892 37.3585L22.5537 31.4697C21.9743 30.818 21.9743 29.7613 22.5537 29.1096C23.1332 28.4579 24.0726 28.4579 24.652 29.1096L28.7937 33.768L35.6631 23.9225C35.6753 23.905 35.6885 23.8883 35.7025 23.8726Z" fill="white"></path></svg>');
        $('#profile-form').closest('.add-business-info').find('.add-business-btn').click();
      } else {
        $('#profile-form').closest('.add-business-info').removeClass('completed');
        $('#profile-form').closest('.add-business-info').find('.icon-col').html('<svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.162109" width="60" height="60" rx="30" fill="#EDFFEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M18 30.1621C18 23.5347 23.3726 18.1621 30 18.1621C36.6274 18.1621 42 23.5347 42 30.1621C42 36.7895 36.6274 42.1621 30 42.1621C23.3726 42.1621 18 36.7895 18 30.1621ZM29.25 19.7769C28.2459 20.084 27.2469 21.0079 26.4191 22.5601C26.2044 22.9626 26.006 23.3999 25.8266 23.8675C26.8843 24.1035 28.0357 24.2538 29.25 24.2979V19.7769ZM24.3728 23.4713C23.7211 23.2588 23.1194 23.0114 22.5772 22.7357C23.5465 21.7668 24.7043 20.9866 25.9909 20.4546C25.6629 20.8807 25.3637 21.3516 25.0956 21.8542C24.829 22.354 24.5871 22.8951 24.3728 23.4713ZM23.2627 29.4121H19.5264C19.6716 27.3546 20.4096 25.4607 21.5707 23.9003C22.2747 24.2866 23.063 24.6226 23.9172 24.9005C23.5453 26.281 23.3171 27.8071 23.2627 29.4121ZM25.363 25.3004C26.5756 25.5805 27.8853 25.7525 29.25 25.7988V29.4121H24.7636C24.8174 27.9316 25.0293 26.5418 25.363 25.3004ZM30.75 25.7988V29.4121H35.2364C35.1825 27.9316 34.9707 26.5418 34.637 25.3004C33.4244 25.5805 32.1147 25.7525 30.75 25.7988ZM24.7636 30.9121H29.25V34.5254C27.8853 34.5717 26.5756 34.7437 25.363 35.0238C25.0293 33.7824 24.8174 32.3926 24.7636 30.9121ZM30.75 30.9121V34.5254C32.1147 34.5717 33.4244 34.7437 34.637 35.0238C34.9707 33.7824 35.1825 32.3926 35.2364 30.9121H30.75ZM25.8266 36.4567C26.8843 36.2207 28.0357 36.0704 29.25 36.0263V40.5473C28.2459 40.2402 27.2469 39.3163 26.4191 37.7641C26.2044 37.3616 26.006 36.9243 25.8266 36.4567ZM25.9909 39.8696C25.6629 39.4435 25.3637 38.9726 25.0956 38.47C24.829 37.9702 24.5871 37.4291 24.3728 36.8529C23.7211 37.0654 23.1194 37.3128 22.5772 37.5885C23.5465 38.5574 24.7043 39.3376 25.9909 39.8696ZM23.9172 35.4237C23.063 35.7016 22.2747 36.0376 21.5707 36.4239C20.4096 34.8635 19.6716 32.9696 19.5264 30.9121H23.2627C23.3171 32.5171 23.5453 34.0432 23.9172 35.4237ZM34.0091 39.8696C35.2957 39.3376 36.4535 38.5574 37.4228 37.5885C36.8806 37.3128 36.2788 37.0654 35.6272 36.8529C35.4128 37.4291 35.171 37.9702 34.9044 38.47C34.6363 38.9726 34.337 39.4435 34.0091 39.8696ZM30.75 36.0263C31.9642 36.0704 33.1157 36.2207 34.1734 36.4567C33.994 36.9243 33.7956 37.3616 33.5809 37.7641C32.7531 39.3163 31.7541 40.2402 30.75 40.5473V36.0263ZM36.0827 35.4237C36.937 35.7016 37.7253 36.0376 38.4293 36.4239C39.5904 34.8635 40.3284 32.9696 40.4736 30.9121H36.7373C36.6829 32.5171 36.4547 34.0432 36.0827 35.4237ZM40.4736 29.4121H36.7373C36.6829 27.8071 36.4547 26.281 36.0827 24.9005C36.937 24.6226 37.7253 24.2866 38.4293 23.9003C39.5904 25.4607 40.3284 27.3546 40.4736 29.4121ZM34.9044 21.8542C35.171 22.354 35.4128 22.8951 35.6272 23.4713C36.2788 23.2588 36.8806 23.0114 37.4228 22.7357C36.4535 21.7668 35.2957 20.9866 34.0091 20.4546C34.337 20.8807 34.6363 21.3516 34.9044 21.8542ZM34.1734 23.8675C33.1157 24.1035 31.9642 24.2538 30.75 24.2979V19.7769C31.7541 20.084 32.7531 21.0079 33.5809 22.5601C33.7956 22.9626 33.994 23.3999 34.1734 23.8675Z" fill="#009026"/></svg>');
      }
    }
  }

  //Toggle snapshot
  if ($('.snapshot-section').length) {
    $(document).on('click', '.snapshot-section .reveal-snapshot-btn', function () {
      $(this).toggleClass('active');
      $('.snapshot-items').slideToggle('slow');
    });
  }

  //Workshop Doughnut Chart 
  if ($('#workshopChart').length) {
    var activeVal = $('.active .chart-value').text();
    var completeVal = $('.complete .chart-value').text();
    var awaitingVal = $('.awaiting .chart-value').text();
    var ctx = document.getElementById('workshopChart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Active', 'Complete', 'Waiting'],
        datasets: [{
          label: '',
          data: [activeVal, completeVal, awaitingVal],
          backgroundColor: ['#68DBF2', '#2ECF88', '#F7936F']
        }],
        unitSuffix: "%"
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutoutPercentage: 90,
        title: {
          display: true,
          text: 'Workshop Chart',
          fontSize: 16,
          fontWeight: 700
        },
        tooltips: {
          display: false
        },
        plugins: {
          legend: {
            display: false,
            position: 'bottom',
            align: 'center'
          }
        }
      }
    });
  }

  //Popup 
  $(document).on('click', '.popup-btn', function (e) {
    e.preventDefault();
    var popup = '#' + $(this).data('popup');
    $(popup).fadeIn('fast', function () {
      $(popup).addClass('show');
      $('body').css('overflow', 'hidden');
    });
  });
  $(document).on('click', '.popup-overlay, .close-popup, .cancel-popup', function () {
    $('.popup').fadeOut('fast', function () {
      $(this).removeClass('show');
      $('body').css('overflow', 'auto');
    });
    $(this).closest('form:not(#send-quote-form)').clearForm();

    // Remove Attachment Files from table
    $('#attachment-files').hide();
    $('#attachment-files tbody tr').remove();

    // #send-quote-popup 
    if ($(this).closest('.popup').attr('id') === 'send-quote-popup') {
      console.log('Send Quote Popup Closed');
      $('.pdf-success-message-close, .pdf-success-message').fadeOut();
      $('#send-quote-form').fadeIn();
    }
  });

  //Vehicle Edit popup extras
  $(document).on('click', '.edit-vehicle-popup .popup-overlay, .edit-vehicle-popup .close-popup, .edit-vehicle-popup .cancel-popup', function () {
    setTimeout(function () {
      $('.popup').fadeOut('fast', function () {
        $(this).removeClass('show');
        $('body').css('overflow', 'auto');
      });
      $('#add-vehicle-popup').removeClass('edit-vehicle-popup').find('.popup-title').text('Add Vehicle');
      $('#add-vehicle-popup').find('form').clearForm();
      $('.customer').find('.selected-customer-outer').fadeOut(0, function () {
        $('.customer-select').fadeIn();
      });
    }, 500);
  });

  // Customer Vehicle popup  
  $(document).on('click', '.add-customer-vehicle', function (e) {
    e.preventDefault();
    var popup = '#' + $(this).attr('data-popup');
    $(popup).fadeIn('fast', function () {
      $(popup).addClass('show');
      $('body').css('overflow', 'hidden');
    });
    $('#add-vehicle-popup').addClass('edit-vehicle-popup');

    // Populate Customer Select Field
    $('.customer').find('.customer-select').fadeOut(0, function () {
      $('.selected-customer-outer').fadeIn();
    });

    // Customer field update        
    $('.selected-customer-outer .customer-name-val').text($('input[name="first-name-1"]').val() + ' ' + $('input[name="last-name-1"]').val());
    $('.selected-customer-outer .company-name-val').text($('input[name="company-name"]').val());
    $('.selected-customer-outer .contact-val').text($('input[name="cell-number-1"]').val());
    $('.selected-customer-outer .address-val').text($('input[name="physical-address"]').val() + ' ' + $('input[name="suburb"]').val() + ' ' + $('input[name="city"]').val() + ' ' + $('input[name="province"]').val() + ' ' + $('input[name="postal-code"]').val());

    // Populate the vehicle fields with the data
    var customerData = '{"customer-post-id":"' + $('input[name="customer-post-id"]').val() + '", "customer-name":"' + $('input[name="first-name-1"]').val() + ' ' + $('input[name="last-name-1"]').val() + '", "company-name":"' + $('input[name="company-name"]').val() + '", "email":"' + $('input[name="email-1"]').val() + '", "phone":"' + $('input[name="cell-number-1"]').val() + '", "address":"' + $('input[name="physical-address"]').val() + ' ' + $('input[name="suburb"]').val() + ' ' + $('input[name="city"]').val() + ' ' + $('input[name="province"]').val() + ' ' + $('input[name="postal-code"]').val() + '"}';
    $('.edit-vehicle-popup input[name="customer-data"]').val(customerData);
  });

  //Job Status
  $(document).on('click', '.select-wrapper.job-status.active .options > span', function () {
    var value = $(this).data('value');
    var text = $(this).text();
    var nextValue = '';
    var nextText = '';
    $('#job-status').val(value);
    $('.select-wrapper.job-status .control-status').text(text).addClass('active-select');
    console.log("Changed", $('.control-fields .job-send'));
    switch (value) {
      case "draft":
        nextValue = "quote-sent";
        nextText = "Send Quote";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "quote-sent":
        nextValue = "quote-accepted";
        nextText = "Quote Accepted";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "quote-accepted":
        nextValue = "in-progress";
        nextText = "In Progress";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "awaiting-parts":
        nextValue = "in-progress";
        nextText = "In Progress";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "in-progress":
        nextValue = "completed";
        nextText = "Complete & Invoice";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "completed":
        nextValue = "awaiting-payment";
        nextText = "Awaiting Payment";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "awaiting-payment":
        nextValue = "paid-&-closed";
        nextText = "Paid & Closed";
        $('.control-fields .job-send').css('display', 'block');
        break;
      case "paid-&-closed":
        nextValue = "paid-&-closed";
        nextText = "Paid & Closed";
        $('.control-fields .job-send').css('display', 'none');
        break;
      default:
        // alert("State not found... Look at quote-and-invoice.js switch statement for clues")
        break;
    }
    $('.control-fields .job-send').attr('data-state', nextValue);
    $('.control-fields .job-send').text(nextText);
  });

  //Preferred Contact Method
  $(document).on('click', '.select-wrapper.preferred-contact-method .options > span', function () {
    var text = $(this).text();
    $(this).closest('.select-wrapper').find('input.preferred-contact-method').val(text);
  });

  //Add Mechanic
  $(document).on('click', '.select-wrapper.mechanics .options > span', function () {
    var self = $(this);
    var selectedMechanics = $('#selected-mechanics').val().length > 0 ? $('#selected-mechanics').val() : '';
    selectedMechanics.length > 0 ? selectedMechanics += ",".concat(self.text().trim()) : selectedMechanics = self.text().trim();
    $('#selected-mechanics').val();
    $('#selected-mechanics').val(selectedMechanics);
    var selectedMechanicMarkup = self.html();
    self.closest('.select-wrapper-outer').find('.assigned-mechanics').append(selectedMechanicMarkup);
    self.closest('.select-wrapper-outer').find('.assigned-mechanics .mechanic-inner').off();
    self.closest('.mechanic-outer').fadeOut();
  });

  //Remove selected mechanic
  $(document).on('click', '.select-wrapper-outer .assigned-mechanics-outer .assigned-mechanics .mechanic-inner .close', function () {
    var self = $(this);
    var selectedMechanics = $('#selected-mechanics').val();
    var removedMechanic = self.closest('.mechanic').data('mechanic');
    if (selectedMechanics.indexOf(removedMechanic) > -1) {
      if (selectedMechanics.indexOf(',' + removedMechanic) > -1) {
        selectedMechanics = selectedMechanics.replace(',' + removedMechanic, '');
      } else if (selectedMechanics.indexOf(removedMechanic + ',') > -1) {
        selectedMechanics = selectedMechanics.replace(removedMechanic + ',', '');
      } else {
        selectedMechanics = selectedMechanics.replace(removedMechanic, '');
      }
    }
    $('#selected-mechanics').val();
    $('#selected-mechanics').val(selectedMechanics);
    var mechanicName = $(this).closest('.mechanic').data('mechanic');
    $(this).closest('.select-wrapper-outer').find(".options > .mechanic-outer[data-mechanic=\"".concat(mechanicName, "\"]")).fadeIn();
    $(this).closest('.mechanic-inner').remove();
  });

  //Fill job sub-totals on load if editing
  if ($("#main > .editing").length > 0) {
    var labourVat = 0;
    var labourLineTotal = 0;
    Array.from($('#job-fields .form-row')).forEach(function (ele) {
      labourVat += Number($(ele).find('.vat-wrapper > input').val());
      labourLineTotal += Number($(ele).find('.line-total-wrapper > input').val());
    });
    console.log(labourVat, labourLineTotal);
    $('.section.labour-container .sub-total-outer .sub-total .value').text("R".concat((labourLineTotal - labourVat).toFixed(2)));
    $('.section.labour-container .sub-total-outer .vat .value').text("R".concat(labourVat.toFixed(2)));
    $('.section.labour-container .sub-total-outer .total .value').text("R".concat((labourLineTotal + labourVat).toFixed(2)));
    var partVat = 0;
    var partLineTotal = 0;
    Array.from($('#parts-fields .form-row')).forEach(function (ele) {
      partVat += Number($(ele).find('.vat-wrapper > input').val());
      partLineTotal += Number($(ele).find('.line-total-wrapper > input').val());
    });
    $('.section.parts-container .sub-total-outer .sub-total .value').text("R".concat((partLineTotal - partVat).toFixed(2)));
    $('.section.parts-container .sub-total-outer .vat .value').text("R".concat(partVat.toFixed(2)));
    $('.section.parts-container .sub-total-outer .total .value').text("R".concat((partLineTotal + partVat).toFixed(2)));
    updateTotalCosts('.section.labour-container', '.section.parts-container');
  }

  // Edit Vehicle Popop remove customer list options
  $(document).on('click', '.edit-vehicle-popup .customer .change-customer, .edit-vehicle-popup .customer .close', function (e) {
    $('input.selected-value, input[name="customer-data"]').val('').focus();
    $('.edit-vehicle-popup .customer .options.active li').fadeOut();
    $('.edit-vehicle-popup .customer .options.active').removeClass('active');
  });

  // Tabs 
  if ($('.tab-container').length > 0) {
    $('.tab-item').hide();
    $('.tab-item:first-child').show();
    $('.tab-button:first-child').addClass('active');
    $(document).on('click', '.tab-button', function () {
      // Hide all tab content 
      $(this).closest('.tab-container').children('.tab-content').children('.tab-item').hide();

      // Show the selected tab content 
      var tabId = $(this).data('tab');
      $("#".concat(tabId)).fadeIn();

      // Optional: Add active class to the selected tab button
      $(this).siblings().removeClass('active');
      $(this).addClass('active');
    });

    // if url has a hash, show the tab 
    if (window.location.hash) {
      var tab = window.location.hash.replace('#', '') + '-tab';
      $(".tab-button[data-tab=\"".concat(tab, "\"]")).click();
    }
  }

  //Display additional contact in customer form
  if ($('.alternate-contact .title-button').length > 0) {
    var additionalDetails = $('.alternate-contact').hasClass('open') ? true : false;
    $(document).on('click', '.alternate-contact .title-button', function () {
      if (!additionalDetails) {
        $(this).closest('.alternate-contact').find('.alternate-contact-form').fadeIn();
        $(this).closest('.alternate-contact').addClass('open');
        additionalDetails = true;
      } else {
        $(this).closest('.alternate-contact').find('.alternate-contact-form').fadeOut();
        $(this).closest('.alternate-contact').removeClass('open');
        additionalDetails = false;
      }
    });
  }

  // Send Quote Email
  if ($('#send-quote-form').length > 0) {
    $(document).on('click', '.add-email-btn', function () {
      var emailCount = Number($(this).closest('.email-wrapper').siblings().length) + 1;
      console.log(emailCount);
      if ($(this).closest('.email-wrapper').siblings().length < 3) {
        $(this).closest('.input-label-wrapper').append("\n                    <div class=\"email-wrapper d-flex flex-align-center mt-2\">\n                        <input type=\"email\" name=\"email" + emailCount + "\" id=\"email" + emailCount + "\" value=\"\" class=\"required\">\n                        <div class=\"remove-email-btn ml-2\">\n                            <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10 0C4.47715 0 0 4.47715 0 10C0 15.5228 4.47715 20 10 20C15.5228 20 20 15.5228 20 10C20 4.47715 15.5228 0 10 0ZM10 18.75C5.57963 18.75 1.25 14.4204 1.25 10C1.25 5.57963 5.57963 1.25 10 1.25C14.4204 1.25 18.75 5.57963 18.75 10C18.75 14.4204 14.4204 18.75 10 18.75ZM10 5C9.44772 5 9 5.44772 9 6V9H6C5.44772 9 5 9.44772 5 10C5 10.5523 5.44772 11 6 11H9V14C9 14.5523 9.44772 15 10 15C10.5523 15 11 14.5523 11 14V11H14C14.5523 11 15 10.5523 15 10C15 9.44772 14.5523 9 14 9H11V6C11 5.44772 10.5523 5 10 5Z\" fill=\"#7A7A9D\"></path>\n                            </svg>\n                        </div> \n                    </div>\n                ");
      }
    });
    $(document).on('click', '.remove-email-btn', function () {
      $(this).closest('.email-wrapper').remove();
    });
  }

  // Default quote message key words 
  function typeInTextarea(newText) {
    var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.activeElement;
    var _ref = [el.selectionStart, el.selectionEnd],
      start = _ref[0],
      end = _ref[1];
    el.setRangeText(newText, start, end, 'select');
  }

  // on click of the button, insert the text into textarea
  $(document).on('click', '.key-word', function (e) {
    e.preventDefault();
    var keyWord = $(this).data('key');
    var textarea = $(this).closest('.form-row').find('textarea')[0];
    typeInTextarea(keyWord, textarea);
  });

  //Redirect to job list
  $(document).on('click', '.continue-to-job-list', function () {
    window.location.href = "/workshoppro/jobs/";
  });

  // limit the number of words in a textarea on keyup 
  $(document).on('keyup', '[data-max-words]', function () {
    var maxWords = $(this).data('max-words');
    var words = $(this).val().split(' ').length;
    if (words > maxWords) {
      $(this).val($(this).val().split(' ').slice(0, maxWords).join(' '));
    }
  });
});
'use strict';

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }
function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _iterableToArrayLimit(r, l) { var t = null == r ? null : "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t["return"] && (u = t["return"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }
function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }
function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }
jQuery(document).ready(function ($) {
  //Customer Select Dropdown
  if ($('.job-select-wrapper.customer .customer-select').length > 0) {
    //Vehicle Options - If only one vehicle exists then autofill the selected vehicle fields, but still populate the vehicle options without showing them
    var vehicleOptions = function vehicleOptions(self) {
      var dataValues = self.data();
      var allVehicles = dataValues['vehicleAll'];
      var vehicleOptions = "";
      Object.keys(allVehicles).forEach(function (vin) {
        vehicleOptions += "<li \n                data-vin=\"".concat(vin, "\"   \n                data-mileage=\"").concat(allVehicles[vin]['mileage'], "\" \n                data-make=\"").concat(allVehicles[vin]['make'], "\" \n                data-model=\"").concat(allVehicles[vin]['model'], "\" \n                                            data-vehicle-all='").concat(JSON.stringify(allVehicles[vin]), "' \n                                            >\n                                            <p class=\"make-model\" > ").concat(allVehicles[vin]['make'], " / ").concat(allVehicles[vin]['model'], " / ").concat(allVehicles[vin]['colour'], " </p>\n                                            <p class=\"registration\" > ").concat(allVehicles[vin]['registration'], " </p>\n                                        </li>");
      });
      $('.no-customer-selected').fadeOut(0);
      $('.job-select-wrapper.vehicle .options > li').remove();
      $('.job-select-wrapper.vehicle .options').html(vehicleOptions);
      if (Object.keys(allVehicles).length === 1) {
        Object.keys(allVehicles).forEach(function (vin) {
          customerResultsActive = false;

          //Complete hidden vehicle fields
          $('input[name="vehicle-registration"]').val(allVehicles[vin]['registration']);
          $('input[name="vehicle-vin"]').val(vin);
          $('input[name="vehicle-data"]').val("{\"".concat(vin, "\":").concat(JSON.stringify(allVehicles[vin]), "}"));
          $('.vehicle-select .pre-vehicle-selection').fadeOut(function () {
            $('.selected-vehicle-outer .make-model-val').text(allVehicles[vin]['make'] + ', ' + allVehicles[vin]['model']);
            $('.selected-vehicle-outer .vehicle-details .mileage-val').text("Mileage: " + allVehicles[vin]['mileage']);
            $('.selected-vehicle-outer .vehicle-details .vin-val').text("VIN: " + vin);
            $('.selected-vehicle-outer .vehicle-details .registration-val').text("License Number: " + allVehicles[vin]['registration']);
            $('.no-customer-selected').fadeOut(0);
            $('.vehicle-select .pre-vehicle-selection').fadeOut(0, function () {
              $('.selected-vehicle-outer').fadeIn();
              $('.job-select-wrapper.vehicle .vehicle-select').fadeIn();
            });
          });
        });
        $('.vehicle-select .pre-vehicle-selection').length > 0 && validateInput($('.vehicle-select .pre-vehicle-selection').closest('.forms-container').find('input[type="hidden"][name="vehicle-data"]'));
      } else {
        $('.vehicle-select .pre-vehicle-selection').length > 0 && validateInput($('.vehicle-select .pre-vehicle-selection').closest('.forms-container').find('input[type="hidden"][name="vehicle-data"]'));
        $('.job-select-wrapper.vehicle .vehicle-select .pre-vehicle-selection').fadeIn();
        $('.job-select-wrapper.vehicle .vehicle-select').fadeIn();
      }
    }; //Add vehicle option event listeners
    var keyupTimeout;
    var customerResultsActive = false;
    var searching = false;
    $(document).on('keyup', '.selected-value', function () {
      var searchValue = $(this).val();
      var self = $(this);

      //Prevent search from running until we stop typing for 2 seconds
      clearTimeout(keyupTimeout);

      //Set a new timeout
      keyupTimeout = setTimeout(function () {
        if (!searching) {
          searching = true;

          //Add loader
          addLoader('.job-select-wrapper.customer');
          $.ajax({
            type: "POST",
            url: dashboard_obj.ajaxurl,
            data: {
              'action': 'fetch_customers_customer_select',
              'search-val': searchValue
            },
            success: function success(response) {
              customerResultsActive = true;
              var customerData = JSON.parse(response);
              var options = "<li class=\"add-new-customer\" >\n                            <a href=\"/workshoppro/customers/add-customer/\">\n                                <svg width=\"46\" height=\"46\" viewBox=\"0 0 46 46\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                <rect width=\"46\" height=\"46\" rx=\"23\" fill=\"#EDFFEB\"/>\n                                <mask id=\"mask0_2_12674\" style=\"mask-type:alpha\" maskUnits=\"userSpaceOnUse\" x=\"14\" y=\"14\" width=\"18\" height=\"18\">\n                                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M23 18.5C23.3107 18.5 23.5625 18.7518 23.5625 19.0625V22.4375H26.9375C27.2482 22.4375 27.5 22.6893 27.5 23C27.5 23.3107 27.2482 23.5625 26.9375 23.5625H23.5625V26.9375C23.5625 27.2482 23.3107 27.5 23 27.5C22.6893 27.5 22.4375 27.2482 22.4375 26.9375V23.5625H19.0625C18.7518 23.5625 18.5 23.3107 18.5 23C18.5 22.6893 18.7518 22.4375 19.0625 22.4375H22.4375V19.0625C22.4375 18.7518 22.6893 18.5 23 18.5Z\" fill=\"black\"/>\n                                </mask>\n                                <g mask=\"url(#mask0_2_12674)\">\n                                <rect x=\"14\" y=\"14\" width=\"18\" height=\"18\" fill=\"#009026\"/>\n                                </g>\n                                </svg>\n                                Add new customer\n                            </a>\n                        </li>";
              if (Object.keys(customerData).length > 0) {
                Object.keys(customerData).forEach(function (customer) {
                  options += "<li \n                                data-customer-id='".concat(customerData[customer]["customer_post_id"], "' \n                                data-company-name='").concat(customerData[customer]["company-name"], "' \n                                data-address='").concat(customerData[customer]["address"], "' \n                                data-name='").concat(customerData[customer]["customer-name"], "' \n                                data-email='").concat(customerData[customer]["email"], "' \n                                data-phone='").concat(customerData[customer]["phone"], "' \n                                data-vehicle-all='").concat(customerData[customer]["all-vehicle-values"], "'\n                                >\n                                    <svg width=\"46\" height=\"46\" viewBox=\"0 0 46 46\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                        <rect width=\"46\" height=\"46\" rx=\"23\" fill=\"#F0F6FF\"/>\n                                        <mask id=\"mask0_2_12688\" style=\"mask-type:alpha\" maskUnits=\"userSpaceOnUse\" x=\"14\" y=\"14\" width=\"18\" height=\"18\">\n                                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M23 30.875C27.3492 30.875 30.875 27.3492 30.875 23C30.875 18.6508 27.3492 15.125 23 15.125C18.6508 15.125 15.125 18.6508 15.125 23C15.125 27.3492 18.6508 30.875 23 30.875ZM23 32C27.9706 32 32 27.9706 32 23C32 18.0294 27.9706 14 23 14C18.0294 14 14 18.0294 14 23C14 27.9706 18.0294 32 23 32Z\" fill=\"black\"/>\n                                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.8204 24.7631C19.0893 24.6075 19.4334 24.6994 19.589 24.9683C20.2706 26.1467 21.5433 26.9375 23 26.9375C24.4568 26.9375 25.7294 26.1467 26.4111 24.9683C26.5667 24.6994 26.9108 24.6075 27.1797 24.7631C27.4486 24.9187 27.5405 25.2627 27.3849 25.5317C26.5104 27.0434 24.8746 28.0625 23 28.0625C21.1255 28.0625 19.4896 27.0434 18.6151 25.5317C18.4596 25.2627 18.5515 24.9187 18.8204 24.7631Z\" fill=\"black\"/>\n                                        <path d=\"M21.875 21.3125C21.875 22.2445 21.3713 23 20.75 23C20.1287 23 19.625 22.2445 19.625 21.3125C19.625 20.3805 20.1287 19.625 20.75 19.625C21.3713 19.625 21.875 20.3805 21.875 21.3125Z\" fill=\"black\"/>\n                                        <path d=\"M26.375 21.3125C26.375 22.2445 25.8713 23 25.25 23C24.6287 23 24.125 22.2445 24.125 21.3125C24.125 20.3805 24.6287 19.625 25.25 19.625C25.8713 19.625 26.375 20.3805 26.375 21.3125Z\" fill=\"black\"/>\n                                        </mask>\n                                        <g mask=\"url(#mask0_2_12688)\">\n                                        <rect x=\"14\" y=\"14\" width=\"18\" height=\"18\" fill=\"#18181A\"/>\n                                        </g>\n                                    </svg>\n                                    ").concat(customerData[customer]["customer-name"], " \n                                </li>");
                });
              } else {
                options += "<li class=\"no-customers\" >\n                                            <svg width=\"46\" height=\"46\" viewBox=\"0 0 46 46\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"transform: rotate(180deg);\" >\n                                                <rect width=\"46\" height=\"46\" rx=\"23\" fill=\"#F0F6FF\"/>\n                                                <mask id=\"mask0_2_12688\" style=\"mask-type:alpha\" maskUnits=\"userSpaceOnUse\" x=\"14\" y=\"14\" width=\"18\" height=\"18\">\n                                                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M23 30.875C27.3492 30.875 30.875 27.3492 30.875 23C30.875 18.6508 27.3492 15.125 23 15.125C18.6508 15.125 15.125 18.6508 15.125 23C15.125 27.3492 18.6508 30.875 23 30.875ZM23 32C27.9706 32 32 27.9706 32 23C32 18.0294 27.9706 14 23 14C18.0294 14 14 18.0294 14 23C14 27.9706 18.0294 32 23 32Z\" fill=\"black\"/>\n                                                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.8204 24.7631C19.0893 24.6075 19.4334 24.6994 19.589 24.9683C20.2706 26.1467 21.5433 26.9375 23 26.9375C24.4568 26.9375 25.7294 26.1467 26.4111 24.9683C26.5667 24.6994 26.9108 24.6075 27.1797 24.7631C27.4486 24.9187 27.5405 25.2627 27.3849 25.5317C26.5104 27.0434 24.8746 28.0625 23 28.0625C21.1255 28.0625 19.4896 27.0434 18.6151 25.5317C18.4596 25.2627 18.5515 24.9187 18.8204 24.7631Z\" fill=\"black\"/>\n                                                <path d=\"M21.875 21.3125C21.875 22.2445 21.3713 23 20.75 23C20.1287 23 19.625 22.2445 19.625 21.3125C19.625 20.3805 20.1287 19.625 20.75 19.625C21.3713 19.625 21.875 20.3805 21.875 21.3125Z\" fill=\"black\"/>\n                                                <path d=\"M26.375 21.3125C26.375 22.2445 25.8713 23 25.25 23C24.6287 23 24.125 22.2445 24.125 21.3125C24.125 20.3805 24.6287 19.625 25.25 19.625C25.8713 19.625 26.375 20.3805 26.375 21.3125Z\" fill=\"black\"/>\n                                                </mask>\n                                                <g mask=\"url(#mask0_2_12688)\">\n                                                <rect x=\"14\" y=\"14\" width=\"18\" height=\"18\" fill=\"#18181A\"/>\n                                                </g>\n                                            </svg>\n                                            No matching customers found\n                                        </li>";
              }
              self.closest('.customer-select').find('.options').addClass('active').html(options);

              //Remove loader                        
              removeLoader('.job-select-wrapper.customer');
              searching = false;
            }
          });
        }
      }, 1500);
    });

    //Add customer option event listeners
    $(document).on('click', '.job-select-wrapper.customer .options li:not(.add-new-customer):not(.no-customers)', function () {
      customerResultsActive = false;
      var customerID = $(this).data('customer-id');
      var customerName = $(this).data('name');
      var companyName = $(this).data('company-name');
      var contact = $(this).data('email');
      var phone = $(this).data('phone');
      var address = $(this).data('address');
      $('.selected-customer-outer .customer-name-val').text(customerName);
      $('.selected-customer-outer .company-name-val').text(companyName);
      $('.selected-customer-outer .contact-val').text(contact);
      $('.selected-customer-outer .address-val').text(address);

      //Complete hidden customer field
      var customerData = {
        "customer-post-id": customerID,
        "customer-name": customerName,
        "company-name": companyName,
        "email": contact,
        "phone": phone,
        "address": address
      };
      $('input[name="customer-data"]').val(JSON.stringify(customerData));

      //Build out vehicle options
      vehicleOptions($(this));

      //Append selected customer markup & hide search field.
      $(this).closest('.job-select-wrapper.customer').find('.customer-select').fadeOut(0, function () {
        $('.selected-customer-outer').fadeIn();
        validateInput($(this).closest('.job-select-wrapper.customer').find('input[type="hidden"][name="customer-data"]'));
      });
    });

    //Change customer event
    $(document).on('click', '.change-customer, .selected-customer-outer .close', function () {
      customerResultsActive = true;
      //Remove selected vehicle & options if they exists
      $('.job-select-wrapper.vehicle .options > li, .job-select-wrapper.vehicle .pre-vehicle-selection .options li').remove();
      $('.job-select-wrapper.vehicle .no-customer-selected').fadeIn();
      $('.job-select-wrapper.vehicle .pre-vehicle-selection, .job-select-wrapper.vehicle .selected-vehicle-outer').fadeOut();

      //Make search results active again
      $('.job-select-wrapper.customer .options').addClass('active');
      $('.job-select-wrapper.customer .options.active li').fadeIn();
      $(this).closest('.job-select-wrapper').find('.customer-select').fadeIn();
      $(this).closest('.job-select-wrapper').find('.selected-customer-outer').fadeOut();
    });

    //Add change vehicle event listener
    $(document).on('click', '.job-select-wrapper.vehicle .change-vehicle', function changeVehicle() {
      customerResultsActive = false;
      $('.pre-vehicle-selection').fadeIn(0);
      $('.selected-vehicle-outer').fadeOut(0);
    });
    $(document).on('click', '.job-select-wrapper.vehicle .pre-vehicle-selection > .options > li', function () {
      customerResultsActive = false;
      var selectedVin = $(this).data("vin");
      var selectedVehicleData = JSON.stringify($(this).data("vehicle-all"));
      var selectedMakeModel = $(this).find(".make-model").text();
      var selectedMileage = $(this).data("mileage");
      var selectedRegistration = $(this).find(".registration").text();

      //Complete hidden vehicle fields
      $('input[name="vehicle-registration"]').val(selectedRegistration);
      $('input[name="vehicle-vin"]').val(selectedVin);
      $('input[name="vehicle-data"]').val("{\"".concat(selectedVin, "\":").concat(selectedVehicleData, "}"));
      $('.vehicle-select .pre-vehicle-selection').fadeOut(function () {
        $('.selected-vehicle-outer .make-model-val').text(selectedMakeModel);
        $('.selected-vehicle-outer .vehicle-details .mileage-val').text(selectedMileage);
        $('.selected-vehicle-outer .vehicle-details .vin-val').text(selectedVin);
        $('.selected-vehicle-outer .vehicle-details .registration-val').text(selectedRegistration);
        $('.selected-vehicle-outer').fadeIn();
        validateInput($('.vehicle-select .pre-vehicle-selection').closest('.forms-container').find('input[type="hidden"][name="vehicle-data"]'));
      });
    });

    //Todo: add vehicle popup to this event
    $(document).on('click', '.job-select-wrapper .add-new-vehicle', function (e) {
      e.preventDefault();
      var vehicleData = $('input[name="customer-data"]').val();
      vehicleData = JSON.parse(vehicleData);
      var popup = '#' + $(this).attr('data-popup');
      $(popup).fadeIn('fast', function () {
        $(popup).addClass('show');
        $('body').css('overflow', 'hidden');
      });
      $('#add-vehicle-popup').addClass('job-add-vehicle-popup');

      // Populate Customer Select Field
      $('.customer').find('.customer-select').fadeOut(0, function () {
        console.log('customer select fadeout');
        $('.selected-customer-outer').fadeIn();
      });

      // Customer field update        
      $('.job-add-vehicle-popup .selected-customer-outer .customer-name-val').text(vehicleData['customer-name']);
      $('.job-add-vehicle-popup .selected-customer-outer .company-name-val').text(vehicleData['company-name']);
      $('.job-add-vehicle-popup .selected-customer-outer .contact-val').text(vehicleData['email']);
      $('.job-add-vehicle-popup .selected-customer-outer .address-val').text(vehicleData['address']);

      // Populate the vehicle fields with the data
      $('.job-add-vehicle-popup input[name="customer-data"]').val($('input[name="customer-data"]').val());
    });

    // Add to selected vehicle 
    $(document).on('click', '.selected-vehicle-add', function (e) {
      e.preventDefault();
      customerResultsActive = false;
      $('.pre-vehicle-selection').fadeIn(0);
      $('.selected-vehicle-outer').fadeOut(0);
      var popup = '#' + $(this).attr('data-popup');
      $(popup).fadeIn('fast', function () {
        $(popup).addClass('show');
        $('body').css('overflow', 'hidden');
      });
      $('#add-vehicle-popup').addClass('job-add-vehicle-popup');
    });

    // Close dropdown on clickoff
    $(document).on('click', function (e) {
      if (!$(e.target).closest('.customer-select').length > 0 && !$(e.target).closest('.selected-customer-outer .change-customer').length > 0 && !$(e.target).closest('.selected-customer-outer .close').length > 0) {
        $('.job-select-wrapper.customer .options.active li').fadeOut();
        $('.job-select-wrapper.customer .options.active').removeClass('active');
      }
    });
  }

  //Mechanics Save/Edit Ajax
  $(document).on('click', '#save-post.technicians-save', function () {
    // Validate 
    if (!validateFormSubmit()) {
      return false;
    }
    addLoader('.add-staff-outer .add-row-button-outer');

    //Labour Rows
    var mechanicsData = $("#add-staff").serialize();
    if (mechanicsData.length > 0) {
      $.ajax({
        type: "POST",
        url: dashboard_obj.ajaxurl,
        data: {
          'action': 'insert_mechanics',
          'staff-member': mechanicsData
        },
        success: function success(response) {
          removeLoader('.add-staff-outer .add-row-button-outer');

          // Reload the vehicle table 
          var table = $('#staff-table').DataTable();
          table.ajax.reload();

          // Clear the form 
          $('#add-staff')[0].reset();
        }
      });
    } else {
      removeLoader('.add-staff-outer .add-row-button-outer');
    }
  });

  //Job Save/Edit Ajax
  $(document).on('click', '#save-post.job-save, .job-send', function (event) {
    event.preventDefault();
    var self = $(this);
    progressPopup('saving', 'start');

    // Validate 
    var valid = true;
    var requiredInputs = Array.from(document.querySelectorAll('.jobno-customer-vehicle input.required'));
    var i = 0;
    requiredInputs.forEach(function (input) {
      if (input.value.length === 0) {
        var inputWrapper = input.closest('.input-label-wrapper');
        // removeErrorMessage(input);
        input.classList.remove('error');
        var errorMessage = inputWrapper.querySelector('.error-message');
        if (errorMessage) {
          inputWrapper.removeChild(errorMessage);
        }
        // addErrorMessage(input, 'This field is required');
        var message = 'This field is required';
        input.classList.add('error');
        inputWrapper.insertAdjacentHTML('beforeend', '<span class="error-message">' + message + '</span>');
        if (i === 0) {
          input.focus();
          i++;
        }
        valid = false;
      } else {
        // removeErrorMessage(input);
        input.classList.remove('error');
        var _inputWrapper = input.closest('.input-label-wrapper');
        var _errorMessage = _inputWrapper.querySelector('.error-message');
        if (_errorMessage) {
          _inputWrapper.removeChild(_errorMessage);
        }
      }
    });
    if (!valid) {
      return false;
    }

    //Job single data
    var existingJobID = $('input#job-id').val();
    var jobNumber = $('input#job-number').val();
    // const postDate = $('#booking-date').closest('.input-label-wrapper').find('.wm-date-picker').val()

    //Customer hidden fields
    var customerData = $('input[name="customer-data"]').val();

    //Vehicle hidden fields
    var vehicleRegistration = $('input[name="vehicle-registration"]').val();
    var vehicleVIN = $('input[name="vehicle-vin"]').val();
    var vehicleData = $('input[name="vehicle-data"]').val();

    //Cost
    var jobGrandTotal = $("input#grand-total-value").val().replace('R', '');

    //Notes & Attachments Rows
    var jobAttachments = $("#attachments-obj").val();
    var jobJobNotes = $("#job-notes").serialize();

    //Labour Rows
    var labourFieldForm = document.getElementById("job-fields");
    var formData = new FormData(labourFieldForm);
    var labourRowArray = [];
    var labourKeyAndValue = {};
    var labourSortedFormData = {};
    var labourI = 0;
    var labourRowNum = 0;
    //The loop count is based on the number of fields in the form
    var _iterator = _createForOfIteratorHelper(formData.entries()),
      _step;
    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var pair = _step.value;
        if (labourI < 6) {
          labourKeyAndValue = {};
          var pairkey = pair[0];
          var pairValue = pair[1];
          if (labourKeyAndValue[pairkey] === undefined) {
            labourKeyAndValue[pairkey] = "";
          }
          labourKeyAndValue[pairkey] += pairValue;
          labourRowArray.push(labourKeyAndValue);
          labourI++;
          if (labourI === 6) {
            labourI = 0;
            labourSortedFormData["row-".concat(labourRowNum)] = labourRowArray;
            labourRowArray = [];
            labourRowNum++;
          }
        }
      }

      //Parts Rows
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
    var partsFieldForm = document.getElementById("parts-fields");
    var partsFormData = new FormData(partsFieldForm);
    var partsRowArray = [];
    var partsKeyAndValue = {};
    var partsSortedFormData = {};
    var partsI = 0;
    var partsRowNum = 0;
    //The loop count is based on the number of fields in the form
    var _iterator2 = _createForOfIteratorHelper(partsFormData.entries()),
      _step2;
    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        var _pair = _step2.value;
        if (partsI < 8) {
          partsKeyAndValue = {};
          var _pairkey = _pair[0];
          var _pairValue = _pair[1];
          if (partsKeyAndValue[_pairkey] === undefined) {
            partsKeyAndValue[_pairkey] = "";
          }
          partsKeyAndValue[_pairkey] += _pairValue;
          partsRowArray.push(partsKeyAndValue);
          partsI++;
          if (partsI === 8) {
            partsI = 0;
            partsSortedFormData["row-".concat(partsRowNum)] = partsRowArray;
            partsRowArray = [];
            partsRowNum++;
          }
        }
      }

      //Booking Fields
    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }
    var bookingFields = $('#booking-fields').serialize();

    //Mechanics Field
    var mechanicField = $('#selected-mechanics').val();

    //Give the js a moment to update the inputs value
    var jobStatus = $(self).hasClass('job-send') ? self.attr('data-state') : self.closest('.control-fields').find('#job-status').val();
    console.log("JS before save ", jobStatus, self, $(self).hasClass('job-send'));
    $.ajax({
      type: "POST",
      url: dashboard_obj.ajaxurl,
      data: {
        'action': 'post_jobs',
        // 'post-date': postDate,
        'labour-data': labourSortedFormData,
        'parts-data': partsSortedFormData,
        'job-number': jobNumber,
        'job-notes': jobJobNotes,
        'attachments': jobAttachments,
        'vin': vehicleVIN,
        'registration': vehicleRegistration,
        'customer-data': customerData,
        'vehicle-data': vehicleData,
        'booking-fields': bookingFields,
        'existing-job-id': existingJobID,
        'job-status': jobStatus,
        'grand-total': jobGrandTotal,
        'mechanics': mechanicField
      },
      success: function success(response) {
        var dataStateWhenInitiallyClicked = jobStatus;

        //Saving Overlay
        progressPopup('saving', 'complete');
        if ((dataStateWhenInitiallyClicked === 'quote-sent' || dataStateWhenInitiallyClicked === 'completed') && response.length > 0 && $(self).hasClass('job-send')) {
          var jobData = JSON.parse(response);
          var send_quote_message, send_quote_subject;
          $('#job-id').val(jobData['job_id']);
          if (dataStateWhenInitiallyClicked == 'completed') {
            send_quote_message = $('#send-quote-popup #invoice-message').val();
            send_quote_subject = $('#send-quote-popup #invoice-subject').val();
            $('#send-quote-form .popup-title').text('Send Invoice');
            $('#submit-quote-invoice').text('Send Invoice');
            // Hide the quote fields
            $('#send-quote-form .input-label-wrapper.quote-message').hide();
            $('#send-quote-form .input-label-wrapper.quote-subject').hide();
            // Show the invoice fields 
            $('#send-quote-form .input-label-wrapper.invoice-message').show();
            $('#send-quote-form .input-label-wrapper.invoice-subject').show();
          } else {
            send_quote_message = $('#send-quote-popup #quote-message').val();
            send_quote_subject = $('#send-quote-popup #quote-subject').val();
            $('#send-quote-form .popup-title').text('Send quote');
            $('#submit-quote-invoice').text('Send Quote');
            // Hide the invoice fields
            $('#send-quote-form .input-label-wrapper.invoice-message').hide();
            $('#send-quote-form .input-label-wrapper.invoice-subject').hide();
            // Show the quote fields
            $('#send-quote-form .input-label-wrapper.quote-message').show();
            $('#send-quote-form .input-label-wrapper.quote-subject').show();
          }
          // replace [Customer_Name]
          send_quote_message = send_quote_message.replace('[Customer_Name]', jobData['customer-name']);
          // replace [quote]
          send_quote_subject = send_quote_subject.replace('[quote]', $('#job-number').val());
          send_quote_message = send_quote_message.replace('[quote]', $('#job_number').val());
          // replace [invoice] 
          send_quote_subject = send_quote_subject.replace('[invoice]', $('#job_number').val());
          send_quote_message = send_quote_message.replace('[invoice]', $('#job_number').val());
          // replace [workshop_email]
          send_quote_message = send_quote_message.replace('[workshop_email]', $('#workshop_email').text());
          // replace [workshop_number]
          send_quote_message = send_quote_message.replace('[workshop_number]', $('#workshop_number').text());
          // replace [Job_number] 
          send_quote_subject = send_quote_subject.replace('[Job_Number]', $('#job_number').text());
          send_quote_message = send_quote_message.replace('[Job_Number]', $('#job_number').text());
          // replace [company_name] 
          send_quote_subject = send_quote_subject.replace('[company_name]', jobData['customer-name']);
          send_quote_message = send_quote_message.replace('[company_name]', jobData['customer-name']);

          // Populate Fields
          $('#send-quote-form input[name="email"]').val(jobData['email']);
          $('#send-quote-form input[name="whatsapp"]').val(jobData['whatsapp']);
          dataStateWhenInitiallyClicked == 'completed' ? $('#send-quote-form').find('#invoice-subject').val(send_quote_subject) : $('#send-quote-form').find('#quote-subject').val(send_quote_subject);
          dataStateWhenInitiallyClicked == 'completed' ? $('#send-quote-form').find('textarea#invoice-message').val(send_quote_message) : $('#send-quote-form').find('textarea#quote-message').val(send_quote_message);
          $('#send-quote-popup').fadeIn('fast', function () {
            $('#send-quote-popup').addClass('show');
            $('body').css('overflow', 'hidden');
          });
        } else {
          $('input[name="content-changed"]').prop('checked', false);
          window.location.href = "/workshoppro/jobs/";
        }
      },
      error: function error(xhr) {
        xhr.status === 500 ? $('.alert-popup-outer.error .warning-title').html("There was a 500 internal server error and the post did not save, please contact support @ <a href=\"mailto:sfjha@fdsf.com\">sfjha@fdsf.com</a> or call <a href=\"tel:1231231234\">1231231234</a>") : $('.alert-popup-outer.error .warning-title').text("There was an error and the post did not save, please retry saving");
        $('.alert-popup-outer.error').fadeIn(function () {});
      }
    });

    //Delete attachment files from folder (The saving of attachment json is handled in te main ajax function above)
    var attachment_file_url = $('#delete-attachments').val();
    $.ajax({
      type: "POST",
      url: dashboard_obj.ajaxurl,
      data: {
        'action': 'delete_file',
        'file_url': attachment_file_url
      },
      success: function success(response) {
        //Update JSON
        removeLoader(self);
      }
    });
  });

  //New Customer Save/Edit Ajax 
  $(document).on('click', '#save-post.customer-save', function (event) {
    event.preventDefault();

    // Validate 
    if (!validateFormSubmit('#add-vehicle-form')) {
      return false;
    }

    //Customer Name/ID & Card no.
    var customerName = $('#first-name-1').val() + ' ' + $('#last-name-1').val();
    var existingCustomerPostID = $('input#customer-post-id').val();

    //Company Fields
    var companyDetails = $('#company-fields').serialize();

    //Customer Details Fields
    var customerDetails = $('#customer-details').serialize();

    //Vehicle Fields
    var vehicleName = "".concat($('#make').val(), " / ").concat($('#model').val(), " / ").concat($('#colour').val());
    var customerVehicle = $('#vehicle-fields').serialize();
    var vehicleAttachments = $('#attachments-obj').val();

    //Notes Fields
    var customerNotes = $('#customer-notes textarea').val();

    //Saving progress popup
    progressPopup('saving', 'start');
    $.ajax({
      type: "POST",
      url: dashboard_obj.ajaxurl,
      data: {
        'action': 'post_customers',
        'customer-name': customerName,
        'customer-post-id': existingCustomerPostID,
        'company-details': companyDetails,
        'customer-details': customerDetails,
        'vehicle-name': vehicleName,
        'customer-vehicles': customerVehicle,
        'vehicle-attachments': vehicleAttachments,
        'customer-notes': customerNotes
      },
      success: function success(response) {
        $('input[name="content-changed"]').prop('checked', false);
        window.location.href = "/workshoppro/customers/";

        //Saving Popup
        $('.ajax-progress-popup-outer').fadeOut(function () {
          $('.ajax-progress-popup-outer').removeClass('active');
        });
      },
      error: function error(xhr) {
        xhr.status === 500 ? $('.alert-popup-outer.error .warning-title').html("There was a 500 internal server error and the post did not save, please contact support @ <a href=\"mailto:sfjha@fdsf.com\">sfjha@fdsf.com</a> or call <a href=\"tel:1231231234\">1231231234</a>") : $('.alert-popup-outer.error .warning-title').text("There was an error and the post did not save, please retry saving");
        $('.alert-popup-outer.error').fadeIn(function () {});
      }
    });
  });
  $(document).on('click', '#csvData button', function () {
    var csvChunks = [];
    var chunkCount = Math.ceil(window.customerCsv.length / 20);
    var completedChunks = 0;
    var row = 0;
    function insertPosts() {
      $('.loading-elipses').addClass('active');
      var _loop = function _loop(_i) {
        window.customerCsv[row] && csvChunks.push(window.customerCsv[row]);
        row++;
        $(".bar > .segment:nth-child(".concat(completedChunks + 1, ")")).addClass('loading');
        if (_i === 19) {
          $.ajax({
            type: "POST",
            url: dashboard_obj.ajaxurl,
            data: {
              'action': 'insert_csv_customers',
              'csv-customer-data': csvChunks
            },
            success: function success(response) {
              _i = 0;
              completedChunks++;
              csvChunks = [];
              $(".bar > .segment").css('max-width', "".concat(100 / chunkCount * completedChunks, "%"));
              if (completedChunks < chunkCount) {
                insertPosts();
              } else {
                setTimeout(function () {
                  $('#csvData h3').fadeOut(300);
                  $('#csvData button').fadeOut(300);
                  $('.csv-table').fadeOut(300, function () {
                    $('.loading-elipses').removeClass('active');
                    $(this).html('<p>Customers upload progress: <strong>Complete!</strong></p>').fadeIn();
                  });
                  window.customerCsv = undefined;
                  delete window.customerCsv;
                }, 3000);
              }
            }
          });
        }
        i = _i;
      };
      for (var i = 0; i < 20; i++) {
        _loop(i);
      }
    }
    insertPosts();
  });

  // Profile Picture Upload 
  $(document).on('change', '#profile_picture', function (e) {
    var file = e.target.files[0];
    if (!file) return;
    var formData = new FormData();
    formData.append('action', 'upload_profile_picture');
    formData.append('profile_picture', file);

    //Loader
    addLoader('.profile-image');
    $.ajax({
      type: 'POST',
      url: dashboard_obj.ajaxurl,
      data: formData,
      processData: false,
      contentType: false,
      success: function success(response) {
        if (response.success) {
          // Handle successful file upload
          var _response$data = response.data,
            name = _response$data.name,
            url = _response$data.url;
          removeLoader('.profile-image');

          // Update the profile picture with the new URL
          $('.profile-image img').attr('src', url);
        } else {
          // Handle error
          console.error(response.data.message);
        }
      },
      error: function error() {
        // Handle AJAX request failure
        console.error('An error occurred during the file upload.');
        removeLoader('.profile-image');
      }
    });
  });

  //Job attachments
  $(document).on('change', '#attachment', function (e) {
    var file = e.target.files[0];
    var self = $(this);
    if (!file) return;
    var attachmentFormData = new FormData();
    attachmentFormData.append('action', 'upload_attachment');
    attachmentFormData.append('attachment', file);

    //Loader
    addLoader('.form-row.attachments label');
    $.ajax({
      type: "POST",
      url: dashboard_obj.ajaxurl,
      data: attachmentFormData,
      processData: false,
      contentType: false,
      success: function success(response) {
        // Show Table 
        $('#attachment-files').slideDown();

        //New Attachments
        var concatenatedFiles = {};
        var files = JSON.parse(response);
        var name = files[0][0];
        var tmp_name = files[0][1];
        var url = files[0][2];

        //Existing Attachments
        var jobAttachments = $("#attachments-obj").val();
        if (jobAttachments.length > 0) {
          jobAttachments = JSON.parse(jobAttachments);
          //First add existing attachments
          console.log(jobAttachments);
          Object.keys(jobAttachments).forEach(function (key) {
            concatenatedFiles[key] = jobAttachments[key];
          });
        }

        //Rename new attachment if name is used
        var existingAttchmentsCount = Object.keys(concatenatedFiles);
        if (existingAttchmentsCount.includes(name)) {
          for (var i = 0; i <= existingAttchmentsCount.length; i++) {
            //TODO:Change to recursive function instead of for
            if (!existingAttchmentsCount.includes("".concat(name, "-").concat(i))) {
              concatenatedFiles["".concat(name, "-").concat(i)] = [name, tmp_name, url];
              name = "".concat(name, "-").concat(i);
              break;
            } else {
              concatenatedFiles[name] = [name, tmp_name, url];
              break;
            }
          }
        } else {
          concatenatedFiles[name] = [name, tmp_name, url];
        }

        //Append new attachment to table
        var newTableRow = "\n                <tr>\n                    <td>\n                    <a href=\"".concat(url, "\" target=\"_blank\" >").concat(name, "</a>\n                    <input type=\"hidden\" class=\"hidden-attachment-values\" name=\"hidden-attachment\" value=\"").concat(tmp_name, "\" >\n                    </td>\n                    <td class=\"delete\" attachment_id=\"").concat(name, "\" >\n                        <svg width=\"14\" height=\"17\" viewBox=\"0 0 14 17\" fill=\"none\" xmlns=\"http:www.w3.org/2000/svg\">\n                            <path d=\"M4.30769 6.36667C4.60508 6.36667 4.84615 6.60545 4.84615 6.9V13.3C4.84615 13.5946 4.60508 13.8333 4.30769 13.8333C4.01031 13.8333 3.76923 13.5946 3.76923 13.3V6.9C3.76923 6.60545 4.01031 6.36667 4.30769 6.36667Z\" fill=\"#7A7A9D\"></path>\n                            <path d=\"M7 6.36667C7.29738 6.36667 7.53846 6.60545 7.53846 6.9V13.3C7.53846 13.5946 7.29738 13.8333 7 13.8333C6.70262 13.8333 6.46154 13.5946 6.46154 13.3V6.9C6.46154 6.60545 6.70262 6.36667 7 6.36667Z\" fill=\"#7A7A9D\"></path>\n                            <path d=\"M10.2308 6.9C10.2308 6.60545 9.98969 6.36667 9.69231 6.36667C9.39492 6.36667 9.15385 6.60545 9.15385 6.9V13.3C9.15385 13.5946 9.39492 13.8333 9.69231 13.8333C9.98969 13.8333 10.2308 13.5946 10.2308 13.3V6.9Z\" fill=\"#7A7A9D\"></path>\n                            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 3.7C14 4.2891 13.5178 4.76667 12.9231 4.76667H12.3846V14.3667C12.3846 15.5449 11.4203 16.5 10.2308 16.5H3.76923C2.57969 16.5 1.61538 15.5449 1.61538 14.3667V4.76667H1.07692C0.482155 4.76667 0 4.2891 0 3.7V2.63333C0 2.04423 0.482155 1.56667 1.07692 1.56667H4.84615C4.84615 0.977563 5.32831 0.5 5.92308 0.5H8.07692C8.67169 0.5 9.15385 0.977563 9.15385 1.56667H12.9231C13.5178 1.56667 14 2.04423 14 2.63333V3.7ZM2.81942 4.76667L2.69231 4.82962V14.3667C2.69231 14.9558 3.17446 15.4333 3.76923 15.4333H10.2308C10.8255 15.4333 11.3077 14.9558 11.3077 14.3667V4.82962L11.1806 4.76667H2.81942ZM1.07692 3.7V2.63333H12.9231V3.7H1.07692Z\" fill=\"#7A7A9D\"></path>\n                        </svg>\n                    </td>\n                </tr>");
        removeLoader('.form-row.attachments label');
        $('#attachments-obj').val(JSON.stringify(concatenatedFiles));

        //Add new attachment to table
        $('#attachment-files tbody').append(newTableRow);
        self.val('');
      },
      error: function error(xhr, status, _error) {
        alert('Error uploading file: ' + _error);
      }
    });
  });

  //Delete upload file
  $(document).on('click', '#attachment-files .delete', function () {
    var self = $(this);
    var attachment_file_url = self.closest('tr').find('a').attr('href');
    var attachment_file_name = self.attr('attachment_id');
    var attachmentObj = JSON.parse($('#attachments-obj').val());
    delete attachmentObj[attachment_file_name];
    $('#attachments-obj').val(JSON.stringify(attachmentObj));

    //Add attachment url to delete field to delete later
    var attchmentsToDelete = [];
    if ($('#delete-attachments').val().length > 0) {
      attchmentsToDelete.push($('#delete-attachments').val() + ',', attachment_file_url);
    } else {
      attchmentsToDelete.push(attachment_file_url);
    }
    $('#delete-attachments').val(attchmentsToDelete);
    self.closest('tr').fadeOut().remove();
  });

  // Profile Form update 
  $('#profile-form').submit(function (e) {
    e.preventDefault();
    var self = $(this);

    // Validate 
    if (!validateFormSubmit('#add-staff')) {
      return false;
    }
    var formData = $(this).serialize();
    var profileFormNonce = $('#profile-form input[name="profile_form_nonce"]').val();

    //Saving progress popup
    progressPopup('saving', 'start');
    $.ajax({
      type: 'POST',
      url: dashboard_obj.ajaxurl,
      data: {
        action: 'update_profile',
        formData: formData,
        profile_form_nonce: profileFormNonce
      },
      success: function success(response) {
        //Saving Overlay
        progressPopup('saving', 'complete');
        var profileFormComplete = true;
        $('#profile-form input').each(function () {
          if ($(this).val() === '' && $(this).attr('name') !== 'miwa_member' && $(this).attr('name') !== 'profile_picture' && $(this).attr('name') !== 'profile_form_nonce' && $(this).attr('name') !== 'vat_number' && $(this).attr('name') !== 'company_registration_number') {
            profileFormComplete = false;
          }
        });
        if (profileFormComplete) {
          $('#profile-form').closest('.add-business-info').addClass('completed');
          $('#profile-form').closest('.add-business-info').find('.icon-col').html('<svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.662109" width="60" height="60" rx="30" fill="#009026"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M37.6854 23.9755C38.0841 24.4299 38.0841 25.1666 37.6854 25.6209L29.5173 37.2555C29.1185 37.7099 28.4721 37.7099 28.0733 37.2555L22.6692 31.0975C22.2704 30.6431 22.2704 29.9064 22.6692 29.4521C23.0679 28.9977 23.7144 28.9977 24.1131 29.4521L28.7953 34.7875L36.2415 23.9755C36.6402 23.5212 37.2867 23.5212 37.6854 23.9755Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M35.7025 23.8726C36.2819 23.2209 37.2214 23.2209 37.8008 23.8726C38.3731 24.5163 38.3802 25.5551 37.8219 26.2086L29.924 37.3126C29.9126 37.3286 29.9004 37.3439 29.8875 37.3584C29.3081 38.0102 28.3687 38.0102 27.7892 37.3585L22.5537 31.4697C21.9743 30.818 21.9743 29.7613 22.5537 29.1096C23.1332 28.4579 24.0726 28.4579 24.652 29.1096L28.7937 33.768L35.6631 23.9225C35.6753 23.905 35.6885 23.8883 35.7025 23.8726Z" fill="white"></path></svg>');
          $('#profile-form').closest('.add-business-info').find('.add-business-btn').click();
        } else {
          $('#profile-form').closest('.add-business-info').removeClass('completed');
          $('#profile-form').closest('.add-business-info').find('.icon-col').html('<svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.162109" width="60" height="60" rx="30" fill="#EDFFEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M18 30.1621C18 23.5347 23.3726 18.1621 30 18.1621C36.6274 18.1621 42 23.5347 42 30.1621C42 36.7895 36.6274 42.1621 30 42.1621C23.3726 42.1621 18 36.7895 18 30.1621ZM29.25 19.7769C28.2459 20.084 27.2469 21.0079 26.4191 22.5601C26.2044 22.9626 26.006 23.3999 25.8266 23.8675C26.8843 24.1035 28.0357 24.2538 29.25 24.2979V19.7769ZM24.3728 23.4713C23.7211 23.2588 23.1194 23.0114 22.5772 22.7357C23.5465 21.7668 24.7043 20.9866 25.9909 20.4546C25.6629 20.8807 25.3637 21.3516 25.0956 21.8542C24.829 22.354 24.5871 22.8951 24.3728 23.4713ZM23.2627 29.4121H19.5264C19.6716 27.3546 20.4096 25.4607 21.5707 23.9003C22.2747 24.2866 23.063 24.6226 23.9172 24.9005C23.5453 26.281 23.3171 27.8071 23.2627 29.4121ZM25.363 25.3004C26.5756 25.5805 27.8853 25.7525 29.25 25.7988V29.4121H24.7636C24.8174 27.9316 25.0293 26.5418 25.363 25.3004ZM30.75 25.7988V29.4121H35.2364C35.1825 27.9316 34.9707 26.5418 34.637 25.3004C33.4244 25.5805 32.1147 25.7525 30.75 25.7988ZM24.7636 30.9121H29.25V34.5254C27.8853 34.5717 26.5756 34.7437 25.363 35.0238C25.0293 33.7824 24.8174 32.3926 24.7636 30.9121ZM30.75 30.9121V34.5254C32.1147 34.5717 33.4244 34.7437 34.637 35.0238C34.9707 33.7824 35.1825 32.3926 35.2364 30.9121H30.75ZM25.8266 36.4567C26.8843 36.2207 28.0357 36.0704 29.25 36.0263V40.5473C28.2459 40.2402 27.2469 39.3163 26.4191 37.7641C26.2044 37.3616 26.006 36.9243 25.8266 36.4567ZM25.9909 39.8696C25.6629 39.4435 25.3637 38.9726 25.0956 38.47C24.829 37.9702 24.5871 37.4291 24.3728 36.8529C23.7211 37.0654 23.1194 37.3128 22.5772 37.5885C23.5465 38.5574 24.7043 39.3376 25.9909 39.8696ZM23.9172 35.4237C23.063 35.7016 22.2747 36.0376 21.5707 36.4239C20.4096 34.8635 19.6716 32.9696 19.5264 30.9121H23.2627C23.3171 32.5171 23.5453 34.0432 23.9172 35.4237ZM34.0091 39.8696C35.2957 39.3376 36.4535 38.5574 37.4228 37.5885C36.8806 37.3128 36.2788 37.0654 35.6272 36.8529C35.4128 37.4291 35.171 37.9702 34.9044 38.47C34.6363 38.9726 34.337 39.4435 34.0091 39.8696ZM30.75 36.0263C31.9642 36.0704 33.1157 36.2207 34.1734 36.4567C33.994 36.9243 33.7956 37.3616 33.5809 37.7641C32.7531 39.3163 31.7541 40.2402 30.75 40.5473V36.0263ZM36.0827 35.4237C36.937 35.7016 37.7253 36.0376 38.4293 36.4239C39.5904 34.8635 40.3284 32.9696 40.4736 30.9121H36.7373C36.6829 32.5171 36.4547 34.0432 36.0827 35.4237ZM40.4736 29.4121H36.7373C36.6829 27.8071 36.4547 26.281 36.0827 24.9005C36.937 24.6226 37.7253 24.2866 38.4293 23.9003C39.5904 25.4607 40.3284 27.3546 40.4736 29.4121ZM34.9044 21.8542C35.171 22.354 35.4128 22.8951 35.6272 23.4713C36.2788 23.2588 36.8806 23.0114 37.4228 22.7357C36.4535 21.7668 35.2957 20.9866 34.0091 20.4546C34.337 20.8807 34.6363 21.3516 34.9044 21.8542ZM34.1734 23.8675C33.1157 24.1035 31.9642 24.2538 30.75 24.2979V19.7769C31.7541 20.084 32.7531 21.0079 33.5809 22.5601C33.7956 22.9626 33.994 23.3999 34.1734 23.8675Z" fill="#009026"/></svg>');
        }
      },
      error: function error(xhr, status, _error2) {
        console.error(xhr.responseText);
        // Handle errors here
      }
    });
  });

  // Adding Vehicle
  $('#add-vehicle-form').submit(function (e) {
    e.preventDefault();

    // Validate 
    if (!validateFormSubmit()) {
      return false;
    }
    var self = $(this);
    var formData = $(self).serialize();
    var attachments = $('#attachments-obj').val();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      // AJAX URL provided by WordPress
      type: 'POST',
      data: {
        action: 'save_vehicle_data',
        formData: formData,
        attachments: attachments
      },
      success: function success(response) {
        var _this = this;
        // Remove Attachment Files from table 
        $('#attachment-files tbody tr').remove();
        removeOverlayLoader(self);
        setTimeout(function () {
          $('.popup').fadeOut('fast', function () {
            $(this).removeClass('show');
            $('body').css('overflow', 'auto');
          });
          $(_this).closest('form').clearForm();

          // Reload the vehicle table 
          var table = $('#vehicleTable').DataTable();
          table.ajax.reload();
          var customerVehicleTable = $('#customerVehicleTable').DataTable();
          customerVehicleTable.ajax.reload(function (json) {
            var rowData = [];
            for (var vehicleID in json.data) {
              if (json.data.hasOwnProperty(vehicleID)) {
                var vehicleData = json.data[vehicleID];
                rowData.push({
                  'vehicle_post_id': vehicleData.customer_vehicle_id,
                  'make': vehicleData.make,
                  'model': vehicleData.model,
                  'registration': vehicleData.registration,
                  'vin': vehicleData.vin,
                  'actions': vehicleData.actions
                });
              }
            }
            // Set the data for the DataTable
            customerVehicleTable.rows.add(rowData).draw();
          });
          self.clearForm();
        }, 500);
        console.log('Vehicle Added');
        if ($(".job-add-vehicle-popup").length > 0) {
          // Remove error messaging 
          $('input[name="vehicle-data"]').removeClass('error');
          $('input[name="vehicle-data"]').siblings('.error-message').remove();

          // add vehicle to job form
          var vehicles = JSON.parse(response);

          // Iterate over each vehicle in the response
          for (var vin in vehicles) {
            if (vehicles.hasOwnProperty(vin)) {
              var vehicleInfo = vehicles[vin];

              // Construct the HTML structure for each vehicle
              var listItem = "\n                                <li data-vin=\"".concat(vin, "\" data-mileage=\"").concat(vehicleInfo.mileage, "\" data-make=\"").concat(vehicleInfo.make, "\" data-model=\"").concat(vehicleInfo.model, "\" data-vehicle-all=\"").concat(JSON.stringify(vehicleInfo).replace(/"/g, '&quot;'), "\">\n                                    <p class=\"make-model\"> ").concat(vehicleInfo.make, " / ").concat(vehicleInfo.model, " / ").concat(vehicleInfo.colour, " </p>\n                                    <p class=\"registration\"> ").concat(vehicleInfo.registration, " </p>\n                                </li>\n                            ");

              // Append the new list item to the specified element
              $('.job-select-wrapper.vehicle .vehicle-select .options').append(listItem);
            }
          }

          // click the appended vehicle 
          setTimeout(function () {
            $('.job-select-wrapper.vehicle .vehicle-select .options li').last().click();
          }, 500);
        }
      },
      error: function error(xhr, status, _error3) {
        var _this2 = this;
        console.error(xhr.responseText);
        // Handle error
        console.log('Error');
        removeOverlayLoader(self);
        setTimeout(function () {
          $('.popup').fadeOut('fast', function () {
            $(this).removeClass('show');
            $('body').css('overflow', 'auto');
          });
          $(_this2).closest('form').clearForm();
        }, 500);
      }
    });
  });

  // Edit Vehicle 
  $(document).on('click', '.edit-vehicle-action', function (e) {
    e.preventDefault();

    // Remove Attachment Files from table
    $('#attachment-files tbody tr').remove();
    var tr_post_id = $(this).closest('tr').attr('class');
    // Strip 'post-id-' from tr_post_id 
    var edit_post_id = tr_post_id.replace('post-id-', '');
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'edit_vehicle_data',
        edit_post_id: edit_post_id
      },
      success: function success(response) {
        // Change popup title and add class to identify edit vehicle 
        $('#add-vehicle-popup').addClass('edit-vehicle-popup');
        $('#add-vehicle-popup').find('.popup-title').text('Edit Vehicle');

        // decode the JSON response
        var vehicleData = JSON.parse(response);

        // Pass the post id to the form
        $('#add-vehicle-form input[name="vehicle_post_id"]').val(edit_post_id);
        $('.customer').find('.customer-select').fadeOut(0, function () {
          $('.selected-customer-outer').fadeIn();
        });

        // Customer field update
        var customerData = '{"customer-post-id":' + vehicleData['customer-post-id'] + ',"customer-name":"' + vehicleData['customer-name'] + '","company-name":"' + vehicleData['company-name'] + '","email":"' + vehicleData['email'] + '","phone":"' + vehicleData['phone'] + '","address":"' + vehicleData['address'] + '"}';

        // Populate the vehicle fields with the data
        $('.edit-vehicle-popup input[name="customer-data"]').val(customerData);
        $('.edit-vehicle-popup input[name="old_customer_data"]').val(customerData);
        var companyName = vehicleData['company-name'] ? vehicleData['company-name'] : '';
        var companyData = companyName.split('&').reduce(function (acc, item) {
          var _item$split = item.split('='),
            _item$split2 = _slicedToArray(_item$split, 2),
            key = _item$split2[0],
            value = _item$split2[1];
          acc[key] = value;
          return acc;
        }, {});
        console.log(companyData);
        $('.selected-customer-outer .customer-name-val').text(vehicleData['customer-name']);
        $('.selected-customer-outer .company-name-val').text(companyData['company-name'].replace('%20', ' '));
        $('.selected-customer-outer .contact-val').text(vehicleData['phone']);
        $('.selected-customer-outer .address-val').text(vehicleData['address'], vehicleData['city'], vehicleData['province'], vehicleData['postal-code']);

        // Vehicle fields update
        var vehicle = vehicleData['vehicle'];
        $('.edit-vehicle-popup input[name="make"]').val(vehicle.make);
        $('.edit-vehicle-popup input[name="model"]').val(vehicle.model);
        $('.edit-vehicle-popup input[name="year"]').val(vehicle.year);
        $('.edit-vehicle-popup input[name="vin"]').val(vehicleData.vin);
        $('.edit-vehicle-popup input[name="registration"]').val(vehicle.registration);
        $('.edit-vehicle-popup input[name="colour"]').val(vehicle.colour);
        $('.edit-vehicle-popup input[name="mileage"]').val(vehicle.mileage);
        $('.edit-vehicle-popup textarea[name="description"]').val(vehicle.description);

        // Attachments 
        var attachments = vehicleData.attachments;
        if (attachments) {
          $('input#attachments-obj').val(JSON.stringify(attachments));
          var attachmentFiles = '';
          for (var _i2 = 0, _Object$entries = Object.entries(attachments); _i2 < _Object$entries.length; _i2++) {
            var _Object$entries$_i = _slicedToArray(_Object$entries[_i2], 2),
              key = _Object$entries$_i[0],
              value = _Object$entries$_i[1];
            attachmentFiles += "<tr>\n                            <td>\n                                <a href=\"".concat(value[2], "\" target=\"_blank\">").concat(value[0], "</a>\n                                <input type=\"hidden\" class=\"hidden-attachment-values\" name=\"hidden-attachment\" value=\"").concat(value[1], "\" >\n                            </td>\n                            <td class=\"delete\" attachment_id=\"").concat(key, "\">\n                                <svg width=\"14\" height=\"17\" viewBox=\"0 0 14 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M4.30769 6.36667C4.60508 6.36667 4.84615 6.60545 4.84615 6.9V13.3C4.84615 13.5946 4.60508 13.8333 4.30769 13.8333C4.01031 13.8333 3.76923 13.5946 3.76923 13.3V6.9C3.76923 6.60545 4.01031 6.36667 4.30769 6.36667Z\" fill=\"#7A7A9D\"></path>\n                                    <path d=\"M7 6.36667C7.29738 6.36667 7.53846 6.60545 7.53846 6.9V13.3C7.53846 13.5946 7.29738 13.8333 7 13.8333C6.70262 13.8333 6.46154 13.5946 6.46154 13.3V6.9C6.46154 6.60545 6.70262 6.36667 7 6.36667Z\" fill=\"#7A7A9D\"></path>\n                                    <path d=\"M10.2308 6.9C10.2308 6.60545 9.98969 6.36667 9.69231 6.36667C9.39492 6.36667 9.15385 6.60545 9.15385 6.9V13.3C9.15385 13.5946 9.39492 13.8333 9.69231 13.8333C9.98969 13.8333 10.2308 13.5946 10.2308 13.3V6.9Z\" fill=\"#7A7A9D\"></path>\n                                    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 3.7C14 4.2891 13.5178 4.76667 12.9231 4.76667H12.3846V14.3667C12.3846 15.5449 11.4203 16.5 10.2308 16.5H3.76923C2.57969 16.5 1.61538 15.5449 1.61538 14.3667V4.76667H1.07692C0.482155 4.76667 0 4.2891 0 3.7V2.63333C0 2.04423 0.482155 1.56667 1.07692 1.56667H4.84615C4.84615 0.977563 5.32831 0.5 5.92308 0.5H8.07692C8.67169 0.5 9.15385 0.977563 9.15385 1.56667H12.9231C13.5178 1.56667 14 2.04423 14 2.63333V3.7ZM2.81942 4.76667L2.69231 4.82962V14.3667C2.69231 14.9558 3.17446 15.4333 3.76923 15.4333H10.2308C10.8255 15.4333 11.3077 14.9558 11.3077 14.3667V4.82962L11.1806 4.76667H2.81942ZM1.07692 3.7V2.63333H12.9231V3.7H1.07692Z\" fill=\"#7A7A9D\"></path>\n                                </svg>\n                            </td>\n                        </tr>");
          }
          $('#attachment-files').slideDown();
          $('#attachment-files tbody').append(attachmentFiles);
        }
      },
      error: function error(xhr, status, _error4) {
        console.error(xhr.responseText);
      }
    });
  });

  // Quote and invoice footer note 
  $(document).on('submit', '#quote-invoice-note', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'quote_invoice_note',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error5) {
        console.error(xhr.responseText);
      }
    });
  });

  // Bank details 
  // $(document).on('submit','#bank-details',function(e) { 
  //     e.preventDefault();

  //     const self = $(this); 
  //     const formData = $(self).serialize();
  //     addOverlayLoader(self); 

  //     $.ajax({
  //         url: dashboard_obj.ajaxurl,
  //         type: 'POST',
  //         data: {
  //             action: 'bank_details',
  //             formData: formData,
  //             bank_details_nonce: $('#bank-details input[name="bank_details_nonce"]').val()
  //         },
  //         success: function(response) { 
  //             removeOverlayLoader(self);
  //         },
  //         error: function(xhr, status, error) {
  //             console.error(xhr.responseText);
  //         }
  //     });
  // })

  // Payment Terms 
  $(document).on('submit', '#payment-terms', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'payment_terms',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error6) {
        console.error(xhr.responseText);
      }
    });
  });

  // Warranty information 
  $(document).on('submit', '#warranty-information', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'warranty_information',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error7) {
        console.error(xhr.responseText);
      }
    });
  });

  // Default Quote Message 
  $(document).on('submit', '#default-quote-message', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'default_quote_message',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error8) {
        console.error(xhr.responseText);
      }
    });
  });

  // Default Invoice Message 
  $(document).on('submit', '#default-invoice-message', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'default_invoice_message',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error9) {
        console.error(xhr.responseText);
      }
    });
  });

  // Default Quote Whatsapp Message  
  $(document).on('submit', '#default-quote-whatsapp-message', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'default_quote_whatsapp_message',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error10) {
        console.error(xhr.responseText);
      }
    });
  });

  // Default Invoice Whatsapp Message 
  $(document).on('submit', '#default-invoice-whatsapp-message', function (e) {
    e.preventDefault();
    var self = $(this);
    var formData = $(self).serialize();
    addOverlayLoader(self);
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'default_invoice_whatsapp_message',
        formData: formData
      },
      success: function success(response) {
        removeOverlayLoader(self);
      },
      error: function error(xhr, status, _error11) {
        console.error(xhr.responseText);
      }
    });
  });

  // Delete Post Action
  $(document).on('click', '[data-delete-post]', function (e) {
    e.preventDefault();
    var delete_post_id = $(this).data('delete-post');

    //Deleting progress popup
    progressPopup('delete', 'start');
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'delete_post',
        delete_post_id: delete_post_id
      },
      success: function success(response) {
        //Deleting progress popup
        progressPopup('delete', 'complete');

        // Reload the vehicle table 
        var table = $('.dt-table').DataTable();
        table.ajax.reload();
        var customerVehicleTable = $('#customerVehicleTable').DataTable();
        customerVehicleTable.ajax.reload(function (json) {
          var rowData = [];
          for (var vehicleID in json.data) {
            if (json.data.hasOwnProperty(vehicleID)) {
              var vehicleData = json.data[vehicleID];
              rowData.push({
                'vehicle_post_id': vehicleData.customer_vehicle_id,
                'make': vehicleData.make,
                'model': vehicleData.model,
                'registration': vehicleData.registration,
                'vin': vehicleData.vin,
                'actions': vehicleData.actions
              });
            }
          }
          // Set the data for the DataTable
          customerVehicleTable.rows.add(rowData).draw();
        });
      },
      error: function error(xhr, status, _error12) {
        console.error(xhr.responseText);
      }
    });
  });

  // Delete Staff Member 
  $(document).on('click', '.delete-staff-member', function (e) {
    e.preventDefault();
    var member_name = $(this).closest('tr').find('td:nth-child(1)').text();
    var member_contact_number = $(this).closest('tr').find('td:nth-child(2)').text();
    var member_role = $(this).closest('tr').find('td:nth-child(3)').text();
    var staffMember = member_name;
    $.ajax({
      url: dashboard_obj.ajaxurl,
      type: 'POST',
      data: {
        action: 'delete_staff_member',
        staff_member: staffMember
      },
      success: function success(response) {
        console.log(response);

        // Reload the staff table 
        var table = $('#staff-table').DataTable();
        table.ajax.reload();
      },
      error: function error(xhr, status, _error13) {
        console.error(xhr.responseText);
      }
    });
  });

  //Saving/Deleting progress popup
  function progressPopup(type, state) {
    if (state === 'start') {
      $('.ajax-progress-popup-outer').addClass('active');
      type === 'save' && $('.ajax-progress-popup-outer h2').text('Saving');
      type === 'delete' && $('.ajax-progress-popup-outer h2').text('Deleting');
    } else {
      $('.ajax-progress-popup-outer').removeClass('active');
    }
  }

  //Loader - used for ajax
  function addLoader(ele) {
    var loadingGears = '<div class="svg-loader"></div>';
    $(ele).prepend(loadingGears);
  }
  function removeLoader(ele) {
    $(ele).find('.svg-loader').fadeOut(300, function () {
      $(this).remove();
    });
  }

  // overlay loader 
  function addOverlayLoader(ele) {
    $(ele).addClass('overlay-loader');
    var loadingGears = '<div class="svg-loader"></div>';
    $(ele).prepend(loadingGears);
  }
  function removeOverlayLoader(ele) {
    $(ele).find('.svg-loader').fadeOut(300, function () {
      $(this).remove();
      $(ele).removeClass('overlay-loader');
    });
  }
});